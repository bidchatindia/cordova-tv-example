!function a(h,m,l){function k(f,e){if(!m[f]){if(!h[f]){var d="function"==typeof require&&require;if(!e&&d){return d(f,!0)}if(j){return j(f,!0)}var c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c}var b=m[f]={exports:{}};h[f][0].call(b.exports,function(g){var n=h[f][1][g];return k(n?n:g)},b,b.exports,a,h,m,l)}return m[f].exports}for(var j="function"==typeof require&&require,i=0;i<l.length;i++){k(l[i])}return k}({1:[function(i,h,n){var m=i("./media-engine/hlsjs-bundle"),l=i("video-event-polyfill"),k={VOD:0,LIVE:1,DVR:2},j=function(e){function d(aL,aK){function aJ(s){if(void 0===g||g.url!==s){var q=function(x,w){Z=k.VOD,w.details.live&&(Z=w.details.totalduration>120?k.DVR:k.LIVE,Y=w.details.totalduration),r.setLive(w.details.live)};Y=0,g&&g.destroy();var v=aK.p2pConfig||{},u=aK.hlsjsConfig||{},t=ah._.extend({},u);g=new m(t,v),g.on(m.Events.MANIFEST_PARSED,ak),g.on(m.Events.ERROR,function(x,w){w.fatal&&ag.trigger(o.JWPLAYER_MEDIA_ERROR,{message:w.details})});var r=new l(ae);r.on(l.Events.WAITING,function(){ag.setState(f.BUFFERING)}),r.on(l.Events.PLAYING,function(){ag.setState(f.PLAYING)}),r.on(l.Events.ENDED,function(){ag.trigger(o.JWPLAYER_MEDIA_BEFORECOMPLETE),X&&(aC(0),ag.pause(),ag.setState(f.COMPLETE),ag.trigger(o.JWPLAYER_MEDIA_COMPLETE))}),g.on(m.Events.LEVEL_LOADED,q),g.on(m.Events.DESTROYING,function(){r.dispose()}),g.loadSource(s),g.attachMedia(ae)}}function aI(r){this.setState(f.BUFFERING);var q=r.file;void 0!==m&&aJ(q),r.starttime&&this.seek(r.starttime),this.trigger(o.JWPLAYER_MEDIA_BUFFER_FULL),ai=setInterval(an,100)}function aH(b){ae.muted=b}function aG(){ae.pause(),this.setState(f.PAUSED)}function aF(){return ac}function aE(){return ab}function aD(){ae.play(),this.setState(f.BUFFERING),this.setVisibility(!0)}function aC(b){X&&(Z===k.DVR&&0>b&&(b+=ae.duration),ae.currentTime=b)}function aB(){aj===ae.parentNode&&aj.removeChild(ae)}function aA(b){aj=b,aj.appendChild(ae)}function az(){return aj}function ay(r){var q=r-1;g.nextLevel=q,ax(r)}function ax(b){ag._currentQuality=b,ag.trigger(o.JWPLAYER_MEDIA_LEVEL_CHANGED,{currentQuality:b,levels:ac})}function aw(b){b=!!b,b?p.css.style(aj,{visibility:"visible",opacity:1}):p.css.style(aj,{visibility:"",opacity:0})}function av(){ae.pause(),this.setState(f.IDLE)}function au(b){ae.volume=b/100}function at(){return !0}function ar(){return{name:this.name}}function aq(){return X?(X=!1,g&&g.detachMedia(),clearInterval(ai),ae):void 0}function ap(){X=!0,g&&g.attachMedia(ae)}function ao(){if(X){var r=ae.currentTime,q=ae.duration;ad=r,Z===k.LIVE&&(q=1/0),Z===k.DVR&&(r=-(ae.duration-ae.currentTime),q=-Y),ag.trigger(o.JWPLAYER_MEDIA_TIME,{position:r,duration:q})}}function an(){var b=al();b!=aa&&(aa=b,ag.trigger(o.JWPLAYER_MEDIA_BUFFER,{bufferPercent:100*aa})),b>=1&&clearInterval(ai)}function am(r){for(var q=0;q<r.length;q++){if(r.start(q)<=ae.currentTime&&ae.currentTime<=r.end(q)){return r.end(q)}}return ad}function al(){var r=ae.buffered,q=am(r);return ae.duration<=0?0:q/ae.duration}function ak(r,q){function v(b){return b.height?b.height+"p":b.width?Math.round(9*b.width/16)+"p":b.bitrate?b.bitrate/1000+"kbps":0}var u=[],t=0;if(q.levels.length>1){var s={jwIndex:-1,label:"auto"};u.push(s)}q.levels.forEach(function(x){var w={};w.jwIndex=t,w.bitrate=x.bitrate,u.push(w),t++,w.label=v(x)}),ac=u,ag.trigger(o.JWPLAYER_MEDIA_LEVELS,{levels:ac,currentQuality:ab}),ax(g.manualLevel+1)}var aj,ai,ah=e(aL),ag=this,af=document.getElementById(aL),ae=af&&af.querySelector("video")?af.querySelector("video"):document.createElement("video"),ad=0,ac=[],ab=-1,aa=-1,Z=k.VOD,Y=0,X=!0;this.name="streamrootHLS";var g;p.css.style(ae,{height:"100%",width:"100%"});var c=ah.Events;ah._.extend(this,c,{load:aI,mute:aH,pause:aG,getQualityLevels:aF,getCurrentQuality:aE,play:aD,seek:aC,remove:aB,setContainer:aA,getContainer:az,setCurrentQuality:ay.bind(this),setVisibility:aw,stop:av,volume:au,supportsFullscreen:at,getName:ar,detachMedia:aq,attachMedia:ap}),ae.addEventListener("timeupdate",ao)}var p=e.utils,o=e.events,f=o.state;d.getName=function(){return{name:"StreamrootProviderHLS"}},d.supports=function(q){var g,r=m&&("IE"===m.getBrowserName()||"Edge"===m.getBrowserName());return q.file&&(g=-1!==q.file.indexOf(".m3u8")),g&&!r&&m&&m.isSupported()},e.api.registerProvider(d)};j(window.jwplayer)},{"./media-engine/hlsjs-bundle":2,"video-event-polyfill":340}],2:[function(ab,aa,Z){function Y(b){W(I,b,{get:function(){return P["default"][b]},set:void 0})}var X=ab("babel-runtime/helpers/class-call-check")["default"],W=ab("babel-runtime/core-js/object/define-property")["default"],V=ab("babel-runtime/core-js/get-iterator")["default"],U=ab("babel-runtime/core-js/object/get-own-property-names")["default"],T=ab("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(Z,"__esModule",{value:!0});var S=ab("hlsjs-wrapper"),R=T(S),Q=ab("hls.js"),P=T(Q),O=ab("streamroot-p2p"),N=T(O),M=ab("ua-parser-js"),K=new M;K.setUA(window.navigator.userAgent);var J=K.getResult(),I=function L(f,e){X(this,L);var h=new R["default"](N["default"]);f.fLoader=h.P2PLoader,f.xhrSetup=h.setRange,f.maxBufferSize=f.maxBufferSize||0,f.maxBufferLength=f.maxBufferLength||30,f.liveSyncDurationCount||f.liveMaxLatencyDurationCount||(f.liveSyncDuration=f.liveSyncDuration||30);var g=new P["default"](f);return g.on(P["default"].Events.MANIFEST_LOADING,function(b,c){h.createSRModule(e,g,P["default"].Events)}),g},H=!0,G=!1,F=void 0;try{for(var E,D=V(U(P["default"]));!(H=(E=D.next()).done);H=!0){var C=E.value;-1===["prototype","name","length","caller","arguments","isSupported"].indexOf(C)&&Y(C)}}catch(B){G=!0,F=B}finally{try{!H&&D["return"]&&D["return"]()}finally{if(G){throw F}}}I.isSupported=function(){var d="Safari"===J.browser.name,c="mobile"===J.device.type||"tablet"===J.device.type||"console"===J.device.type||"Android"===J.os.name||"iOS"===J.os.name;return P["default"].isSupported()&&!d&&!c},I.getBrowserName=function(){return J.browser.name},Z["default"]=I,aa.exports=Z["default"]},{"babel-runtime/core-js/get-iterator":5,"babel-runtime/core-js/object/define-property":7,"babel-runtime/core-js/object/get-own-property-names":9,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/interop-require-default":15,"hls.js":189,"hlsjs-wrapper":202,"streamroot-p2p":265,"ua-parser-js":337}],3:[function(g,f,j){function i(k,e,n){function m(b,c){if(m.count<=0){throw new Error("after called too many times")}--m.count,b?(l=!0,e(b),e=n):0!==m.count||l||e(null,c)}var l=!1;return n=n||h,m.count=k,0===k?e():m}function h(){}f.exports=i},{}],4:[function(e,d,f){d.exports=function(j,i,p){var o=j.byteLength;if(i=i||0,p=p||o,j.slice){return j.slice(i,p)}if(0>i&&(i+=o),0>p&&(p+=o),p>o&&(p=o),i>=o||i>=p||0===o){return new ArrayBuffer(0)}for(var n=new Uint8Array(j),m=new Uint8Array(p-i),l=i,k=0;p>l;l++,k++){m[k]=n[l]}return m.buffer}},{}],5:[function(e,d,f){d.exports={"default":e("core-js/library/fn/get-iterator"),__esModule:!0}},{"core-js/library/fn/get-iterator":16}],6:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":17}],7:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":18}],8:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-descriptor":19}],9:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/get-own-property-names"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-names":20}],10:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":21}],11:[function(e,d,f){f["default"]=function(g,c){if(!(g instanceof c)){throw new TypeError("Cannot call a class as a function")}},f.__esModule=!0},{}],12:[function(f,e,h){var g=f("babel-runtime/core-js/object/define-property")["default"];h["default"]=function(){function b(i,d){for(var k=0;k<d.length;k++){var j=d[k];j.enumerable=j.enumerable||!1,j.configurable=!0,"value" in j&&(j.writable=!0),g(i,j.key,j)}}return function(i,k,j){return k&&b(i.prototype,k),j&&b(i,j),i}}(),h.__esModule=!0},{"babel-runtime/core-js/object/define-property":7}],13:[function(f,e,h){var g=f("babel-runtime/core-js/object/get-own-property-descriptor")["default"];h["default"]=function(t,s,r){for(var q=!0;q;){var p=t,o=s,n=r;q=!1,null===p&&(p=Function.prototype);var m=g(p,o);if(void 0!==m){if("value" in m){return m.value}var l=m.get;return void 0===l?void 0:l.call(n)}var d=Object.getPrototypeOf(p);if(null===d){return void 0}t=d,s=o,r=n,q=!0,m=d=void 0}},h.__esModule=!0},{"babel-runtime/core-js/object/get-own-property-descriptor":8}],14:[function(g,f,j){var i=g("babel-runtime/core-js/object/create")["default"],h=g("babel-runtime/core-js/object/set-prototype-of")["default"];j["default"]=function(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=i(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(h?h(d,c):d.__proto__=c)},j.__esModule=!0},{"babel-runtime/core-js/object/create":6,"babel-runtime/core-js/object/set-prototype-of":10}],15:[function(e,d,f){f["default"]=function(b){return b&&b.__esModule?b:{"default":b}},f.__esModule=!0},{}],16:[function(e,d,f){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),d.exports=e("../modules/core.get-iterator")},{"../modules/core.get-iterator":57,"../modules/es6.string.iterator":62,"../modules/web.dom.iterable":63}],17:[function(f,e,h){var g=f("../../modules/$");e.exports=function(d,c){return g.create(d,c)}},{"../../modules/$":43}],18:[function(f,e,h){var g=f("../../modules/$");e.exports=function(i,d,j){return g.setDesc(i,d,j)}},{"../../modules/$":43}],19:[function(f,e,h){var g=f("../../modules/$");f("../../modules/es6.object.get-own-property-descriptor"),e.exports=function(d,c){return g.getDesc(d,c)}},{"../../modules/$":43,"../../modules/es6.object.get-own-property-descriptor":59}],20:[function(f,e,h){var g=f("../../modules/$");f("../../modules/es6.object.get-own-property-names"),e.exports=function(b){return g.getNames(b)}},{"../../modules/$":43,"../../modules/es6.object.get-own-property-names":60}],21:[function(e,d,f){e("../../modules/es6.object.set-prototype-of"),d.exports=e("../../modules/$.core").Object.setPrototypeOf},{"../../modules/$.core":27,"../../modules/es6.object.set-prototype-of":61}],22:[function(e,d,f){d.exports=function(b){if("function"!=typeof b){throw TypeError(b+" is not a function!")}return b}},{}],23:[function(e,d,f){d.exports=function(){}},{}],24:[function(f,e,h){var g=f("./$.is-object");e.exports=function(b){if(!g(b)){throw TypeError(b+" is not an object!")}return b}},{"./$.is-object":38}],25:[function(h,g,l){var k=h("./$.cof"),j=h("./$.wks")("toStringTag"),i="Arguments"==k(function(){return arguments}());g.exports=function(e){var d,m,f;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(m=(d=Object(e))[j])?m:i?k(d):"Object"==(f=k(d))&&"function"==typeof d.callee?"Arguments":f}},{"./$.cof":26,"./$.wks":55}],26:[function(f,e,h){var g={}.toString;e.exports=function(b){return g.call(b).slice(8,-1)}},{}],27:[function(f,e,h){var g=e.exports={version:"1.2.5"};"number"==typeof __e&&(__e=g)},{}],28:[function(f,e,h){var g=f("./$.a-function");e.exports=function(i,d,j){if(g(i),void 0===d){return i}switch(j){case 1:return function(b){return i.call(d,b)};case 2:return function(k,b){return i.call(d,k,b)};case 3:return function(l,k,b){return i.call(d,l,k,b)}}return function(){return i.apply(d,arguments)}}},{"./$.a-function":22}],29:[function(j,i,p){var o=j("./$.global"),n=j("./$.core"),m="prototype",l=function(d,c){return function(){return d.apply(c,arguments)}},k=function(v,u,t){var s,r,q,h,g=v&k.G,f=v&k.P,e=g?o:v&k.S?o[u]:(o[u]||{})[m],d=g?n:n[u]||(n[u]={});g&&(t=u);for(s in t){r=!(v&k.F)&&e&&s in e,r&&s in d||(q=r?e[s]:t[s],g&&"function"!=typeof e[s]?h=t[s]:v&k.B&&r?h=l(q,o):v&k.W&&e[s]==q?!function(b){h=function(c){return this instanceof b?new b(c):b(c)},h[m]=b[m]}(q):h=f&&"function"==typeof q?l(Function.call,q):q,d[s]=h,f&&((d[m]||(d[m]={}))[s]=q))}};k.F=1,k.G=2,k.S=4,k.P=8,k.B=16,k.W=32,i.exports=k},{"./$.core":27,"./$.global":34}],30:[function(e,d,f){d.exports=function(b){if(void 0==b){throw TypeError("Can't call method on  "+b)}return b}},{}],31:[function(e,d,f){d.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":32}],32:[function(e,d,f){d.exports=function(g){try{return !!g()}catch(c){return !0}}},{}],33:[function(j,i,p){var o={}.toString,n=j("./$.to-iobject"),m=j("./$").getNames,l="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],k=function(d){try{return m(d)}catch(c){return l.slice()}};i.exports.get=function(b){return l&&"[object Window]"==o.call(b)?k(b):m(n(b))}},{"./$":43,"./$.to-iobject":53}],34:[function(f,e,h){var g=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=g)},{}],35:[function(f,e,h){var g={}.hasOwnProperty;e.exports=function(d,c){return g.call(d,c)}},{}],36:[function(g,f,j){var i=g("./$"),h=g("./$.property-desc");f.exports=g("./$.descriptors")?function(e,d,k){return i.setDesc(e,d,h(1,k))}:function(e,d,k){return e[d]=k,e}},{"./$":43,"./$.descriptors":31,"./$.property-desc":46}],37:[function(f,e,h){var g=f("./$.cof");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(b){return"String"==g(b)?b.split(""):Object(b)}},{"./$.cof":26}],38:[function(e,d,f){d.exports=function(b){return"object"==typeof b?null!==b:"function"==typeof b}},{}],39:[function(i,h,n){var m=i("./$"),l=i("./$.property-desc"),k=i("./$.set-to-string-tag"),j={};i("./$.hide")(j,i("./$.wks")("iterator"),function(){return this}),h.exports=function(e,d,f){e.prototype=m.create(j,{next:l(1,f)}),k(e,d+" Iterator")}},{"./$":43,"./$.hide":36,"./$.property-desc":46,"./$.set-to-string-tag":49,"./$.wks":55}],40:[function(J,I,H){var G=J("./$.library"),F=J("./$.def"),E=J("./$.redef"),D=J("./$.hide"),C=J("./$.has"),B=J("./$.wks")("iterator"),A=J("./$.iterators"),z=J("./$.iter-create"),y=J("./$.set-to-string-tag"),x=J("./$").getProto,w=!([].keys&&"next" in [].keys()),v="@@iterator",u="keys",t="values",s=function(){return this};I.exports=function(m,k,i,r,q,p,o){z(i,k,r);var n,l,j=function(b){if(!w&&b in g){return g[b]}switch(b){case u:return function(){return new i(this,b)};case t:return function(){return new i(this,b)}}return function(){return new i(this,b)}},h=k+" Iterator",g=m.prototype,f=g[B]||g[v]||q&&g[q],e=f||j(q);if(f){var d=x(e.call(new m));y(d,h,!0),!G&&C(g,v)&&D(d,B,s)}if(G&&!o||!w&&B in g||D(g,B,e),A[k]=e,A[h]=s,q){if(n={values:q==t?e:j(t),keys:p?e:j(u),entries:q!=t?e:j("entries")},o){for(l in n){l in g||E(g,l,n[l])}}else{F(F.P+F.F*w,k,n)}}return n}},{"./$":43,"./$.def":29,"./$.has":35,"./$.hide":36,"./$.iter-create":39,"./$.iterators":42,"./$.library":44,"./$.redef":47,"./$.set-to-string-tag":49,"./$.wks":55}],41:[function(e,d,f){d.exports=function(g,c){return{value:c,done:!!g}}},{}],42:[function(e,d,f){d.exports={}},{}],43:[function(f,e,h){var g=Object;e.exports={create:g.create,getProto:g.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:g.getOwnPropertyDescriptor,setDesc:g.defineProperty,setDescs:g.defineProperties,getKeys:g.keys,getNames:g.getOwnPropertyNames,getSymbols:g.getOwnPropertySymbols,each:[].forEach}},{}],44:[function(e,d,f){d.exports=!0},{}],45:[function(g,f,j){var i=(g("./$.def"),g("./$.core")),h=g("./$.fails");f.exports=function(d,m){var l=g("./$.def"),k=(i.Object||{})[d]||Object[d],e={};e[d]=m(k),l(l.S+l.F*h(function(){k(1)}),"Object",e)}},{"./$.core":27,"./$.def":29,"./$.fails":32}],46:[function(e,d,f){d.exports=function(g,c){return{enumerable:!(1&g),configurable:!(2&g),writable:!(4&g),value:c}}},{}],47:[function(e,d,f){d.exports=e("./$.hide")},{"./$.hide":36}],48:[function(i,h,n){var m=i("./$").getDesc,l=i("./$.is-object"),k=i("./$.an-object"),j=function(d,c){if(k(d),!l(c)&&null!==c){throw TypeError(c+": can't set as prototype!")}};h.exports={set:Object.setPrototypeOf||("__proto__" in {}?function(d,p,o){try{o=i("./$.ctx")(Function.call,m(Object.prototype,"__proto__").set,2),o(d,[]),p=!(d instanceof Array)}catch(g){p=!0}return function(e,c){return j(e,c),p?e.__proto__=c:o(e,c),e}}({},!1):void 0),check:j}},{"./$":43,"./$.an-object":24,"./$.ctx":28,"./$.is-object":38}],49:[function(h,g,l){var k=h("./$").setDesc,j=h("./$.has"),i=h("./$.wks")("toStringTag");g.exports=function(e,d,f){e&&!j(e=f?e:e.prototype,i)&&k(e,i,{configurable:!0,value:d})}},{"./$":43,"./$.has":35,"./$.wks":55}],50:[function(h,g,l){var k=h("./$.global"),j="__core-js_shared__",i=k[j]||(k[j]={});g.exports=function(b){return i[b]||(i[b]={})}},{"./$.global":34}],51:[function(g,f,j){var i=g("./$.to-integer"),h=g("./$.defined");f.exports=function(b){return function(d,o){var n,m,l=String(h(d)),k=i(o),e=l.length;return 0>k||k>=e?b?"":void 0:(n=l.charCodeAt(k),55296>n||n>56319||k+1===e||(m=l.charCodeAt(k+1))<56320||m>57343?b?l.charAt(k):n:b?l.slice(k,k+2):(n-55296<<10)+(m-56320)+65536)}}},{"./$.defined":30,"./$.to-integer":52}],52:[function(g,f,j){var i=Math.ceil,h=Math.floor;f.exports=function(b){return isNaN(b=+b)?0:(b>0?h:i)(b)}},{}],53:[function(g,f,j){var i=g("./$.iobject"),h=g("./$.defined");f.exports=function(b){return i(h(b))}},{"./$.defined":30,"./$.iobject":37}],54:[function(g,f,j){var i=0,h=Math.random();f.exports=function(b){return"Symbol(".concat(void 0===b?"":b,")_",(++i+h).toString(36))}},{}],55:[function(h,g,l){var k=h("./$.shared")("wks"),j=h("./$.uid"),i=h("./$.global").Symbol;g.exports=function(b){return k[b]||(k[b]=i&&i[b]||(i||j)("Symbol."+b))}},{"./$.global":34,"./$.shared":50,"./$.uid":54}],56:[function(h,g,l){var k=h("./$.classof"),j=h("./$.wks")("iterator"),i=h("./$.iterators");g.exports=h("./$.core").getIteratorMethod=function(b){return void 0!=b?b[j]||b["@@iterator"]||i[k(b)]:void 0}},{"./$.classof":25,"./$.core":27,"./$.iterators":42,"./$.wks":55}],57:[function(g,f,j){var i=g("./$.an-object"),h=g("./core.get-iterator-method");f.exports=g("./$.core").getIterator=function(d){var c=h(d);if("function"!=typeof c){throw TypeError(d+" is not iterable!")}return i(c.call(d))}},{"./$.an-object":24,"./$.core":27,"./core.get-iterator-method":56}],58:[function(i,h,n){var m=i("./$.add-to-unscopables"),l=i("./$.iter-step"),k=i("./$.iterators"),j=i("./$.to-iobject");h.exports=i("./$.iter-define")(Array,"Array",function(d,c){this._t=j(d),this._i=0,this._k=c},function(){var e=this._t,d=this._k,f=this._i++;return !e||f>=e.length?(this._t=void 0,l(1)):"keys"==d?l(0,f):"values"==d?l(0,e[f]):l(0,[f,e[f]])},"values"),k.Arguments=k.Array,m("keys"),m("values"),m("entries")},{"./$.add-to-unscopables":23,"./$.iter-define":40,"./$.iter-step":41,"./$.iterators":42,"./$.to-iobject":53}],59:[function(f,e,h){var g=f("./$.to-iobject");f("./$.object-sap")("getOwnPropertyDescriptor",function(b){return function(d,i){return b(g(d),i)}})},{"./$.object-sap":45,"./$.to-iobject":53}],60:[function(e,d,f){e("./$.object-sap")("getOwnPropertyNames",function(){return e("./$.get-names").get})},{"./$.get-names":33,"./$.object-sap":45}],61:[function(f,e,h){var g=f("./$.def");g(g.S,"Object",{setPrototypeOf:f("./$.set-proto").set})},{"./$.def":29,"./$.set-proto":48}],62:[function(f,e,h){var g=f("./$.string-at")(!0);f("./$.iter-define")(String,"String",function(b){this._t=String(b),this._i=0},function(){var i,d=this._t,j=this._i;return j>=d.length?{value:void 0,done:!0}:(i=g(d,j),this._i+=i.length,{value:i,done:!1})})},{"./$.iter-define":40,"./$.string-at":51}],63:[function(f,e,h){f("./es6.array.iterator");var g=f("./$.iterators");g.NodeList=g.HTMLCollection=g.Array},{"./$.iterators":42,"./es6.array.iterator":58}],64:[function(f,e,h){function g(b){b=b||{},this.ms=b.min||100,this.max=b.max||10000,this.factor=b.factor||2,this.jitter=b.jitter>0&&b.jitter<=1?b.jitter:0,this.attempts=0}e.exports=g,g.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var d=Math.random(),j=Math.floor(d*this.jitter*i);i=0==(1&Math.floor(10*d))?i-j:i+j}return 0|Math.min(i,this.max)},g.prototype.reset=function(){this.attempts=0},g.prototype.setMin=function(b){this.ms=b},g.prototype.setMax=function(b){this.max=b},g.prototype.setJitter=function(b){this.jitter=b}},{}],65:[function(e,d,f){!function(b){f.encode=function(g){var k,j=new Uint8Array(g),i=j.length,h="";for(k=0;i>k;k+=3){h+=b[j[k]>>2],h+=b[(3&j[k])<<4|j[k+1]>>4],h+=b[(15&j[k+1])<<2|j[k+2]>>6],h+=b[63&j[k+2]]}return i%3===2?h=h.substring(0,h.length-1)+"=":i%3===1&&(h=h.substring(0,h.length-2)+"=="),h},f.decode=function(w){var v,u,t,s,r,q=0.75*w.length,p=w.length,o=0;"="===w[w.length-1]&&(q--,"="===w[w.length-2]&&q--);var n=new ArrayBuffer(q),m=new Uint8Array(n);for(v=0;p>v;v+=4){u=b.indexOf(w[v]),t=b.indexOf(w[v+1]),s=b.indexOf(w[v+2]),r=b.indexOf(w[v+3]),m[o++]=u<<2|t>>4,m[o++]=(15&t)<<4|s>>2,m[o++]=(3&s)<<6|63&r}return n}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],66:[function(f,e,h){var g=[].slice;e.exports=function(i,d){if("string"==typeof d&&(d=i[d]),"function"!=typeof d){throw new Error("bind() requires a function")}var j=g.call(arguments,2);return function(){return d.apply(i,j.concat(g.call(arguments)))}}},{}],67:[function(g,f,j){function i(b){return b?h(b):void 0}function h(d){for(var c in i.prototype){d[c]=i.prototype[c]}return d}f.exports=i,i.prototype.on=i.prototype.addEventListener=function(d,c){return this._callbacks=this._callbacks||{},(this._callbacks[d]=this._callbacks[d]||[]).push(c),this},i.prototype.once=function(k,e){function m(){l.off(k,m),e.apply(this,arguments)}var l=this;return this._callbacks=this._callbacks||{},m.fn=e,this.on(k,m),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(l,k){if(this._callbacks=this._callbacks||{},0==arguments.length){return this._callbacks={},this}var o=this._callbacks[l];if(!o){return this}if(1==arguments.length){return delete this._callbacks[l],this}for(var n,m=0;m<o.length;m++){if(n=o[m],n===k||n.fn===k){o.splice(m,1);break}}return this},i.prototype.emit=function(l){this._callbacks=this._callbacks||{};var k=[].slice.call(arguments,1),o=this._callbacks[l];if(o){o=o.slice(0);for(var n=0,m=o.length;m>n;++n){o[n].apply(this,k)}}return this},i.prototype.listeners=function(b){return this._callbacks=this._callbacks||{},this._callbacks[b]||[]},i.prototype.hasListeners=function(b){return !!this.listeners(b).length}},{}],68:[function(e,d,f){d.exports=function(h,g){var i=function(){};i.prototype=g.prototype,h.prototype=new i,h.prototype.constructor=h}},{}],69:[function(e,d,f){e("../../modules/es6.string.iterator"),e("../../modules/es6.array.from"),d.exports=e("../../modules/$.core").Array.from},{"../../modules/$.core":94,"../../modules/es6.array.from":146,"../../modules/es6.string.iterator":158}],70:[function(e,d,f){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),d.exports=e("../modules/core.get-iterator")},{"../modules/core.get-iterator":144,"../modules/es6.string.iterator":158,"../modules/web.dom.iterable":161}],71:[function(e,d,f){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),d.exports=e("../modules/core.is-iterable")},{"../modules/core.is-iterable":145,"../modules/es6.string.iterator":158,"../modules/web.dom.iterable":161}],72:[function(e,d,f){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.map"),e("../modules/es7.map.to-json"),d.exports=e("../modules/$.core").Map},{"../modules/$.core":94,"../modules/es6.map":148,"../modules/es6.object.to-string":156,"../modules/es6.string.iterator":158,"../modules/es7.map.to-json":160,"../modules/web.dom.iterable":161}],73:[function(e,d,f){e("../../modules/es6.object.assign"),d.exports=e("../../modules/$.core").Object.assign},{"../../modules/$.core":94,"../../modules/es6.object.assign":149}],74:[function(f,e,h){var g=f("../../modules/$");e.exports=function(d,c){return g.create(d,c)}},{"../../modules/$":119}],75:[function(f,e,h){var g=f("../../modules/$");e.exports=function(d,c){return g.setDescs(d,c)}},{"../../modules/$":119}],76:[function(f,e,h){var g=f("../../modules/$");e.exports=function(i,d,j){return g.setDesc(i,d,j)}},{"../../modules/$":119}],77:[function(e,d,f){e("../../modules/es6.object.freeze"),d.exports=e("../../modules/$.core").Object.freeze},{"../../modules/$.core":94,"../../modules/es6.object.freeze":150}],78:[function(f,e,h){var g=f("../../modules/$");f("../../modules/es6.object.get-own-property-descriptor"),e.exports=function(d,c){return g.getDesc(d,c)}},{"../../modules/$":119,"../../modules/es6.object.get-own-property-descriptor":151}],79:[function(f,e,h){var g=f("../../modules/$");f("../../modules/es6.object.get-own-property-names"),e.exports=function(b){return g.getNames(b)}},{"../../modules/$":119,"../../modules/es6.object.get-own-property-names":152}],80:[function(e,d,f){e("../../modules/es6.object.keys"),d.exports=e("../../modules/$.core").Object.keys},{"../../modules/$.core":94,"../../modules/es6.object.keys":153}],81:[function(e,d,f){e("../../modules/es6.object.seal"),d.exports=e("../../modules/$.core").Object.seal},{"../../modules/$.core":94,"../../modules/es6.object.seal":154}],82:[function(e,d,f){e("../../modules/es6.object.set-prototype-of"),d.exports=e("../../modules/$.core").Object.setPrototypeOf},{"../../modules/$.core":94,"../../modules/es6.object.set-prototype-of":155}],83:[function(e,d,f){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.promise"),d.exports=e("../modules/$.core").Promise},{"../modules/$.core":94,"../modules/es6.object.to-string":156,"../modules/es6.promise":157,"../modules/es6.string.iterator":158,"../modules/web.dom.iterable":161}],84:[function(e,d,f){e("../../modules/es6.symbol"),e("../../modules/es6.object.to-string"),d.exports=e("../../modules/$.core").Symbol},{"../../modules/$.core":94,"../../modules/es6.object.to-string":156,"../../modules/es6.symbol":159}],85:[function(e,d,f){e("../../modules/es6.string.iterator"),e("../../modules/web.dom.iterable"),d.exports=e("../../modules/$.wks")("iterator")},{"../../modules/$.wks":142,"../../modules/es6.string.iterator":158,"../../modules/web.dom.iterable":161}],86:[function(e,d,f){d.exports=function(b){if("function"!=typeof b){throw TypeError(b+" is not a function!")}return b}},{}],87:[function(e,d,f){d.exports=function(){}},{}],88:[function(f,e,h){var g=f("./$.is-object");e.exports=function(b){if(!g(b)){throw TypeError(b+" is not an object!")}return b}},{"./$.is-object":112}],89:[function(h,g,l){var k=h("./$.cof"),j=h("./$.wks")("toStringTag"),i="Arguments"==k(function(){return arguments}());g.exports=function(e){var d,m,f;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(m=(d=Object(e))[j])?m:i?k(d):"Object"==(f=k(d))&&"function"==typeof d.callee?"Arguments":f}},{"./$.cof":90,"./$.wks":142}],90:[function(f,e,h){var g={}.toString;e.exports=function(b){return g.call(b).slice(8,-1)}},{}],91:[function(R,Q,P){var O=R("./$"),N=R("./$.hide"),M=R("./$.redefine-all"),L=R("./$.ctx"),K=R("./$.strict-new"),J=R("./$.defined"),I=R("./$.for-of"),H=R("./$.iter-define"),G=R("./$.iter-step"),F=R("./$.uid")("id"),E=R("./$.has"),D=R("./$.is-object"),C=R("./$.set-species"),B=R("./$.descriptors"),A=Object.isExtensible||D,z=B?"_s":"size",y=0,x=function(d,c){if(!D(d)){return"symbol"==typeof d?d:("string"==typeof d?"S":"P")+d}if(!E(d,F)){if(!A(d)){return"F"}if(!c){return"E"}N(d,F,++y)}return"O"+d[F]},w=function(f,e){var h,g=x(e);if("F"!==g){return f._i[g]}for(h=f._f;h;h=h.n){if(h.k==e){return h}}};Q.exports={getConstructor:function(f,d,i,h){var g=f(function(b,c){K(b,g,d),b._i=O.create(null),b._f=void 0,b._l=void 0,b[z]=0,void 0!=c&&I(c,i,b[h],b)});return M(g.prototype,{clear:function(){for(var j=this,e=j._i,k=j._f;k;k=k.n){k.r=!0,k.p&&(k.p=k.p.n=void 0),delete e[k.i]}j._f=j._l=void 0,j[z]=0},"delete":function(k){var j=this,n=w(j,k);if(n){var m=n.n,l=n.p;delete j._i[n.i],n.r=!0,l&&(l.n=m),m&&(m.p=l),j._f==n&&(j._f=m),j._l==n&&(j._l=l),j[z]--}return !!n},forEach:function(j){for(var e,k=L(j,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;){for(k(e.v,e.k,this);e&&e.r;){e=e.p}}},has:function(b){return !!w(this,b)}}),B&&O.setDesc(g.prototype,"size",{get:function(){return J(this[z])}}),g},def:function(h,g,l){var k,j,i=w(h,g);return i?i.v=l:(h._l=i={i:j=x(g,!0),k:g,v:l,p:k=h._l,n:void 0,r:!1},h._f||(h._f=i),k&&(k.n=i),h[z]++,"F"!==j&&(h._i[j]=i)),h},getEntry:w,setStrong:function(e,d,f){H(e,d,function(g,c){this._t=g,this._k=c,this._l=void 0},function(){for(var h=this,g=h._k,i=h._l;i&&i.r;){i=i.p}return h._t&&(h._l=i=i?i.n:h._t._f)?"keys"==g?G(0,i.k):"values"==g?G(0,i.v):G(0,[i.k,i.v]):(h._t=void 0,G(1))},f?"entries":"values",!f,!0),C(d)}}},{"./$":119,"./$.ctx":95,"./$.defined":96,"./$.descriptors":97,"./$.for-of":102,"./$.has":105,"./$.hide":106,"./$.is-object":112,"./$.iter-define":115,"./$.iter-step":117,"./$.redefine-all":126,"./$.set-species":130,"./$.strict-new":134,"./$.uid":141}],92:[function(g,f,j){var i=g("./$.for-of"),h=g("./$.classof");f.exports=function(b){return function(){if(h(this)!=b){throw TypeError(b+"#toJSON isn't generic")}var c=[];return i(this,!1,c.push,c),c}}},{"./$.classof":89,"./$.for-of":102}],93:[function(B,A,z){var y=B("./$"),x=B("./$.global"),w=B("./$.export"),v=B("./$.fails"),u=B("./$.hide"),t=B("./$.redefine-all"),s=B("./$.for-of"),r=B("./$.strict-new"),q=B("./$.is-object"),p=B("./$.set-to-string-tag"),o=B("./$.descriptors");A.exports=function(j,i,h,g,f,e){var d=x[j],n=d,m=f?"set":"add",l=n&&n.prototype,k={};return o&&"function"==typeof n&&(e||l.forEach&&!v(function(){(new n).entries().next()}))?(n=i(function(C,D){r(C,n,j),C._c=new d,void 0!=D&&s(D,f,C[m],C)}),y.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(C){var c="add"==C||"set"==C;C in l&&(!e||"clear"!=C)&&u(n.prototype,C,function(E,D){if(!c&&e&&!q(E)){return"get"==C?void 0:!1}var b=this._c[C](0===E?0:E,D);return c?this:b})}),"size" in l&&y.setDesc(n.prototype,"size",{get:function(){return this._c.size}})):(n=g.getConstructor(i,j,f,m),t(n.prototype,h)),p(n,j),k[j]=n,w(w.G+w.W+w.F,k),e||g.setStrong(n,j,f),n}},{"./$":119,"./$.descriptors":97,"./$.export":100,"./$.fails":101,"./$.for-of":102,"./$.global":104,"./$.hide":106,"./$.is-object":112,"./$.redefine-all":126,"./$.set-to-string-tag":131,"./$.strict-new":134}],94:[function(f,e,h){var g=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=g)},{}],95:[function(f,e,h){var g=f("./$.a-function");e.exports=function(i,d,j){if(g(i),void 0===d){return i}switch(j){case 1:return function(b){return i.call(d,b)};case 2:return function(k,b){return i.call(d,k,b)};case 3:return function(l,k,b){return i.call(d,l,k,b)}}return function(){return i.apply(d,arguments)}}},{"./$.a-function":86}],96:[function(e,d,f){d.exports=function(b){if(void 0==b){throw TypeError("Can't call method on  "+b)}return b}},{}],97:[function(e,d,f){d.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":101}],98:[function(h,g,l){var k=h("./$.is-object"),j=h("./$.global").document,i=k(j)&&k(j.createElement);g.exports=function(b){return i?j.createElement(b):{}}},{"./$.global":104,"./$.is-object":112}],99:[function(f,e,h){var g=f("./$");e.exports=function(i){var d=g.getKeys(i),n=g.getSymbols;if(n){for(var m,l=n(i),k=g.isEnum,j=0;l.length>j;){k.call(i,m=l[j++])&&d.push(m)}}return d}},{"./$":119}],100:[function(j,i,p){var o=j("./$.global"),n=j("./$.core"),m=j("./$.ctx"),l="prototype",k=function(A,z,y){var x,w,v,u=A&k.F,t=A&k.G,h=A&k.S,g=A&k.P,f=A&k.B,e=A&k.W,d=t?n:n[z]||(n[z]={}),B=t?o:h?o[z]:(o[z]||{})[l];t&&(y=z);for(x in y){w=!u&&B&&x in B,w&&x in d||(v=w?B[x]:y[x],d[x]=t&&"function"!=typeof B[x]?y[x]:f&&w?m(v,o):e&&B[x]==v?function(q){var c=function(r){return this instanceof q?new q(r):q(r)};return c[l]=q[l],c}(v):g&&"function"==typeof v?m(Function.call,v):v,g&&((d[l]||(d[l]={}))[x]=v))}};k.F=1,k.G=2,k.S=4,k.P=8,k.B=16,k.W=32,i.exports=k},{"./$.core":94,"./$.ctx":95,"./$.global":104}],101:[function(e,d,f){d.exports=function(g){try{return !!g()}catch(c){return !0}}},{}],102:[function(r,q,p){var o=r("./$.ctx"),n=r("./$.iter-call"),m=r("./$.is-array-iter"),l=r("./$.an-object"),k=r("./$.to-length"),j=r("./core.get-iterator-method");q.exports=function(v,u,t,s){var i,h,g,f=j(v),e=o(t,s,u?2:1),d=0;if("function"!=typeof f){throw TypeError(v+" is not iterable!")}if(m(f)){for(i=k(v.length);i>d;d++){u?e(l(h=v[d])[0],h[1]):e(v[d])}}else{for(g=f.call(v);!(h=g.next()).done;){n(g,e,h.value,u)}}}},{"./$.an-object":88,"./$.ctx":95,"./$.is-array-iter":110,"./$.iter-call":113,"./$.to-length":139,"./core.get-iterator-method":143}],103:[function(j,i,p){var o=j("./$.to-iobject"),n=j("./$").getNames,m={}.toString,l="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],k=function(d){try{return n(d)}catch(c){return l.slice()}};i.exports.get=function(b){return l&&"[object Window]"==m.call(b)?k(b):n(o(b))}},{"./$":119,"./$.to-iobject":138}],104:[function(f,e,h){var g=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=g)},{}],105:[function(f,e,h){var g={}.hasOwnProperty;e.exports=function(d,c){return g.call(d,c)}},{}],106:[function(g,f,j){var i=g("./$"),h=g("./$.property-desc");f.exports=g("./$.descriptors")?function(e,d,k){return i.setDesc(e,d,h(1,k))}:function(e,d,k){return e[d]=k,e}},{"./$":119,"./$.descriptors":97,"./$.property-desc":125}],107:[function(e,d,f){d.exports=e("./$.global").document&&document.documentElement},{"./$.global":104}],108:[function(e,d,f){d.exports=function(h,g,j){var i=void 0===j;switch(g.length){case 0:return i?h():h.call(j);case 1:return i?h(g[0]):h.call(j,g[0]);case 2:return i?h(g[0],g[1]):h.call(j,g[0],g[1]);case 3:return i?h(g[0],g[1],g[2]):h.call(j,g[0],g[1],g[2]);case 4:return i?h(g[0],g[1],g[2],g[3]):h.call(j,g[0],g[1],g[2],g[3])}return h.apply(j,g)}},{}],109:[function(f,e,h){var g=f("./$.cof");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(b){return"String"==g(b)?b.split(""):Object(b)}},{"./$.cof":90}],110:[function(h,g,l){var k=h("./$.iterators"),j=h("./$.wks")("iterator"),i=Array.prototype;g.exports=function(b){return void 0!==b&&(k.Array===b||i[j]===b)}},{"./$.iterators":118,"./$.wks":142}],111:[function(f,e,h){var g=f("./$.cof");e.exports=Array.isArray||function(b){return"Array"==g(b)}},{"./$.cof":90}],112:[function(e,d,f){d.exports=function(b){return"object"==typeof b?null!==b:"function"==typeof b}},{}],113:[function(f,e,h){var g=f("./$.an-object");e.exports=function(i,d,m,l){try{return l?d(g(m)[0],m[1]):d(m)}catch(k){var j=i["return"];throw void 0!==j&&g(j.call(i)),k}}},{"./$.an-object":88}],114:[function(i,h,n){var m=i("./$"),l=i("./$.property-desc"),k=i("./$.set-to-string-tag"),j={};i("./$.hide")(j,i("./$.wks")("iterator"),function(){return this}),h.exports=function(e,d,f){e.prototype=m.create(j,{next:l(1,f)}),k(e,d+" Iterator")}},{"./$":119,"./$.hide":106,"./$.property-desc":125,"./$.set-to-string-tag":131,"./$.wks":142}],115:[function(J,I,H){var G=J("./$.library"),F=J("./$.export"),E=J("./$.redefine"),D=J("./$.hide"),C=J("./$.has"),B=J("./$.iterators"),A=J("./$.iter-create"),z=J("./$.set-to-string-tag"),y=J("./$").getProto,x=J("./$.wks")("iterator"),w=!([].keys&&"next" in [].keys()),v="@@iterator",u="keys",t="values",s=function(){return this};I.exports=function(m,k,i,L,r,p,o){A(i,k,L);var n,l,j=function(b){if(!w&&b in e){return e[b]}switch(b){case u:return function(){return new i(this,b)};case t:return function(){return new i(this,b)}}return function(){return new i(this,b)}},h=k+" Iterator",g=r==t,f=!1,e=m.prototype,d=e[x]||e[v]||r&&e[r],K=d||j(r);if(d){var q=y(K.call(new m));z(q,h,!0),!G&&C(e,v)&&D(q,x,s),g&&d.name!==t&&(f=!0,K=function(){return d.call(this)})}if(G&&!o||!w&&!f&&e[x]||D(e,x,K),B[k]=K,B[h]=s,r){if(n={values:g?K:j(t),keys:p?K:j(u),entries:g?j("entries"):K},o){for(l in n){l in e||E(e,l,n[l])}}else{F(F.P+F.F*(w||f),k,n)}}return n}},{"./$":119,"./$.export":100,"./$.has":105,"./$.hide":106,"./$.iter-create":114,"./$.iterators":118,"./$.library":121,"./$.redefine":127,"./$.set-to-string-tag":131,"./$.wks":142}],116:[function(i,h,n){var m=i("./$.wks")("iterator"),l=!1;try{var k=[7][m]();k["return"]=function(){l=!0},Array.from(k,function(){throw 2})}catch(j){}h.exports=function(e,d){if(!d&&!l){return !1}var r=!1;try{var q=[7],p=q[m]();p.next=function(){r=!0},q[m]=function(){return p},e(q)}catch(o){}return r}},{"./$.wks":142}],117:[function(e,d,f){d.exports=function(g,c){return{value:c,done:!!g}}},{}],118:[function(e,d,f){d.exports={}},{}],119:[function(f,e,h){var g=Object;e.exports={create:g.create,getProto:g.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:g.getOwnPropertyDescriptor,setDesc:g.defineProperty,setDescs:g.defineProperties,getKeys:g.keys,getNames:g.getOwnPropertyNames,getSymbols:g.getOwnPropertySymbols,each:[].forEach}},{}],120:[function(g,f,j){var i=g("./$"),h=g("./$.to-iobject");f.exports=function(e,d){for(var o,n=h(e),m=i.getKeys(n),l=m.length,k=0;l>k;){if(n[o=m[k++]]===d){return o}}}},{"./$":119,"./$.to-iobject":138}],121:[function(e,d,f){d.exports=!0},{}],122:[function(D,C,B){var A,z,y,x=D("./$.global"),w=D("./$.task").set,v=x.MutationObserver||x.WebKitMutationObserver,u=x.process,t=x.Promise,s="process"==D("./$.cof")(u),r=function(){var e,d,f;for(s&&(e=u.domain)&&(u.domain=null,e.exit());A;){d=A.domain,f=A.fn,d&&d.enter(),f(),d&&d.exit(),A=A.next}z=void 0,e&&e.enter()};if(s){y=function(){u.nextTick(r)}}else{if(v){var q=1,p=document.createTextNode("");new v(r).observe(p,{characterData:!0}),y=function(){p.data=q=-q}}else{y=t&&t.resolve?function(){t.resolve().then(r)}:function(){w.call(x,r)}}}C.exports=function(d){var c={fn:d,next:void 0,domain:s&&u.domain};z&&(z.next=c),A||(A=c,y()),z=c}},{"./$.cof":90,"./$.global":104,"./$.task":136}],123:[function(h,g,l){var k=h("./$"),j=h("./$.to-object"),i=h("./$.iobject");g.exports=h("./$.fails")(function(){var m=Object.assign,f={},p={},o=Symbol(),n="abcdefghijklmnopqrst";return f[o]=7,n.split("").forEach(function(b){p[b]=b}),7!=m({},f)[o]||Object.keys(m({},p)).join("")!=n})?function(B,A){for(var z=j(B),y=arguments,x=y.length,w=1,v=k.getKeys,u=k.getSymbols,t=k.isEnum;x>w;){for(var s,r=i(y[w++]),f=u?v(r).concat(u(r)):v(r),e=f.length,d=0;e>d;){t.call(r,s=f[d++])&&(z[s]=r[s])}}return z}:Object.assign},{"./$":119,"./$.fails":101,"./$.iobject":109,"./$.to-object":140}],124:[function(h,g,l){var k=h("./$.export"),j=h("./$.core"),i=h("./$.fails");g.exports=function(e,d){var m=(j.Object||{})[e]||Object[e],f={};f[e]=d(m),k(k.S+k.F*i(function(){m(1)}),"Object",f)}},{"./$.core":94,"./$.export":100,"./$.fails":101}],125:[function(e,d,f){d.exports=function(g,c){return{enumerable:!(1&g),configurable:!(2&g),writable:!(4&g),value:c}}},{}],126:[function(f,e,h){var g=f("./$.redefine");e.exports=function(i,d){for(var j in d){g(i,j,d[j])}return i}},{"./$.redefine":127}],127:[function(e,d,f){d.exports=e("./$.hide")},{"./$.hide":106}],128:[function(e,d,f){d.exports=Object.is||function(g,c){return g===c?0!==g||1/g===1/c:g!=g&&c!=c}},{}],129:[function(i,h,n){var m=i("./$").getDesc,l=i("./$.is-object"),k=i("./$.an-object"),j=function(d,c){if(k(d),!l(c)&&null!==c){throw TypeError(c+": can't set as prototype!")}};h.exports={set:Object.setPrototypeOf||("__proto__" in {}?function(d,p,o){try{o=i("./$.ctx")(Function.call,m(Object.prototype,"__proto__").set,2),o(d,[]),p=!(d instanceof Array)}catch(g){p=!0}return function(e,c){return j(e,c),p?e.__proto__=c:o(e,c),e}}({},!1):void 0),check:j}},{"./$":119,"./$.an-object":88,"./$.ctx":95,"./$.is-object":112}],130:[function(i,h,n){var m=i("./$.core"),l=i("./$"),k=i("./$.descriptors"),j=i("./$.wks")("species");h.exports=function(d){var c=m[d];k&&c&&!c[j]&&l.setDesc(c,j,{configurable:!0,get:function(){return this}})}},{"./$":119,"./$.core":94,"./$.descriptors":97,"./$.wks":142}],131:[function(h,g,l){var k=h("./$").setDesc,j=h("./$.has"),i=h("./$.wks")("toStringTag");g.exports=function(e,d,f){e&&!j(e=f?e:e.prototype,i)&&k(e,i,{configurable:!0,value:d})}},{"./$":119,"./$.has":105,"./$.wks":142}],132:[function(h,g,l){var k=h("./$.global"),j="__core-js_shared__",i=k[j]||(k[j]={});g.exports=function(b){return i[b]||(i[b]={})}},{"./$.global":104}],133:[function(h,g,l){var k=h("./$.an-object"),j=h("./$.a-function"),i=h("./$.wks")("species");g.exports=function(e,d){var m,f=k(e).constructor;return void 0===f||void 0==(m=k(f)[i])?d:j(m)}},{"./$.a-function":86,"./$.an-object":88,"./$.wks":142}],134:[function(e,d,f){d.exports=function(h,g,i){if(!(h instanceof g)){throw TypeError(i+": use the 'new' operator!")}return h}},{}],135:[function(g,f,j){var i=g("./$.to-integer"),h=g("./$.defined");f.exports=function(b){return function(d,o){var n,m,l=String(h(d)),k=i(o),e=l.length;return 0>k||k>=e?b?"":void 0:(n=l.charCodeAt(k),55296>n||n>56319||k+1===e||(m=l.charCodeAt(k+1))<56320||m>57343?b?l.charAt(k):n:b?l.slice(k,k+2):(n-55296<<10)+(m-56320)+65536)}}},{"./$.defined":96,"./$.to-integer":137}],136:[function(N,M,L){var K,J,I,H=N("./$.ctx"),G=N("./$.invoke"),F=N("./$.html"),E=N("./$.dom-create"),D=N("./$.global"),C=D.process,B=D.setImmediate,A=D.clearImmediate,z=D.MessageChannel,y=0,x={},w="onreadystatechange",v=function(){var d=+this;if(x.hasOwnProperty(d)){var c=x[d];delete x[d],c()}},u=function(b){v.call(b.data)};B&&A||(B=function(e){for(var d=[],f=1;arguments.length>f;){d.push(arguments[f++])}return x[++y]=function(){G("function"==typeof e?e:Function(e),d)},K(y),y},A=function(b){delete x[b]},"process"==N("./$.cof")(C)?K=function(b){C.nextTick(H(v,b,1))}:z?(J=new z,I=J.port2,J.port1.onmessage=u,K=H(I.postMessage,I,1)):D.addEventListener&&"function"==typeof postMessage&&!D.importScripts?(K=function(b){D.postMessage(b+"","*")},D.addEventListener("message",u,!1)):K=w in E("script")?function(b){F.appendChild(E("script"))[w]=function(){F.removeChild(this),v.call(b)}}:function(b){setTimeout(H(v,b,1),0)}),M.exports={set:B,clear:A}},{"./$.cof":90,"./$.ctx":95,"./$.dom-create":98,"./$.global":104,"./$.html":107,"./$.invoke":108}],137:[function(g,f,j){var i=Math.ceil,h=Math.floor;f.exports=function(b){return isNaN(b=+b)?0:(b>0?h:i)(b)}},{}],138:[function(g,f,j){var i=g("./$.iobject"),h=g("./$.defined");f.exports=function(b){return i(h(b))}},{"./$.defined":96,"./$.iobject":109}],139:[function(g,f,j){var i=g("./$.to-integer"),h=Math.min;f.exports=function(b){return b>0?h(i(b),9007199254740991):0}},{"./$.to-integer":137}],140:[function(f,e,h){var g=f("./$.defined");e.exports=function(b){return Object(g(b))}},{"./$.defined":96}],141:[function(g,f,j){var i=0,h=Math.random();f.exports=function(b){return"Symbol(".concat(void 0===b?"":b,")_",(++i+h).toString(36))}},{}],142:[function(h,g,l){var k=h("./$.shared")("wks"),j=h("./$.uid"),i=h("./$.global").Symbol;g.exports=function(b){return k[b]||(k[b]=i&&i[b]||(i||j)("Symbol."+b))}},{"./$.global":104,"./$.shared":132,"./$.uid":141}],143:[function(h,g,l){var k=h("./$.classof"),j=h("./$.wks")("iterator"),i=h("./$.iterators");g.exports=h("./$.core").getIteratorMethod=function(b){return void 0!=b?b[j]||b["@@iterator"]||i[k(b)]:void 0}},{"./$.classof":89,"./$.core":94,"./$.iterators":118,"./$.wks":142}],144:[function(g,f,j){var i=g("./$.an-object"),h=g("./core.get-iterator-method");f.exports=g("./$.core").getIterator=function(d){var c=h(d);if("function"!=typeof c){throw TypeError(d+" is not iterable!")}return i(c.call(d))}},{"./$.an-object":88,"./$.core":94,"./core.get-iterator-method":143}],145:[function(h,g,l){var k=h("./$.classof"),j=h("./$.wks")("iterator"),i=h("./$.iterators");g.exports=h("./$.core").isIterable=function(d){var c=Object(d);return void 0!==c[j]||"@@iterator" in c||i.hasOwnProperty(k(c))}},{"./$.classof":89,"./$.core":94,"./$.iterators":118,"./$.wks":142}],146:[function(t,s,r){var q=t("./$.ctx"),p=t("./$.export"),o=t("./$.to-object"),n=t("./$.iter-call"),m=t("./$.is-array-iter"),l=t("./$.to-length"),k=t("./core.get-iterator-method");p(p.S+p.F*!t("./$.iter-detect")(function(b){Array.from(b)}),"Array",{from:function(z){var y,x,w,v,u=o(z),j="function"==typeof this?this:Array,i=arguments,h=i.length,g=h>1?i[1]:void 0,f=void 0!==g,d=0,A=k(u);if(f&&(g=q(g,h>2?i[2]:void 0,2)),void 0==A||j==Array&&m(A)){for(y=l(u.length),x=new j(y);y>d;d++){x[d]=f?g(u[d],d):u[d]}}else{for(v=A.call(u),x=new j;!(w=v.next()).done;d++){x[d]=f?n(v,g,[w.value,d],!0):w.value}}return x.length=d,x}})},{"./$.ctx":95,"./$.export":100,"./$.is-array-iter":110,"./$.iter-call":113,"./$.iter-detect":116,"./$.to-length":139,"./$.to-object":140,"./core.get-iterator-method":143}],147:[function(i,h,n){var m=i("./$.add-to-unscopables"),l=i("./$.iter-step"),k=i("./$.iterators"),j=i("./$.to-iobject");h.exports=i("./$.iter-define")(Array,"Array",function(d,c){this._t=j(d),this._i=0,this._k=c},function(){var e=this._t,d=this._k,f=this._i++;return !e||f>=e.length?(this._t=void 0,l(1)):"keys"==d?l(0,f):"values"==d?l(0,e[f]):l(0,[f,e[f]])},"values"),k.Arguments=k.Array,m("keys"),m("values"),m("entries")},{"./$.add-to-unscopables":87,"./$.iter-define":115,"./$.iter-step":117,"./$.iterators":118,"./$.to-iobject":138}],148:[function(f,e,h){var g=f("./$.collection-strong");f("./$.collection")("Map",function(b){return function(){return b(this,arguments.length>0?arguments[0]:void 0)}},{get:function(d){var c=g.getEntry(this,d);return c&&c.v},set:function(d,c){return g.def(this,0===d?0:d,c)}},g,!0)},{"./$.collection":93,"./$.collection-strong":91}],149:[function(f,e,h){var g=f("./$.export");g(g.S+g.F,"Object",{assign:f("./$.object-assign")})},{"./$.export":100,"./$.object-assign":123}],150:[function(f,e,h){var g=f("./$.is-object");f("./$.object-sap")("freeze",function(b){return function(c){return b&&g(c)?b(c):c}})},{"./$.is-object":112,"./$.object-sap":124}],151:[function(f,e,h){var g=f("./$.to-iobject");f("./$.object-sap")("getOwnPropertyDescriptor",function(b){return function(d,i){return b(g(d),i)}})},{"./$.object-sap":124,"./$.to-iobject":138}],152:[function(e,d,f){e("./$.object-sap")("getOwnPropertyNames",function(){return e("./$.get-names").get})},{"./$.get-names":103,"./$.object-sap":124}],153:[function(f,e,h){var g=f("./$.to-object");f("./$.object-sap")("keys",function(b){return function(c){return b(g(c))}})},{"./$.object-sap":124,"./$.to-object":140}],154:[function(f,e,h){var g=f("./$.is-object");f("./$.object-sap")("seal",function(b){return function(c){return b&&g(c)?b(c):c}})},{"./$.is-object":112,"./$.object-sap":124}],155:[function(f,e,h){var g=f("./$.export");g(g.S,"Object",{setPrototypeOf:f("./$.set-proto").set})},{"./$.export":100,"./$.set-proto":129}],156:[function(e,d,f){},{}],157:[function(ar,aq,ap){var ao,an=ar("./$"),am=ar("./$.library"),al=ar("./$.global"),ak=ar("./$.ctx"),aj=ar("./$.classof"),ai=ar("./$.export"),ah=ar("./$.is-object"),ag=ar("./$.an-object"),af=ar("./$.a-function"),ae=ar("./$.strict-new"),ad=ar("./$.for-of"),ac=ar("./$.set-proto").set,aa=ar("./$.same-value"),Y=ar("./$.wks")("species"),W=ar("./$.species-constructor"),U=ar("./$.microtask"),S="Promise",Q=al.process,O="process"==aj(Q),M=al[S],K=function(d){var c=new M(function(){});return d&&(c.constructor=Object),M.resolve(c)===c},J=function(){function e(b){var d=new M(b);return ac(d,e.prototype),d}var i=!1;try{if(i=M&&M.resolve&&K(),ac(e,M),e.prototype=an.create(M.prototype,{constructor:{value:e}}),e.resolve(5).then(function(){}) instanceof e||(i=!1),i&&ar("./$.descriptors")){var h=!1;M.resolve(an.setDesc({},"then",{get:function(){h=!0}})),i=h}}catch(g){i=!1}return i}(),ab=function(d,c){return am&&d===M&&c===ao?!0:aa(d,c)},Z=function(d){var c=ag(d)[Y];return void 0!=c?c:d},X=function(d){var c;return ah(d)&&"function"==typeof(c=d.then)?c:!1},V=function(e){var d,f;this.promise=new e(function(b,c){if(void 0!==d||void 0!==f){throw TypeError("Bad Promise constructor")}d=b,f=c}),this.resolve=af(d),this.reject=af(f)},T=function(d){try{d()}catch(c){return{error:c}}},R=function(e,d){if(!e.n){e.n=!0;var f=e.c;U(function(){for(var i=e.v,g=1==e.s,c=0,b=function(k){var q,p,o=g?k.ok:k.fail,n=k.resolve,m=k.reject;try{o?(g||(e.h=!0),q=o===!0?i:o(i),q===k.promise?m(TypeError("Promise-chain cycle")):(p=X(q))?p.call(q,n,m):n(q)):m(i)}catch(l){m(l)}};f.length>c;){b(f[c++])}f.length=0,e.n=!1,d&&setTimeout(function(){var h,k,j=e.p;P(j)&&(O?Q.emit("unhandledRejection",i,j):(h=al.onunhandledrejection)?h({promise:j,reason:i}):(k=al.console)&&k.error&&k.error("Unhandled promise rejection",i)),e.a=void 0},1)})}},P=function(g){var f,j=g._d,i=j.a||j.c,h=0;if(j.h){return !1}for(;i.length>h;){if(f=i[h++],f.fail||!P(f.promise)){return !1}}return !0},N=function(d){var c=this;c.d||(c.d=!0,c=c.r||c,c.v=d,c.s=2,c.a=c.c.slice(),R(c,!0))},L=function(f){var e,h=this;if(!h.d){h.d=!0,h=h.r||h;try{if(h.p===f){throw TypeError("Promise can't be resolved itself")}(e=X(f))?U(function(){var c={r:h,d:!1};try{e.call(f,ak(L,c,1),ak(N,c,1))}catch(b){N.call(c,b)}}):(h.v=f,h.s=1,R(h,!1))}catch(g){N.call({r:h,d:!1},g)}}};J||(M=function(e){af(e);var d=this._d={p:ae(this,M,S),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{e(ak(L,d,1),ak(N,d,1))}catch(f){N.call(d,f)}},ar("./$.redefine-all")(M.prototype,{then:function(g,f){var j=new V(W(this,M)),i=j.promise,h=this._d;return j.ok="function"==typeof g?g:!0,j.fail="function"==typeof f&&f,h.c.push(j),h.a&&h.a.push(j),h.s&&R(h,!1),i},"catch":function(b){return this.then(void 0,b)}})),ai(ai.G+ai.W+ai.F*!J,{Promise:M}),ar("./$.set-to-string-tag")(M,S),ar("./$.set-species")(S),ao=ar("./$.core")[S],ai(ai.S+ai.F*!J,S,{reject:function(e){var d=new V(this),f=d.reject;return f(e),d.promise}}),ai(ai.S+ai.F*(!J||K(!0)),S,{resolve:function(e){if(e instanceof M&&ab(e.constructor,this)){return e}var d=new V(this),f=d.resolve;return f(e),d.promise}}),ai(ai.S+ai.F*!(J&&ar("./$.iter-detect")(function(b){M.all(b)["catch"](function(){})})),S,{all:function(i){var e=Z(this),n=new V(e),m=n.resolve,l=n.reject,k=[],j=T(function(){ad(i,!1,k.push,k);var d=k.length,b=Array(d);d?an.each.call(k,function(c,h){var f=!1;e.resolve(c).then(function(g){f||(f=!0,b[h]=g,--d||m(b))},l)}):m(b)});return j&&l(j.error),n.promise},race:function(g){var f=Z(this),j=new V(f),i=j.reject,h=T(function(){ad(g,!1,function(b){f.resolve(b).then(j.resolve,i)})});return h&&i(h.error),j.promise}})},{"./$":119,"./$.a-function":86,"./$.an-object":88,"./$.classof":89,"./$.core":94,"./$.ctx":95,"./$.descriptors":97,"./$.export":100,"./$.for-of":102,"./$.global":104,"./$.is-object":112,"./$.iter-detect":116,"./$.library":121,"./$.microtask":122,"./$.redefine-all":126,"./$.same-value":128,"./$.set-proto":129,"./$.set-species":130,"./$.set-to-string-tag":131,"./$.species-constructor":133,"./$.strict-new":134,"./$.wks":142}],158:[function(f,e,h){var g=f("./$.string-at")(!0);f("./$.iter-define")(String,"String",function(b){this._t=String(b),this._i=0},function(){var i,d=this._t,j=this._i;return j>=d.length?{value:void 0,done:!0}:(i=g(d,j),this._i+=i.length,{value:i,done:!1})})},{"./$.iter-define":115,"./$.string-at":135}],159:[function(aS,aR,aQ){var aP=aS("./$"),aO=aS("./$.global"),aN=aS("./$.has"),aM=aS("./$.descriptors"),aL=aS("./$.export"),aK=aS("./$.redefine"),aJ=aS("./$.fails"),aI=aS("./$.shared"),aH=aS("./$.set-to-string-tag"),aG=aS("./$.uid"),aF=aS("./$.wks"),aE=aS("./$.keyof"),aD=aS("./$.get-names"),aC=aS("./$.enum-keys"),aB=aS("./$.is-array"),aA=aS("./$.an-object"),az=aS("./$.to-iobject"),ay=aS("./$.property-desc"),ax=aP.getDesc,aw=aP.setDesc,av=aP.create,au=aD.get,at=aO.Symbol,ar=aO.JSON,aq=ar&&ar.stringify,ap=!1,ao=aF("_hidden"),an=aP.isEnum,am=aI("symbol-registry"),al=aI("symbols"),ak="function"==typeof at,aj=Object.prototype,ai=aM&&aJ(function(){return 7!=av(aw({},"a",{get:function(){return aw(this,"a",{value:7}).a}})).a})?function(f,e,h){var g=ax(aj,e);g&&delete aj[e],aw(f,e,h),g&&f!==aj&&aw(aj,e,g)}:aw,ah=function(d){var c=al[d]=av(at.prototype);return c._k=d,aM&&ap&&ai(aj,d,{configurable:!0,set:function(e){aN(this,ao)&&aN(this[ao],d)&&(this[ao][d]=!1),ai(this,d,ay(1,e))}}),c},ag=function(b){return"symbol"==typeof b},af=function(e,d,f){return f&&aN(al,d)?(f.enumerable?(aN(e,ao)&&e[ao][d]&&(e[ao][d]=!1),f=av(f,{enumerable:ay(0,!1)})):(aN(e,ao)||aw(e,ao,ay(1,{})),e[ao][d]=!0),ai(e,d,f)):aw(e,d,f)},ae=function(h,g){aA(h);for(var l,k=aC(g=az(g)),j=0,i=k.length;i>j;){af(h,l=k[j++],g[l])}return h},ad=function(d,c){return void 0===c?av(d):ae(av(d),c)},ac=function(d){var c=an.call(this,d);return c||!aN(this,d)||!aN(al,d)||aN(this,ao)&&this[ao][d]?c:!0},ab=function(e,d){var f=ax(e=az(e),d);return !f||!aN(al,d)||aN(e,ao)&&e[ao][d]||(f.enumerable=!0),f},aa=function(g){for(var f,j=au(az(g)),i=[],h=0;j.length>h;){aN(al,f=j[h++])||f==ao||i.push(f)}return i},Z=function(g){for(var f,j=au(az(g)),i=[],h=0;j.length>h;){aN(al,f=j[h++])&&i.push(al[f])}return i},Y=function(h){if(void 0!==h&&!ag(h)){for(var g,l,k=[h],j=1,i=arguments;i.length>j;){k.push(i[j++])}return g=k[1],"function"==typeof g&&(l=g),(l||!aB(g))&&(g=function(d,c){return l&&(c=l.call(this,d,c)),ag(c)?void 0:c}),k[1]=g,aq.apply(ar,k)}},X=aJ(function(){var b=at();return"[null]"!=aq([b])||"{}"!=aq({a:b})||"{}"!=aq(Object(b))});ak||(at=function(){if(ag(this)){throw TypeError("Symbol is not a constructor")}return ah(aG(arguments.length>0?arguments[0]:void 0))},aK(at.prototype,"toString",function(){return this._k}),ag=function(b){return b instanceof at},aP.create=ad,aP.isEnum=ac,aP.getDesc=ab,aP.setDesc=af,aP.setDescs=ae,aP.getNames=aD.get=aa,aP.getSymbols=Z,aM&&!aS("./$.library")&&aK(aj,"propertyIsEnumerable",ac,!0));var W={"for":function(b){return aN(am,b+="")?am[b]:am[b]=at(b)},keyFor:function(b){return aE(am,b)},useSetter:function(){ap=!0},useSimple:function(){ap=!1}};aP.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(d){var c=aF(d);W[d]=ak?c:ah(c)}),ap=!0,aL(aL.G+aL.W,{Symbol:at}),aL(aL.S,"Symbol",W),aL(aL.S+aL.F*!ak,"Object",{create:ad,defineProperty:af,defineProperties:ae,getOwnPropertyDescriptor:ab,getOwnPropertyNames:aa,getOwnPropertySymbols:Z}),ar&&aL(aL.S+aL.F*(!ak||X),"JSON",{stringify:Y}),aH(at,"Symbol"),aH(Math,"Math",!0),aH(aO.JSON,"JSON",!0)},{"./$":119,"./$.an-object":88,"./$.descriptors":97,"./$.enum-keys":99,"./$.export":100,"./$.fails":101,"./$.get-names":103,"./$.global":104,"./$.has":105,"./$.is-array":111,"./$.keyof":120,"./$.library":121,"./$.property-desc":125,"./$.redefine":127,"./$.set-to-string-tag":131,"./$.shared":132,"./$.to-iobject":138,"./$.uid":141,"./$.wks":142}],160:[function(f,e,h){var g=f("./$.export");g(g.P,"Map",{toJSON:f("./$.collection-to-json")("Map")})},{"./$.collection-to-json":92,"./$.export":100}],161:[function(f,e,h){f("./es6.array.iterator");var g=f("./$.iterators");g.NodeList=g.HTMLCollection=g.Array},{"./$.iterators":118,"./es6.array.iterator":147}],162:[function(g,f,j){function i(e,d,k){this.fn=e,this.context=d,this.once=k||!1}function h(){}h.prototype._events=void 0,h.prototype.listeners=function(k){if(!this._events||!this._events[k]){return[]}if(this._events[k].fn){return[this._events[k].fn]}for(var e=0,m=this._events[k].length,l=new Array(m);m>e;e++){l[e]=this._events[k][e].fn}return l},h.prototype.emit=function(x,w,v,u,t,s){if(!this._events||!this._events[x]){return !1}var r,q,p=this._events[x],o=arguments.length;if("function"==typeof p.fn){switch(p.once&&this.removeListener(x,p.fn,!0),o){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,w),!0;case 3:return p.fn.call(p.context,w,v),!0;case 4:return p.fn.call(p.context,w,v,u),!0;case 5:return p.fn.call(p.context,w,v,u,t),!0;case 6:return p.fn.call(p.context,w,v,u,t,s),!0}for(q=1,r=new Array(o-1);o>q;q++){r[q-1]=arguments[q]}p.fn.apply(p.context,r)}else{var n,m=p.length;for(q=0;m>q;q++){switch(p[q].once&&this.removeListener(x,p[q].fn,!0),o){case 1:p[q].fn.call(p[q].context);break;case 2:p[q].fn.call(p[q].context,w);break;case 3:p[q].fn.call(p[q].context,w,v);break;default:if(!r){for(n=1,r=new Array(o-1);o>n;n++){r[n-1]=arguments[n]}}p[q].fn.apply(p[q].context,r)}}}return !0},h.prototype.on=function(k,d,m){var l=new i(d,m||this);return this._events||(this._events={}),this._events[k]?this._events[k].fn?this._events[k]=[this._events[k],l]:this._events[k].push(l):this._events[k]=l,this},h.prototype.once=function(k,d,m){var l=new i(d,m||this,!0);return this._events||(this._events={}),this._events[k]?this._events[k].fn?this._events[k]=[this._events[k],l]:this._events[k].push(l):this._events[k]=l,this},h.prototype.removeListener=function(l,k,q){if(!this._events||!this._events[l]){return this}var p=this._events[l],o=[];if(k&&(p.fn&&(p.fn!==k||q&&!p.once)&&o.push(p),!p.fn)){for(var n=0,m=p.length;m>n;n++){(p[n].fn!==k||q&&!p[n].once)&&o.push(p[n])}}return o.length?this._events[l]=1===o.length?o[0]:o:delete this._events[l],this},h.prototype.removeAllListeners=function(b){return this._events?(b?delete this._events[b]:this._events={},this):this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prototype.setMaxListeners=function(){return this},h.EventEmitter=h,h.EventEmitter2=h,h.EventEmitter3=h,f.exports=h},{}],163:[function(e,d,f){d.exports=function(){return this}()},{}],164:[function(j,i,p){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(b){return"function"==typeof b}function m(b){return"number"==typeof b}function l(b){return"object"==typeof b&&null!==b}function k(b){return void 0===b}i.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(b){if(!m(b)||0>b||isNaN(b)){throw TypeError("n must be a positive number")}return this._maxListeners=b,this},o.prototype.emit=function(g){var e,t,s,r,q,h;if(this._events||(this._events={}),"error"===g&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error){throw e}throw TypeError('Uncaught, unspecified "error" event.')}if(t=this._events[g],k(t)){return !1}if(n(t)){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,r=new Array(s-1),q=1;s>q;q++){r[q-1]=arguments[q]}t.apply(this,r)}}else{if(l(t)){for(s=arguments.length,r=new Array(s-1),q=1;s>q;q++){r[q-1]=arguments[q]}for(h=t.slice(),s=h.length,q=0;s>q;q++){h[q].apply(this,r)}}}return !0},o.prototype.addListener=function(e,d){var f;if(!n(d)){throw TypeError("listener must be a function")}if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(d.listener)?d.listener:d),this._events[e]?l(this._events[e])?this._events[e].push(d):this._events[e]=[this._events[e],d]:this._events[e]=d,l(this._events[e])&&!this._events[e].warned){var f;f=k(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,f&&f>0&&this._events[e].length>f&&(this._events[e].warned=!0,"function"==typeof console.trace)}return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(f,e){function h(){this.removeListener(f,h),g||(g=!0,e.apply(this,arguments))}if(!n(e)){throw TypeError("listener must be a function")}var g=!1;return h.listener=e,this.on(f,h),this},o.prototype.removeListener=function(g,e){var t,s,r,q;if(!n(e)){throw TypeError("listener must be a function")}if(!this._events||!this._events[g]){return this}if(t=this._events[g],r=t.length,s=-1,t===e||n(t.listener)&&t.listener===e){delete this._events[g],this._events.removeListener&&this.emit("removeListener",g,e)}else{if(l(t)){for(q=r;q-->0;){if(t[q]===e||t[q].listener&&t[q].listener===e){s=q;break}}if(0>s){return this}1===t.length?(t.length=0,delete this._events[g]):t.splice(s,1),this._events.removeListener&&this.emit("removeListener",g,e)}}return this},o.prototype.removeAllListeners=function(e){var d,f;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this}if(0===arguments.length){for(d in this._events){"removeListener"!==d&&this.removeAllListeners(d)}return this.removeAllListeners("removeListener"),this._events={},this}if(f=this._events[e],n(f)){this.removeListener(e,f)}else{for(;f.length;){this.removeListener(e,f[f.length-1])}}return delete this._events[e],this},o.prototype.listeners=function(d){var c;return c=this._events&&this._events[d]?n(this._events[d])?[this._events[d]]:this._events[d].slice():[]},o.listenerCount=function(e,d){var f;return f=e._events&&e._events[d]?n(e._events[d])?1:e._events[d].length:0}},{}],165:[function(x,w,v){function u(){n=!1,q.length?o=q.concat(o):m=-1,o.length&&t()}function t(){if(!n){var d=setTimeout(u);n=!0;for(var c=o.length;c;){for(q=o,o=[];++m<c;){q&&q[m].run()}m=-1,c=o.length}q=null,n=!1,clearTimeout(d)}}function s(d,c){this.fun=d,this.array=c}function r(){}var q,p=w.exports={},o=[],n=!1,m=-1;p.nextTick=function(e){var d=new Array(arguments.length-1);if(arguments.length>1){for(var f=1;f<arguments.length;f++){d[f-1]=arguments[f]}}o.push(new s(e,d)),1!==o.length||n||setTimeout(t,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=r,p.addListener=r,p.once=r,p.off=r,p.removeListener=r,p.removeAllListeners=r,p.emit=r,p.binding=function(b){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(b){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],166:[function(H,G,F){function E(b){return b&&b.__esModule?b:{"default":b}}function D(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function C(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function B(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(F,"__esModule",{value:!0});var A=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),z=H("../events"),y=E(z),x=H("../event-handler"),w=E(x),v=H("../helper/buffer-helper"),u=E(v),t=H("../errors"),s=H("../utils/logger"),r=function(d){function c(b){D(this,c);var e=C(this,Object.getPrototypeOf(c).call(this,b,y["default"].FRAG_LOADING,y["default"].FRAG_LOAD_PROGRESS,y["default"].FRAG_LOADED,y["default"].ERROR));return e.lastLoadedFragLevel=0,e._autoLevelCapping=-1,e._nextAutoLevel=-1,e.hls=b,e.onCheck=e.abandonRulesCheck.bind(e),e}return B(c,d),A(c,[{key:"destroy",value:function(){this.clearTimer(),w["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(b){this.timer||(this.timer=setInterval(this.onCheck,100)),this.fragCurrent=b.frag}},{key:"onFragLoadProgress",value:function(f){var e=f.stats;void 0===e.aborted&&1===f.frag.loadCounter&&(this.lastfetchduration=(performance.now()-e.trequest)/1000,this.lastbw=8*e.loaded/this.lastfetchduration)}},{key:"abandonRulesCheck",value:function(){var K=this.hls,J=K.media,I=this.fragCurrent;if(!I.loader||I.loader.stats&&I.loader.stats.aborted){return s.logger.warn("frag loader destroy or aborted, disarm abandonRulesCheck"),void this.clearTimer()}if(J&&(!J.paused||!J.readyState)&&I.autoLevel&&I.level){var q=performance.now()-I.trequest;if(q>500*I.duration){var p=Math.max(1,1000*I.loaded/q);I.expectedLen<I.loaded&&(I.expectedLen=I.loaded);var o=J.currentTime,n=(I.expectedLen-I.loaded)/p,m=u["default"].bufferInfo(J,o,K.config.maxBufferHole).end-o;if(m<2*I.duration&&n>m){var l=void 0,j=void 0;for(j=I.level-1;j>=0&&(l=I.duration*K.levels[j].bitrate/(6.4*p),s.logger.log("fragLoadedDelay/bufferStarvationDelay/fragLevelNextLoadedDelay["+j+"] :"+n.toFixed(1)+"/"+m.toFixed(1)+"/"+l.toFixed(1)),!(m>l));j--){}n>l&&(j=Math.max(0,j),K.nextLoadLevel=j,s.logger.warn("loading too slow, abort fragment loading and switch to level "+j),I.loader.abort(),this.clearTimer(),K.trigger(y["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:I}))}}}}},{key:"onFragLoaded",value:function(b){this.clearTimer(),this.lastLoadedFragLevel=b.frag.level,this._nextAutoLevel=-1}},{key:"onError",value:function(b){switch(b.details){case t.ErrorDetails.FRAG_LOAD_ERROR:case t.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(b){this._autoLevelCapping=b}},{key:"nextAutoLevel",get:function(){var g,f,j,i=this.lastbw,h=this.hls;if(j=-1===this._autoLevelCapping&&h.levels&&h.levels.length?h.levels.length-1:this._autoLevelCapping,-1!==this._nextAutoLevel){return Math.min(this._nextAutoLevel,j)}for(f=0;j>=f;f++){if(g=f<=this.lastLoadedFragLevel?0.8*i:0.7*i,g<h.levels[f].bitrate){return Math.max(0,f-1)}}return f-1},set:function(b){this._nextAutoLevel=b}}]),c}(w["default"]);F["default"]=r},{"../errors":183,"../event-handler":184,"../events":185,"../helper/buffer-helper":186,"../utils/logger":199}],167:[function(D,C,B){function A(b){return b&&b.__esModule?b:{"default":b}}function z(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function y(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function x(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(B,"__esModule",{value:!0});var w=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),v=D("../events"),u=A(v),t=D("../event-handler"),s=A(t),r=D("../utils/logger"),q=D("../errors"),p=function(d){function c(b){z(this,c);var e=y(this,Object.getPrototypeOf(c).call(this,b,u["default"].MEDIA_ATTACHING,u["default"].MEDIA_DETACHING,u["default"].BUFFER_RESET,u["default"].BUFFER_APPENDING,u["default"].BUFFER_CODECS,u["default"].BUFFER_EOS,u["default"].BUFFER_FLUSHING));return e.onsbue=e.onSBUpdateEnd.bind(e),e.onsbe=e.onSBUpdateError.bind(e),e}return x(c,d),w(c,[{key:"destroy",value:function(){s["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(f){var e=this.media=f.media,g=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),g.addEventListener("sourceopen",this.onmso),g.addEventListener("sourceended",this.onmse),g.addEventListener("sourceclose",this.onmsc),e.src=URL.createObjectURL(g)}},{key:"onMediaDetaching",value:function(){var f=this.mediaSource;if(f){if("open"===f.readyState){try{f.endOfStream()}catch(e){r.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}}f.removeEventListener("sourceopen",this.onmso),f.removeEventListener("sourceended",this.onmse),f.removeEventListener("sourceclose",this.onmsc),this.media.src="",this.media.removeAttribute("src"),this.mediaSource=null,this.media=null,this.pendingTracks=null,this.sourceBuffer=null}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(u["default"].MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){r.logger.log("media source opened"),this.hls.trigger(u["default"].MEDIA_ATTACHED,{media:this.media}),this.mediaSource.removeEventListener("sourceopen",this.onmso);var b=this.pendingTracks;b&&(this.onBufferCodecs(b),this.pendingTracks=null,this.doAppending())}},{key:"onMediaSourceClose",value:function(){r.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){r.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){this._needsFlush&&this.doFlush(),this._needsEos&&this.onBufferEos(),this.hls.trigger(u["default"].BUFFER_APPENDED),this.doAppending()}},{key:"onSBUpdateError",value:function(b){r.logger.error("sourceBuffer error:"+b),this.hls.trigger(u["default"].ERROR,{type:q.ErrorTypes.MEDIA_ERROR,details:q.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var f=this.sourceBuffer;if(f){for(var e in f){var h=f[e];try{this.mediaSource.removeSourceBuffer(h),h.removeEventListener("updateend",this.onsbue),h.removeEventListener("error",this.onsbe)}catch(g){}}this.sourceBuffer=null}this.flushRange=[],this.appended=0}},{key:"onBufferCodecs",value:function(j){var i,E,o,n,m;if(!this.media){return void (this.pendingTracks=j)}if(!this.sourceBuffer){var l={},k=this.mediaSource;for(E in j){o=j[E],n=o.levelCodec||o.codec,m=o.container+";codecs="+n,r.logger.log("creating sourceBuffer with mimeType:"+m),i=l[E]=k.addSourceBuffer(m),i.addEventListener("updateend",this.onsbue),i.addEventListener("error",this.onsbe)}this.sourceBuffer=l}}},{key:"onBufferAppending",value:function(b){this.segments?this.segments.push(b):this.segments=[b],this.doAppending()}},{key:"onBufferAppendFail",value:function(b){r.logger.error("sourceBuffer error:"+b.event),this.hls.trigger(u["default"].ERROR,{type:q.ErrorTypes.MEDIA_ERROR,details:q.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(){var f=this.sourceBuffer,e=this.mediaSource;e&&"open"===e.readyState&&(f.audio&&f.audio.updating||f.video&&f.video.updating?this._needsEos=!0:(r.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment"),e.endOfStream(),this._needsEos=!1))}},{key:"onBufferFlushing",value:function(b){this.flushRange.push({start:b.startOffset,end:b.endOffset}),this.flushBufferCounter=0,this.doFlush()}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var f=this.flushRange[0];if(!this.flushBuffer(f.start,f.end)){return void (this._needsFlush=!0)}this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,h=this.sourceBuffer;if(h){for(var g in h){e+=h[g].buffered.length}}this.appended=e,this.hls.trigger(u["default"].BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var i=this.hls,h=this.sourceBuffer,n=this.segments;if(h){if(this.media.error){return n=[],void r.logger.error("trying to append although a media error occured, flush segment and abort")}for(var m in h){if(h[m].updating){return}}if(n.length){var l=n.shift();try{h[l.type].appendBuffer(l.data),this.appendError=0,this.appended++}catch(k){r.logger.error("error while trying to append buffer:"+k.message),n.unshift(l);var j={type:q.ErrorTypes.MEDIA_ERROR};if(22!==k.code){if(this.appendError?this.appendError++:this.appendError=1,j.details=q.ErrorDetails.BUFFER_APPEND_ERROR,j.frag=this.fragCurrent,this.appendError>i.config.appendErrorMaxRetry){return r.logger.log("fail "+i.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),n=[],j.fatal=!0,void i.trigger(u["default"].ERROR,j)}j.fatal=!1,i.trigger(u["default"].ERROR,j)}else{n=[],j.details=q.ErrorDetails.BUFFER_FULL_ERROR,i.trigger(u["default"].ERROR,j)}}}}}},{key:"flushBuffer",value:function(G,F){var E,o,n,m,l,k;if(this.flushBufferCounter<this.appended&&this.sourceBuffer){for(var j in this.sourceBuffer){if(E=this.sourceBuffer[j],E.updating){return r.logger.warn("cannot flush, sb updating in progress"),!1}for(o=0;o<E.buffered.length;o++){if(n=E.buffered.start(o),m=E.buffered.end(o),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&F===Number.POSITIVE_INFINITY?(l=G,k=F):(l=Math.max(n,G),k=Math.min(m,F)),Math.min(k,m)-l>0.5){return this.flushBufferCounter++,r.logger.log("flush "+j+" ["+l+","+k+"], of ["+n+","+m+"], pos:"+this.media.currentTime),E.remove(l,k),!1}}}}else{r.logger.warn("abort flushing too many retries")}return r.logger.log("buffer flushed"),!0}}]),c}(s["default"]);B["default"]=p},{"../errors":183,"../event-handler":184,"../events":185,"../utils/logger":199}],168:[function(z,y,x){function w(b){return b&&b.__esModule?b:{"default":b}}function v(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function u(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function t(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(x,"__esModule",{value:!0});var s=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),r=z("../events"),q=w(r),p=z("../event-handler"),o=w(p),n=function(d){function c(b){return v(this,c),u(this,Object.getPrototypeOf(c).call(this,b,q["default"].MEDIA_ATTACHING,q["default"].MANIFEST_PARSED))}return t(c,d),s(c,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onMediaAttaching",value:function(b){this.media=b.media instanceof HTMLVideoElement?b.media:null}},{key:"onManifestParsed",value:function(b){this.hls.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=b.levels,this.hls.firstLevel=this.getMaxLevel(b.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1000),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var b=this.levels?this.levels.length:0;b&&(this.hls.autoLevelCapping=this.getMaxLevel(b-1),this.hls.autoLevelCapping>this.autoLevelCapping&&this.hls.streamController.nextLevelSwitch(),this.autoLevelCapping=this.hls.autoLevelCapping)}}},{key:"getMaxLevel",value:function(j){var i=void 0,C=void 0,B=void 0,A=this.mediaWidth,m=this.mediaHeight,l=0,k=0;for(C=0;j>=C&&(B=this.levels[C],i=C,l=B.width,k=B.height,!(l>=A||k>=m));C++){}return i}},{key:"contentScaleFactor",get:function(){var f=1;try{f=window.devicePixelRatio}catch(e){}return f}},{key:"mediaWidth",get:function(){var b=void 0;return this.media&&(b=this.media.width||this.media.clientWidth||this.media.offsetWidth,b*=this.contentScaleFactor),b}},{key:"mediaHeight",get:function(){var b=void 0;return this.media&&(b=this.media.height||this.media.clientHeight||this.media.offsetHeight,b*=this.contentScaleFactor),b}}]),c}(o["default"]);x["default"]=n},{"../event-handler":184,"../events":185}],169:[function(D,C,B){function A(b){return b&&b.__esModule?b:{"default":b}}function z(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function y(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function x(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(B,"__esModule",{value:!0});var w=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),v=D("../events"),u=A(v),t=D("../event-handler"),s=A(t),r=D("../utils/logger"),q=D("../errors"),p=function(d){function c(b){z(this,c);var e=y(this,Object.getPrototypeOf(c).call(this,b,u["default"].MANIFEST_LOADED,u["default"].LEVEL_LOADED,u["default"].ERROR));return e.ontick=e.tick.bind(e),e._manualLevel=e._autoLevelCapping=-1,e}return x(c,d),w(c,[{key:"destroy",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0,this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(G){var F,E,o=[],n=[],m={},l=!1,k=!1,j=this.hls;if(G.levels.forEach(function(f){f.videoCodec&&(l=!0),f.audioCodec&&(k=!0);var e=m[f.bitrate];void 0===e?(m[f.bitrate]=o.length,f.url=[f.url],f.urlId=0,o.push(f)):o[e].url.push(f.url)}),l&&k?o.forEach(function(b){b.videoCodec&&n.push(b)}):n=o,n=n.filter(function(g){var f=function(b){return MediaSource.isTypeSupported("audio/mp4;codecs="+b)},H=function(b){return MediaSource.isTypeSupported("video/mp4;codecs="+b)},i=g.audioCodec,h=g.videoCodec;return(!i||f(i))&&(!h||H(h))}),n.length){for(F=n[0].bitrate,n.sort(function(f,e){return f.bitrate-e.bitrate}),this._levels=n,E=0;E<n.length;E++){if(n[E].bitrate===F){this._firstLevel=E,r.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+F);break}}j.trigger(u["default"].MANIFEST_PARSED,{levels:this._levels,firstLevel:this._firstLevel,stats:G.stats})}else{j.trigger(u["default"].ERROR,{type:q.ErrorTypes.MEDIA_ERROR,details:q.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:j.url,reason:"no level with compatible codecs found in manifest"})}}},{key:"setLevelInternal",value:function(f){if(f>=0&&f<this._levels.length){this.timer&&(clearInterval(this.timer),this.timer=null),this._level=f,r.logger.log("switching to level "+f),this.hls.trigger(u["default"].LEVEL_SWITCH,{level:f});var e=this._levels[f];if(void 0===e.details||e.details.live===!0){r.logger.log("(re)loading playlist for level "+f);var g=e.urlId;this.hls.trigger(u["default"].LEVEL_LOADING,{url:e.url[g],level:f,id:g})}}else{this.hls.trigger(u["default"].ERROR,{type:q.ErrorTypes.OTHER_ERROR,details:q.ErrorDetails.LEVEL_SWITCH_ERROR,level:f,fatal:!1,reason:"invalid level idx"})}}},{key:"onError",value:function(h){if(!h.fatal){var g,l,k=h.details,j=this.hls;switch(k){case q.ErrorDetails.FRAG_LOAD_ERROR:case q.ErrorDetails.FRAG_LOAD_TIMEOUT:case q.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case q.ErrorDetails.KEY_LOAD_ERROR:case q.ErrorDetails.KEY_LOAD_TIMEOUT:g=h.frag.level;break;case q.ErrorDetails.LEVEL_LOAD_ERROR:case q.ErrorDetails.LEVEL_LOAD_TIMEOUT:g=h.level}if(void 0!==g){if(l=this._levels[g],l.urlId<l.url.length-1){l.urlId++,l.details=void 0,r.logger.warn("level controller,"+k+" for level "+g+": switching to redundant stream id "+l.urlId)}else{var i=-1===this._manualLevel&&g;i?(r.logger.warn("level controller,"+k+": emergency switch-down for next fragment"),j.abrController.nextAutoLevel=0):l&&l.details&&l.details.live?r.logger.warn("level controller,"+k+" on live stream, discard"):k!==q.ErrorDetails.FRAG_LOAD_ERROR&&k!==q.ErrorDetails.FRAG_LOAD_TIMEOUT&&(r.logger.error("cannot recover "+k+" error"),this._level=void 0,this.timer&&(clearInterval(this.timer),this.timer=null),h.fatal=!0,j.trigger(u["default"].ERROR,h))}}}}},{key:"onLevelLoaded",value:function(b){b.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1000*b.details.targetduration)),!b.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"tick",value:function(){var f=this._level;if(void 0!==f&&this.canload){var e=this._levels[f],g=e.urlId;this.hls.trigger(u["default"].LEVEL_LOADING,{url:e.url[g],level:f,id:g})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(b){this._levels&&this._levels.length>b&&(this._level!==b||void 0===this._levels[b].details)&&this.setLevelInternal(b)}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(b){this._manualLevel=b,-1!==b&&(this.level=b)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(b){this._firstLevel=b}},{key:"startLevel",get:function(){return void 0===this._startLevel?this._firstLevel:this._startLevel},set:function(b){this._startLevel=b}},{key:"nextLoadLevel",get:function(){return -1!==this._manualLevel?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(b){this.level=b,-1===this._manualLevel&&(this.hls.abrController.nextAutoLevel=b)}}]),c}(s["default"]);B["default"]=p},{"../errors":183,"../event-handler":184,"../events":185,"../utils/logger":199}],170:[function(V,U,T){function S(b){return b&&b.__esModule?b:{"default":b}}function R(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function Q(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function P(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(T,"__esModule",{value:!0});var O=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),N=V("../demux/demuxer"),M=S(N),L=V("../events"),K=S(L),J=V("../event-handler"),I=S(J),H=V("../utils/logger"),G=V("../utils/binary-search"),F=S(G),E=V("../helper/buffer-helper"),D=S(E),C=V("../helper/level-helper"),B=S(C),A=V("../errors"),z={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR"},y=function(d){function c(b){R(this,c);var e=Q(this,Object.getPrototypeOf(c).call(this,b,K["default"].MEDIA_ATTACHED,K["default"].MEDIA_DETACHING,K["default"].MANIFEST_LOADING,K["default"].MANIFEST_PARSED,K["default"].LEVEL_LOADED,K["default"].KEY_LOADED,K["default"].FRAG_LOADED,K["default"].FRAG_LOAD_EMERGENCY_ABORTED,K["default"].FRAG_PARSING_INIT_SEGMENT,K["default"].FRAG_PARSING_DATA,K["default"].FRAG_PARSED,K["default"].ERROR,K["default"].BUFFER_APPENDED,K["default"].BUFFER_FLUSHED));return e.config=b.config,e.audioCodecSwap=!1,e.ticks=0,e.ontick=e.tick.bind(e),e}return P(c,d),O(c,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),I["default"].prototype.destroy.call(this),this.state=z.STOPPED}},{key:"startLoad",value:function(){var f=arguments.length<=0||void 0===arguments[0]?0:arguments[0];if(this.levels){var e=this.media,g=this.lastCurrentTime;this.stopLoad(),this.demuxer=new M["default"](this.hls),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,e&&g?(H.logger.log("configure startPosition @"+g),this.lastPaused||(H.logger.log("resuming video"),e.play()),this.state=z.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:f,this.state=z.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else{H.logger.warn("cannot start loading as manifest not parsed yet"),this.state=z.STOPPED}}},{key:"stopLoad",value:function(){var b=this.fragCurrent;b&&(b.loader&&b.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=z.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var an,am,al,ak=this,aj=this.hls,ai=aj.config;switch(this.state){case z.ERROR:case z.PAUSED:break;case z.STARTING:this.startLevel=aj.startLevel,-1===this.startLevel&&(this.startLevel=0,this.fragBitrateTest=!0),this.level=aj.nextLoadLevel=this.startLevel,this.state=z.WAITING_LEVEL,this.loadedmetadata=!1;break;case z.IDLE:if(!this.media&&(this.startFragRequested||!ai.startFragPrefetch)){break}an=this.loadedmetadata?this.media.currentTime:this.nextLoadPosition,am=this.startFragRequested===!1?this.startLevel:aj.nextLoadLevel;var ah,ag=D["default"].bufferInfo(this.media,an,ai.maxBufferHole),af=ag.len,ae=ag.end,ad=this.fragPrevious;if(this.levels[am].hasOwnProperty("bitrate")?(ah=Math.max(8*ai.maxBufferSize/this.levels[am].bitrate,ai.maxBufferLength),ah=Math.min(ah,ai.maxMaxBufferLength)):ah=ai.maxBufferLength,ah>af){if(aj.nextLoadLevel=am,this.level=am,al=this.levels[am].details,"undefined"==typeof al||al.live&&this.levelLastLoaded!==am){this.state=z.WAITING_LEVEL;break}var ac=al.fragments,ab=ac.length,aa=ac[0].start,X=ac[ab-1].start+ac[ab-1].duration,v=void 0;if(al.live){var s=void 0!==ai.liveMaxLatencyDuration?ai.liveMaxLatencyDuration:ai.liveMaxLatencyDurationCount*al.targetduration;if(ae<Math.max(aa,X-s)){var q=void 0!==ai.liveSyncDuration?ai.liveSyncDuration:ai.liveSyncDurationCount*al.targetduration;this.seekAfterBuffered=aa+Math.max(0,al.totalduration-q),H.logger.log("buffer end: "+ae+" is located too far from the end of live sliding playlist, media position will be reseted to: "+this.seekAfterBuffered.toFixed(3)),ae=this.seekAfterBuffered}if(al.PTSKnown&&ae>X){break}if(this.startFragRequested&&!al.PTSKnown){if(ad){var o=ad.sn+1;o>=al.startSN&&o<=al.endSN&&(v=ac[o-al.startSN],H.logger.log("live playlist, switching playlist, load frag with next SN: "+v.sn))}v||(v=ac[Math.min(ab-1,Math.round(ab/2))],H.logger.log("live playlist, switching playlist, unknown, load middle frag : "+v.sn))}}else{aa>ae&&(v=ac[0])}if(v||!function(){var f=void 0,e=ai.maxFragLookUpTolerance;X>ae?(ae>X-e&&(e=0),f=F["default"].search(ac,function(b){return b.start+b.duration-e<=ae?1:b.start-e>ae?-1:0})):f=ac[ab-1],f&&(v=f,aa=f.start,ad&&v.level===ad.level&&v.sn===ad.sn&&(v.sn<al.endSN?(v=ac[v.sn+1-al.startSN],H.logger.log("SN just loaded, load next one: "+v.sn)):(al.live||(ak.hls.trigger(K["default"].BUFFER_EOS),ak.state=z.ENDED),v=null)))}(),v){if(null!=v.decryptdata.uri&&null==v.decryptdata.key){H.logger.log("Loading key for "+v.sn+" of ["+al.startSN+" ,"+al.endSN+"],level "+am),this.state=z.KEY_LOADING,aj.trigger(K["default"].KEY_LOADING,{frag:v})}else{if(H.logger.log("Loading "+v.sn+" of ["+al.startSN+" ,"+al.endSN+"],level "+am+", currentTime:"+an+",bufferEnd:"+ae.toFixed(3)),v.autoLevel=aj.autoLevelEnabled,this.levels.length>1&&(v.expectedLen=Math.round(v.duration*this.levels[am].bitrate/8),v.trequest=performance.now()),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,v.loadCounter){v.loadCounter++;var l=ai.fragLoadingLoopThreshold;if(v.loadCounter>l&&Math.abs(this.fragLoadIdx-v.loadIdx)<l){return void aj.trigger(K["default"].ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:v})}}else{v.loadCounter=1}v.loadIdx=this.fragLoadIdx,this.fragCurrent=v,this.startFragRequested=!0,aj.trigger(K["default"].FRAG_LOADING,{frag:v}),this.state=z.FRAG_LOADING}}}break;case z.WAITING_LEVEL:am=this.levels[this.level],am&&am.details&&(this.state=z.IDLE);break;case z.FRAG_LOADING_WAITING_RETRY:var Z=performance.now(),Y=this.retryDate,W=this.media,w=W&&W.seeking;(!Y||Z>=Y||w)&&(H.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=z.IDLE);break;case z.STOPPED:case z.FRAG_LOADING:case z.PARSING:case z.PARSED:case z.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"getBufferRange",value:function(f){var e,h,g=this.bufferRange;if(g){for(e=g.length-1;e>=0;e--){if(h=g[e],f>=h.start&&f<=h.end){return h}}}return null}},{key:"followingBufferRange",value:function(b){return b?this.getBufferRange(b.end+0.5):null}},{key:"isBuffered",value:function(f){for(var e=this.media,h=e.buffered,g=0;g<h.length;g++){if(f>=h.start(g)&&f<=h.end(g)){return !0}}return !1}},{key:"_checkFragmentChanged",value:function(){var f,e,h=this.media;if(h&&h.seeking===!1&&(e=h.currentTime,e>h.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=e),this.isBuffered(e)?f=this.getBufferRange(e):this.isBuffered(e+0.1)&&(f=this.getBufferRange(e+0.1)),f)){var g=f.frag;g!==this.fragPlaying&&(this.fragPlaying=g,this.hls.trigger(K["default"].FRAG_CHANGED,{frag:g}))}}},{key:"immediateLevelSwitch",value:function(){H.logger.log("immediateLevelSwitch"),this.immediateSwitch||(this.immediateSwitch=!0,this.previouslyPaused=this.media.paused,this.media.pause());var b=this.fragCurrent;b&&b.loader&&b.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=z.PAUSED,this.hls.trigger(K["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY})}},{key:"immediateLevelSwitchEnd",value:function(){this.immediateSwitch=!1,this.media.currentTime-=0.0001,this.previouslyPaused||this.media.play()}},{key:"nextLevelSwitch",value:function(){var i,h,n;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,h=this.getBufferRange(this.media.currentTime),h&&h.start>1&&(this.state=z.PAUSED,this.hls.trigger(K["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:h.start-1})),this.media.paused){i=0}else{var m=this.hls.nextLoadLevel,l=this.levels[m],k=this.fragLastKbps;i=k&&this.fragCurrent?this.fragCurrent.duration*l.bitrate/(1000*k)+1:0}if(n=this.getBufferRange(this.media.currentTime+i),n&&(n=this.followingBufferRange(n))){var j=this.fragCurrent;j&&j.loader&&j.loader.abort(),this.fragCurrent=null,this.state=z.PAUSED,this.hls.trigger(K["default"].BUFFER_FLUSHING,{startOffset:n.start,endOffset:Number.POSITIVE_INFINITY})}}},{key:"onMediaAttached",value:function(f){var e=this.media=f.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended),this.levels&&this.config.autoStartLoad&&this.hls.startLoad()}},{key:"onMediaDetaching",value:function(){var f=this.media;f&&f.ended&&(H.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach(function(b){b.details&&b.details.fragments.forEach(function(g){g.loadCounter=void 0})}),f&&(f.removeEventListener("seeking",this.onvseeking),f.removeEventListener("seeked",this.onvseeked),f.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){if(this.state===z.FRAG_LOADING){if(0===D["default"].bufferInfo(this.media,this.media.currentTime,this.config.maxBufferHole).len){H.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load");var b=this.fragCurrent;b&&(b.loader&&b.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.state=z.IDLE}}else{this.state===z.ENDED&&(this.state=z.IDLE)}this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaSeeked",value:function(){this.tick()}},{key:"onMediaEnded",value:function(){H.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){H.logger.log("trigger BUFFER_RESET"),this.hls.trigger(K["default"].BUFFER_RESET),this.bufferRange=[],this.stalled=!1}},{key:"onManifestParsed",value:function(f){var e,h=!1,g=!1;f.levels.forEach(function(b){e=b.audioCodec,e&&(-1!==e.indexOf("mp4a.40.2")&&(h=!0),-1!==e.indexOf("mp4a.40.5")&&(g=!0))}),this.audioCodecSwitch=h&&g,this.audioCodecSwitch&&H.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=f.levels,this.startLevelLoaded=!1,this.startFragRequested=!1,this.config.autoStartLoad&&this.hls.startLoad()}},{key:"onLevelLoaded",value:function(j){var i=j.details,p=j.level,o=this.levels[p],n=i.totalduration,m=0;if(H.logger.log("level "+p+" loaded ["+i.startSN+","+i.endSN+"],duration:"+n),this.levelLastLoaded=p,i.live){var l=o.details;l?(B["default"].mergeDetails(l,i),m=i.fragments[0].start,i.PTSKnown?H.logger.log("live playlist sliding:"+m.toFixed(3)):H.logger.log("live playlist - outdated PTS, unknown sliding")):(i.PTSKnown=!1,H.logger.log("live playlist - first load, unknown sliding"))}else{i.PTSKnown=!1}if(o.details=i,this.hls.trigger(K["default"].LEVEL_UPDATED,{details:i,level:p}),this.startFragRequested===!1){if(i.live){var k=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*i.targetduration;this.startPosition=Math.max(0,m+n-k)}this.nextLoadPosition=this.startPosition}this.state===z.WAITING_LEVEL&&(this.state=z.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===z.KEY_LOADING&&(this.state=z.IDLE,this.tick())}},{key:"onFragLoaded",value:function(r){var q=this.fragCurrent;if(this.state===z.FRAG_LOADING&&q&&r.frag.level===q.level&&r.frag.sn===q.sn){if(this.fragBitrateTest===!0){this.state=z.IDLE,this.fragBitrateTest=!1,r.stats.tparsed=r.stats.tbuffered=performance.now(),this.hls.trigger(K["default"].FRAG_BUFFERED,{stats:r.stats,frag:q})}else{this.state=z.PARSING,this.stats=r.stats;var p=this.levels[this.level],o=p.details,n=o.totalduration,m=q.start,l=q.level,k=q.sn,j=p.audioCodec||this.config.defaultAudioCodec;this.audioCodecSwap&&(H.logger.log("swapping playlist audio codec"),void 0===j&&(j=this.lastAudioCodec),j&&(j=-1!==j.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingAppending=0,H.logger.log("Demuxing "+k+" of ["+o.startSN+" ,"+o.endSN+"],level "+l),this.demuxer.push(r.payload,j,p.videoCodec,m,q.cc,l,k,n,q.decryptdata)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(j){if(this.state===z.PARSING){var i,p,o=j.tracks;if(p=o.audio){var n=this.levels[this.level].audioCodec,m=navigator.userAgent.toLowerCase();n&&this.audioCodecSwap&&(H.logger.log("swapping playlist audio codec"),n=-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==p.metadata.channelCount&&-1===m.indexOf("firefox")&&(n="mp4a.40.5"),-1!==m.indexOf("android")&&(n="mp4a.40.2",H.logger.log("Android: force audio codec to"+n)),p.levelCodec=n}if(p=o.video,p&&(p.levelCodec=this.levels[this.level].videoCodec),j.unique){var l={codec:"",levelCodec:""};for(i in j.tracks){p=o[i],l.container=p.container,l.codec&&(l.codec+=",",l.levelCodec+=","),p.codec&&(l.codec+=p.codec),p.levelCodec&&(l.levelCodec+=p.levelCodec)}o={audiovideo:l}}this.hls.trigger(K["default"].BUFFER_CODECS,o);for(i in o){p=o[i],H.logger.log("track:"+i+",container:"+p.container+",codecs[level/parsed]=["+p.levelCodec+"/"+p.codec+"]");var k=p.initSegment;k&&(this.pendingAppending++,this.hls.trigger(K["default"].BUFFER_APPENDING,{type:i,data:k}))}this.tick()}}},{key:"onFragParsingData",value:function(h){var g=this;if(this.state===z.PARSING){this.tparse2=Date.now();var l=this.levels[this.level],k=this.fragCurrent;H.logger.log("parsed "+h.type+",PTS:["+h.startPTS.toFixed(3)+","+h.endPTS.toFixed(3)+"],DTS:["+h.startDTS.toFixed(3)+"/"+h.endDTS.toFixed(3)+"],nb:"+h.nb);var j=B["default"].updateFragPTS(l.details,k.sn,h.startPTS,h.endPTS),i=this.hls;i.trigger(K["default"].LEVEL_PTS_UPDATED,{details:l.details,level:this.level,drift:j}),[h.data1,h.data2].forEach(function(b){b&&(g.pendingAppending++,i.trigger(K["default"].BUFFER_APPENDING,{type:h.type,data:b}))}),this.nextLoadPosition=h.endPTS,this.bufferRange.push({type:h.type,start:h.startPTS,end:h.endPTS,frag:k}),this.tick()}else{H.logger.warn("not in PARSING state but "+this.state+", ignoring FRAG_PARSING_DATA event")}}},{key:"onFragParsed",value:function(){this.state===z.PARSING&&(this.stats.tparsed=performance.now(),this.state=z.PARSED,this._checkAppendedParsed())}},{key:"onBufferAppended",value:function(){switch(this.state){case z.PARSING:case z.PARSED:this.pendingAppending--,this._checkAppendedParsed()}}},{key:"_checkAppendedParsed",value:function(){if(this.state===z.PARSED&&0===this.pendingAppending){var f=this.fragCurrent,e=this.stats;f&&(this.fragPrevious=f,e.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*e.length/(e.tbuffered-e.tfirst)),this.hls.trigger(K["default"].FRAG_BUFFERED,{stats:e,frag:f}),H.logger.log("media buffered : "+this.timeRangesToString(this.media.buffered)),this.state=z.IDLE),this.tick()}}},{key:"onError",value:function(f){switch(f.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!f.fatal){var e=this.fragLoadError;if(e?e++:e=1,e<=this.config.fragLoadingMaxRetry){this.fragLoadError=e,f.frag.loadCounter=0;var g=Math.min(Math.pow(2,e-1)*this.config.fragLoadingRetryDelay,64000);H.logger.warn("mediaController: frag loading failed, retry in "+g+" ms"),this.retryDate=performance.now()+g,this.state=z.FRAG_LOADING_WAITING_RETRY}else{H.logger.error("mediaController: "+f.details+" reaches max retry, redispatch as fatal ..."),f.fatal=!0,this.hls.trigger(K["default"].ERROR,f),this.state=z.ERROR}}break;case A.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case A.ErrorDetails.LEVEL_LOAD_ERROR:case A.ErrorDetails.LEVEL_LOAD_TIMEOUT:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==z.ERROR&&(this.state=f.fatal?z.ERROR:z.IDLE,H.logger.warn("mediaController: "+f.details+" while loading frag,switch to "+this.state+" state ..."));break;case A.ErrorDetails.BUFFER_FULL_ERROR:this.config.maxMaxBufferLength/=2,H.logger.warn("reduce max buffer length to "+this.config.maxMaxBufferLength+"s and trigger a nextLevelSwitch to flush old buffer and fix QuotaExceededError"),this.nextLevelSwitch()}}},{key:"_checkBuffer",value:function(){var Z=this.media;if(Z){var Y=Z.readyState;if(Y){var X,W,x=this.seekAfterBuffered;if(x){Z.duration>=x&&(X=x,this.seekAfterBuffered=void 0)}else{W=Z.currentTime;var w=this.loadedmetadata;!w&&Z.buffered.length&&(this.loadedmetadata=!0,W||W===this.startPosition||(X=this.startPosition))}X&&(W=X,H.logger.log("target seek position:"+X));var v=D["default"].bufferInfo(Z,W,0),u=!(Z.paused||Z.ended||Z.seeking||2>Y),t=0.4,s=W>Z.playbackRate*this.lastCurrentTime;this.stalled&&s&&(this.stalled=!1,H.logger.log("playback not stuck anymore @"+W));var r=this.config.seekHoleNudgeDuration;if(u&&v.len<=t){if(s?(t=0,this.seekHoleNudgeDuration=0):this.stalled?this.seekHoleNudgeDuration+=r:(this.seekHoleNudgeDuration=0,H.logger.log("playback seems stuck @"+W),this.hls.trigger(K["default"].ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1}),this.stalled=!0),v.len<=t){var q=v.nextStart,o=q-W;if(q&&o<this.config.maxSeekHole&&o>0&&!Z.seeking){H.logger.log("adjust currentTime from "+Z.currentTime+" to next buffered @ "+q+" + nudge "+this.seekHoleNudgeDuration);var l=q+this.seekHoleNudgeDuration-Z.currentTime;Z.currentTime=q+this.seekHoleNudgeDuration,this.hls.trigger(K["default"].ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:l})}}this.stalledInBuffered=0}else{X&&Z.currentTime!==X?(H.logger.log("adjust currentTime from "+Z.currentTime+" to "+X),Z.currentTime=X):u&&!s?(void 0!==this.stalledInBuffered?this.stalledInBuffered++:this.stalledInBuffered=1,this.stalledInBuffered>=this.config.stalledInBufferedNudgeThreshold&&(H.logger.log("playback stuck @ "+Z.currentTime+", in buffered area, nudge currentTime by "+r),this.hls.trigger(K["default"].ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_SEEK_STUCK_IN_BUFFERED,fatal:!1}),Z.currentTime+=r,this.stalledInBuffered=0)):this.stalledInBuffered=0}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=z.IDLE,this.tick()}},{key:"onBufferFlushed",value:function(){var f,e,g=[];for(e=0;e<this.bufferRange.length;e++){f=this.bufferRange[e],this.isBuffered((f.start+f.end)/2)&&g.push(f)}this.bufferRange=g,this.immediateSwitch&&this.immediateLevelSwitchEnd(),this.state=z.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"timeRangesToString",value:function(f){for(var e="",h=f.length,g=0;h>g;g++){e+="["+f.start(g)+","+f.end(g)+"]"}return e}},{key:"currentLevel",get:function(){if(this.media){var b=this.getBufferRange(this.media.currentTime);if(b){return b.frag.level}}return -1}},{key:"nextBufferRange",get:function(){return this.media?this.followingBufferRange(this.getBufferRange(this.media.currentTime)):null}},{key:"nextLevel",get:function(){var b=this.nextBufferRange;return b?b.frag.level:-1}}]),c}(I["default"]);T["default"]=y},{"../demux/demuxer":179,"../errors":183,"../event-handler":184,"../events":185,"../helper/buffer-helper":186,"../helper/level-helper":187,"../utils/binary-search":197,"../utils/logger":199}],171:[function(D,C,B){function A(b){return b&&b.__esModule?b:{"default":b}}function z(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function y(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function x(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(B,"__esModule",{value:!0});var w=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),v=D("../events"),u=A(v),t=D("../event-handler"),s=A(t),r=D("../utils/cea-708-interpreter"),q=A(r),p=function(d){function c(b){z(this,c);var e=y(this,Object.getPrototypeOf(c).call(this,b,u["default"].MEDIA_ATTACHING,u["default"].MEDIA_DETACHING,u["default"].FRAG_PARSING_USERDATA,u["default"].MANIFEST_LOADING,u["default"].FRAG_LOADED));return e.hls=b,e.config=b.config,e.config.enableCEA708Captions&&(e.cea708Interpreter=new q["default"]),e}return x(c,d),w(c,[{key:"destroy",value:function(){s["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(f){var e=this.media=f.media;this.cea708Interpreter.attach(e)}},{key:"onMediaDetaching",value:function(){this.cea708Interpreter.detach()}},{key:"onManifestLoading",value:function(){this.lastPts=Number.POSITIVE_INFINITY}},{key:"onFragLoaded",value:function(f){var e=f.frag.start;e<=this.lastPts&&this.cea708Interpreter.clear(),this.lastPts=e}},{key:"onFragParsingUserdata",value:function(f){for(var e=0;e<f.samples.length;e++){this.cea708Interpreter.push(f.samples[e].pts,f.samples[e].bytes)}}}]),c}(s["default"]);B["default"]=p},{"../event-handler":184,"../events":185,"../utils/cea-708-interpreter":198}],172:[function(h,g,l){function k(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(l,"__esModule",{value:!0});var j=function(){function b(f,e){for(var n=0;n<e.length;n++){var m=e[n];m.enumerable=m.enumerable||!1,m.configurable=!0,"value" in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}return function(e,m,f){return m&&b(e.prototype,m),f&&b(e,f),e}}(),i=function(){function b(u){k(this,b),this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],this._precompute();var t,s,r,q,p,o=this._tables[0][4],n=this._tables[1],m=u.length,d=1;if(4!==m&&6!==m&&8!==m){throw new Error("Invalid aes key size="+m)}for(q=u.slice(0),p=[],this._key=[q,p],t=m;4*m+28>t;t++){r=q[t-1],(t%m===0||8===m&&t%m===4)&&(r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[255&r],t%m===0&&(r=r<<8^r>>>24^d<<24,d=d<<1^283*(d>>7))),q[t]=q[t-m]^r}for(s=0;t;s++,t--){r=q[3&s?t:t-4],4>=t||4>s?p[s]=r:p[s]=n[0][o[r>>>24]]^n[1][o[r>>16&255]]^n[2][o[r>>8&255]]^n[3][o[255&r]]}}return j(b,[{key:"_precompute",value:function(){var D,C,B,A,z,y,x,w,v,u=this._tables[0],t=this._tables[1],s=u[4],r=t[4],q=[],p=[];for(D=0;256>D;D++){p[(q[D]=D<<1^283*(D>>7))^D]=D}for(C=B=0;!s[C];C^=A||1,B=p[B]||1){for(x=B^B<<1^B<<2^B<<3^B<<4,x=x>>8^255&x^99,s[C]=x,r[x]=C,y=q[z=q[A=q[C]]],v=16843009*y^65537*z^257*A^16843008*C,w=257*q[x]^16843008*x,D=0;4>D;D++){u[D][C]=w=w<<24^w>>>8,t[D][x]=v=v<<24^v>>>8}}for(D=0;5>D;D++){u[D]=u[D].slice(0),t[D]=t[D].slice(0)}}},{key:"decrypt",value:function(T,S,R,Q,P,O){var N,M,L,K,J=this._key[1],I=T^J[0],H=Q^J[1],G=R^J[2],F=S^J[3],E=J.length/4-2,D=4,C=this._tables[1],B=C[0],A=C[1],z=C[2],y=C[3],x=C[4];for(K=0;E>K;K++){N=B[I>>>24]^A[H>>16&255]^z[G>>8&255]^y[255&F]^J[D],M=B[H>>>24]^A[G>>16&255]^z[F>>8&255]^y[255&I]^J[D+1],L=B[G>>>24]^A[F>>16&255]^z[I>>8&255]^y[255&H]^J[D+2],F=B[F>>>24]^A[I>>16&255]^z[H>>8&255]^y[255&G]^J[D+3],D+=4,I=N,H=M,G=L}for(K=0;4>K;K++){P[(3&-K)+O]=x[I>>>24]<<24^x[H>>16&255]<<16^x[G>>8&255]<<8^x[255&F]^J[D++],N=I,I=H,H=G,G=F,F=N}}}]),b}();l["default"]=i},{}],173:[function(r,q,p){function o(b){return b&&b.__esModule?b:{"default":b}}function n(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(p,"__esModule",{value:!0});var m=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),l=r("./aes"),k=o(l),j=function(){function b(d,e){n(this,b),this.key=d,this.iv=e}return m(b,[{key:"ntoh",value:function(c){return c<<24|(65280&c)<<8|(16711680&c)>>8|c>>>24}},{key:"doDecrypt",value:function(G,F,E){var D,C,B,A,z,y,x,w,v,u=new Int32Array(G.buffer,G.byteOffset,G.byteLength>>2),t=new k["default"](Array.prototype.slice.call(F)),s=new Uint8Array(G.byteLength),h=new Int32Array(s.buffer);for(D=~~E[0],C=~~E[1],B=~~E[2],A=~~E[3],v=0;v<u.length;v+=4){z=~~this.ntoh(u[v]),y=~~this.ntoh(u[v+1]),x=~~this.ntoh(u[v+2]),w=~~this.ntoh(u[v+3]),t.decrypt(z,y,x,w,h,v),h[v]=this.ntoh(h[v]^D),h[v+1]=this.ntoh(h[v+1]^C),h[v+2]=this.ntoh(h[v+2]^B),h[v+3]=this.ntoh(h[v+3]^A),D=z,C=y,B=x,A=w}return s}},{key:"localDecrypt",value:function(g,f,s,i){var h=this.doDecrypt(g,f,s);i.set(h,g.byteOffset)}},{key:"decrypt",value:function(i){var h=32000,w=new Int32Array(i),v=new Uint8Array(i.byteLength),u=0,t=this.key,s=this.iv;for(this.localDecrypt(w.subarray(u,u+h),t,s,v),u=h;u<w.length;u+=h){s=new Uint32Array([this.ntoh(w[u-4]),this.ntoh(w[u-3]),this.ntoh(w[u-2]),this.ntoh(w[u-1])]),this.localDecrypt(w.subarray(u,u+h),t,s,v)}return v}}]),b}();p["default"]=j},{"./aes":172}],174:[function(v,u,t){function s(b){return b&&b.__esModule?b:{"default":b}}function r(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(t,"__esModule",{value:!0});var q=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),p=v("./aes128-decrypter"),o=s(p),n=v("../errors"),m=v("../utils/logger"),l=function(){function b(e){r(this,b),this.hls=e;try{var g=window?window.crypto:crypto;this.subtle=g.subtle||g.webkitSubtle,this.disableWebCrypto=!this.subtle}catch(f){this.disableWebCrypto=!0}}return q(b,[{key:"destroy",value:function(){}},{key:"decrypt",value:function(f,e,h,g){this.disableWebCrypto&&this.hls.config.enableSoftwareAES?this.decryptBySoftware(f,e,h,g):this.decryptByWebCrypto(f,e,h,g)}},{key:"decryptByWebCrypto",value:function(g,f,j,i){var h=this;m.logger.log("decrypting by WebCrypto API"),this.subtle.importKey("raw",f,{name:"AES-CBC",length:128},!1,["decrypt"]).then(function(c){h.subtle.decrypt({name:"AES-CBC",iv:j.buffer},c,g).then(i)["catch"](function(d){h.onWebCryptoError(d,g,f,j,i)})})["catch"](function(c){h.onWebCryptoError(c,g,f,j,i)})}},{key:"decryptBySoftware",value:function(j,h,A,z){m.logger.log("decrypting by JavaScript Implementation");var y=new DataView(h.buffer),x=new Uint32Array([y.getUint32(0),y.getUint32(4),y.getUint32(8),y.getUint32(12)]);y=new DataView(A.buffer);var w=new Uint32Array([y.getUint32(0),y.getUint32(4),y.getUint32(8),y.getUint32(12)]),k=new o["default"](x,w);z(k.decrypt(j).buffer)}},{key:"onWebCryptoError",value:function(g,f,j,i,h){this.hls.config.enableSoftwareAES?(m.logger.log("disabling to use WebCrypto API"),this.disableWebCrypto=!0,this.decryptBySoftware(f,j,i,h)):(m.logger.error("decrypting error : "+g.message),this.hls.trigger(Event.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:g.message}))}}]),b}();t["default"]=l},{"../errors":183,"../utils/logger":199,"./aes128-decrypter":173}],175:[function(x,w,v){function u(b){return b&&b.__esModule?b:{"default":b}}function t(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(v,"__esModule",{value:!0});var s=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),r=x("./adts"),q=u(r),p=x("../utils/logger"),o=x("../demux/id3"),n=u(o),m=function(){function b(d,e){t(this,b),this.observer=d,this.remuxerClass=e,this.remuxer=new this.remuxerClass(d),this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0}}return s(b,[{key:"push",value:function(O,N,M,L,K,J,I,H){var G,F,E,D,C,B,A,z,y,k=this._aacTrack,i=new n["default"](O),h=90*i.timeStamp;for(C=i.length,z=O.length;z-1>C&&(255!==O[C]||240!==(240&O[C+1]));C++){}for(k.audiosamplerate||(G=q["default"].getAudioConfig(this.observer,O,C,N),k.config=G.config,k.audiosamplerate=G.samplerate,k.channelCount=G.channelCount,k.codec=G.codec,k.duration=H,p.logger.log("parsed codec:"+k.codec+",rate:"+G.samplerate+",nb channel:"+G.channelCount)),D=0,E=92160000/k.audiosamplerate;z>C+5&&(B=1&O[C+1]?7:9,F=(3&O[C+3])<<11|O[C+4]<<3|(224&O[C+5])>>>5,F-=B,F>0&&z>=C+B+F);){for(A=h+D*E,y={unit:O.subarray(C+B,C+B+F),pts:A,dts:A},k.samples.push(y),k.len+=F,C+=F+B,D++;z-1>C&&(255!==O[C]||240!==(240&O[C+1]));C++){}}this.remuxer.remux(this._aacTrack,{samples:[]},{samples:[{pts:h,dts:h,unit:i.payload}]},{samples:[]},L)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(f){var e,h,g=new n["default"](f);if(g.hasTimeStamp){for(e=g.length,h=f.length;h-1>e;e++){if(255===f[e]&&240===(240&f[e+1])){return !0}}}return !1}}]),b}();v["default"]=m},{"../demux/id3":181,"../utils/logger":199,"./adts":176}],176:[function(j,i,p){function o(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(p,"__esModule",{value:!0});var n=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),m=j("../utils/logger"),l=j("../errors"),k=function(){function b(){o(this,b)}return n(b,null,[{key:"getAudioConfig",value:function(y,x,w,v){var u,t,s,r,q,g=navigator.userAgent.toLowerCase(),f=[96000,88200,64000,48000,44100,32000,24000,22050,16000,12000,11025,8000,7350];return u=((192&x[w+2])>>>6)+1,t=(60&x[w+2])>>>2,t>f.length-1?void y.trigger(Event.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+t}):(r=(1&x[w+2])<<2,r|=(192&x[w+3])>>>6,m.logger.log("manifest codec:"+v+",ADTS data:type:"+u+",sampleingIndex:"+t+"["+f[t]+"Hz],channelConfig:"+r),-1!==g.indexOf("firefox")?t>=6?(u=5,q=new Array(4),s=t-3):(u=2,q=new Array(2),s=t):-1!==g.indexOf("android")?(u=2,q=new Array(2),s=t):(u=5,q=new Array(4),v&&(-1!==v.indexOf("mp4a.40.29")||-1!==v.indexOf("mp4a.40.5"))||!v&&t>=6?s=t-3:((v&&-1!==v.indexOf("mp4a.40.2")&&t>=6&&1===r||!v&&1===r)&&(u=2,q=new Array(2)),s=t)),q[0]=u<<3,q[0]|=(14&t)>>1,q[1]|=(1&t)<<7,q[1]|=r<<3,5===u&&(q[1]|=(14&s)>>1,q[2]=(1&s)<<7,q[2]|=8,q[3]=0),{config:q,samplerate:f[t],channelCount:r,codec:"mp4a.40."+u})}}]),b}();p["default"]=k},{"../errors":183,"../utils/logger":199}],177:[function(J,I,H){function G(b){return b&&b.__esModule?b:{"default":b}}function F(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(H,"__esModule",{value:!0});var E=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),D=J("../events"),C=G(D),B=J("../errors"),A=J("../demux/aacdemuxer"),z=G(A),y=J("../demux/tsdemuxer"),x=G(y),w=J("../remux/mp4-remuxer"),v=G(w),u=J("../remux/passthrough-remuxer"),t=G(u),s=function(){function b(d,e){F(this,b),this.hls=d,this.typeSupported=e}return E(b,[{key:"destroy",value:function(){var c=this.demuxer;c&&c.destroy()}},{key:"push",value:function(L,K,r,q,p,o,m,k){var i=this.demuxer;if(!i){var h=this.hls;if(x["default"].probe(L)){i=this.typeSupported.mp2t===!0?new x["default"](h,t["default"]):new x["default"](h,v["default"])}else{if(!z["default"].probe(L)){return void h.trigger(C["default"].ERROR,{type:B.ErrorTypes.MEDIA_ERROR,details:B.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"})}i=new z["default"](h,v["default"])}this.demuxer=i}i.push(L,K,r,q,p,o,m,k)}}]),b}();H["default"]=s},{"../demux/aacdemuxer":175,"../demux/tsdemuxer":182,"../errors":183,"../events":185,"../remux/mp4-remuxer":194,"../remux/passthrough-remuxer":195}],178:[function(v,u,t){function s(b){return b&&b.__esModule?b:{"default":b}}Object.defineProperty(t,"__esModule",{value:!0});var r=v("../demux/demuxer-inline"),q=s(r),p=v("../events"),o=s(p),n=v("events"),m=s(n),l=function(d){var c=new m["default"];c.trigger=function(b){for(var h=arguments.length,g=Array(h>1?h-1:0),f=1;h>f;f++){g[f-1]=arguments[f]}c.emit.apply(c,[b,b].concat(g))},c.off=function(b){for(var h=arguments.length,g=Array(h>1?h-1:0),f=1;h>f;f++){g[f-1]=arguments[f]}c.removeListener.apply(c,[b].concat(g))},d.addEventListener("message",function(e){var b=e.data;switch(b.cmd){case"init":d.demuxer=new q["default"](c,b.typeSupported);break;case"demux":d.demuxer.push(new Uint8Array(b.data),b.audioCodec,b.videoCodec,b.timeOffset,b.cc,b.level,b.sn,b.duration)}}),c.on(o["default"].FRAG_PARSING_INIT_SEGMENT,function(e,f){d.postMessage({event:e,tracks:f.tracks,unique:f.unique})}),c.on(o["default"].FRAG_PARSING_DATA,function(e,g){var f={event:e,type:g.type,startPTS:g.startPTS,endPTS:g.endPTS,startDTS:g.startDTS,endDTS:g.endDTS,data1:g.data1.buffer,data2:g.data2.buffer,nb:g.nb};d.postMessage(f,[f.data1,f.data2])}),c.on(o["default"].FRAG_PARSED,function(e){d.postMessage({event:e})}),c.on(o["default"].ERROR,function(e,f){d.postMessage({event:e,data:f})}),c.on(o["default"].FRAG_PARSING_METADATA,function(e,g){var f={event:e,samples:g.samples};d.postMessage(f)}),c.on(o["default"].FRAG_PARSING_USERDATA,function(e,g){var f={event:e,samples:g.samples};d.postMessage(f)})};t["default"]=l},{"../demux/demuxer-inline":177,"../events":185,events:164}],179:[function(F,E,D){function C(b){return b&&b.__esModule?b:{"default":b}}function B(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(D,"__esModule",{value:!0});var A=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),z=F("../events"),y=C(z),x=F("../demux/demuxer-inline"),w=C(x),v=F("../demux/demuxer-worker"),u=C(v),t=F("../utils/logger"),s=F("../crypt/decrypter"),r=C(s),q=function(){function c(i){B(this,c),this.hls=i;var h={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:i.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t")};if(i.config.enableWorker&&"undefined"!=typeof Worker){t.logger.log("demuxing in webworker");try{var e=F("webworkify");this.w=e(u["default"]),this.onwmsg=this.onWorkerMessage.bind(this),this.w.addEventListener("message",this.onwmsg),this.w.postMessage({cmd:"init",typeSupported:h})}catch(b){t.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),this.demuxer=new w["default"](i,h)}}else{this.demuxer=new w["default"](i,h)}this.demuxInitialized=!0}return A(c,[{key:"destroy",value:function(){this.w?(this.w.removeEventListener("message",this.onwmsg),this.w.terminate(),this.w=null):(this.demuxer.destroy(),this.demuxer=null),this.decrypter&&(this.decrypter.destroy(),this.decrypter=null)}},{key:"pushDecrypted",value:function(j,i,p,o,n,m,l,k){this.w?this.w.postMessage({cmd:"demux",data:j,audioCodec:i,videoCodec:p,timeOffset:o,cc:n,level:m,sn:l,duration:k},[j]):this.demuxer.push(new Uint8Array(j),i,p,o,n,m,l,k)}},{key:"push",value:function(J,I,H,G,p,o,n,m,l){if(J.byteLength>0&&null!=l&&null!=l.key&&"AES-128"===l.method){null==this.decrypter&&(this.decrypter=new r["default"](this.hls));var k=this;this.decrypter.decrypt(J,l.key,l.iv,function(b){k.pushDecrypted(b,I,H,G,p,o,n,m)})}else{this.pushDecrypted(J,I,H,G,p,o,n,m)}}},{key:"onWorkerMessage",value:function(e){var d=e.data;switch(d.event){case y["default"].FRAG_PARSING_INIT_SEGMENT:var f={};f.tracks=d.tracks,f.unique=d.unique,this.hls.trigger(y["default"].FRAG_PARSING_INIT_SEGMENT,f);break;case y["default"].FRAG_PARSING_DATA:this.hls.trigger(y["default"].FRAG_PARSING_DATA,{data1:new Uint8Array(d.data1),data2:new Uint8Array(d.data2),startPTS:d.startPTS,endPTS:d.endPTS,startDTS:d.startDTS,endDTS:d.endDTS,type:d.type,nb:d.nb});break;case y["default"].FRAG_PARSING_METADATA:this.hls.trigger(y["default"].FRAG_PARSING_METADATA,{samples:d.samples});break;case y["default"].FRAG_PARSING_USERDATA:this.hls.trigger(y["default"].FRAG_PARSING_USERDATA,{samples:d.samples});break;default:this.hls.trigger(d.event,d.data)}}}]),c}();D["default"]=q},{"../crypt/decrypter":174,"../demux/demuxer-inline":177,"../demux/demuxer-worker":178,"../events":185,"../utils/logger":199,webworkify:341}],180:[function(i,h,n){function m(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function b(f,e){for(var o=0;o<e.length;o++){var g=e[o];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),k=i("../utils/logger"),j=function(){function b(c){m(this,b),this.data=c,this.bytesAvailable=this.data.byteLength,this.word=0,this.bitsAvailable=0}return l(b,[{key:"loadWord",value:function(){var e=this.data.byteLength-this.bytesAvailable,d=new Uint8Array(4),f=Math.min(4,this.bytesAvailable);if(0===f){throw new Error("no bytes available")}d.set(this.data.subarray(e,e+f)),this.word=new DataView(d.buffer).getUint32(0),this.bitsAvailable=8*f,this.bytesAvailable-=f}},{key:"skipBits",value:function(d){var c;this.bitsAvailable>d?(this.word<<=d,this.bitsAvailable-=d):(d-=this.bitsAvailable,c=d>>3,d-=c>>3,this.bytesAvailable-=c,this.loadWord(),this.word<<=d,this.bitsAvailable-=d)}},{key:"readBits",value:function(e){var d=Math.min(this.bitsAvailable,e),f=this.word>>>32-d;return e>32&&k.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=d,this.bitsAvailable>0?this.word<<=d:this.bytesAvailable>0&&this.loadWord(),d=e-d,d>0?f<<d|this.readBits(d):f}},{key:"skipLZ",value:function(){var c;for(c=0;c<this.bitsAvailable;++c){if(0!==(this.word&2147483648>>>c)){return this.word<<=c,this.bitsAvailable-=c,c}}return this.loadWord(),c+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var c=this.skipLZ();return this.readBits(c+1)-1}},{key:"readEG",value:function(){var c=this.readUEG();return 1&c?1+c>>>1:-1*(c>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(g){var f,q,p=8,o=8;for(f=0;g>f;f++){0!==o&&(q=this.readEG(),o=(p+q+256)%256),p=0===o?p:o}}},{key:"readSPS",value:function(){var J,I,H,G,F,E,D,C,B,A=0,z=0,y=0,x=0,w=1;if(this.readUByte(),J=this.readUByte(),I=this.readBits(5),this.skipBits(3),H=this.readUByte(),this.skipUEG(),100===J||110===J||122===J||244===J||44===J||83===J||86===J||118===J||128===J){var v=this.readUEG();if(3===v&&this.skipBits(1),this.skipUEG(),this.skipUEG(),this.skipBits(1),this.readBoolean()){for(C=3!==v?8:12,B=0;C>B;B++){this.readBoolean()&&(6>B?this.skipScalingList(16):this.skipScalingList(64))}}}this.skipUEG();var u=this.readUEG();if(0===u){this.readUEG()}else{if(1===u){for(this.skipBits(1),this.skipEG(),this.skipEG(),G=this.readUEG(),B=0;G>B;B++){this.skipEG()}}}if(this.skipUEG(),this.skipBits(1),F=this.readUEG(),E=this.readUEG(),D=this.readBits(1),0===D&&this.skipBits(1),this.skipBits(1),this.readBoolean()&&(A=this.readUEG(),z=this.readUEG(),y=this.readUEG(),x=this.readUEG()),this.readBoolean()&&this.readBoolean()){var t=void 0,s=this.readUByte();switch(s){case 1:t=[1,1];break;case 2:t=[12,11];break;case 3:t=[10,11];break;case 4:t=[16,11];break;case 5:t=[40,33];break;case 6:t=[24,11];break;case 7:t=[20,11];break;case 8:t=[32,11];break;case 9:t=[80,33];break;case 10:t=[18,11];break;case 11:t=[15,11];break;case 12:t=[64,33];break;case 13:t=[160,99];break;case 14:t=[4,3];break;case 15:t=[3,2];break;case 16:t=[2,1];break;case 255:t=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()]}t&&(w=t[0]/t[1])}return{width:Math.ceil((16*(F+1)-2*A-2*z)*w),height:(2-D)*(E+1)*16-(D?2:4)*(y+x)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),b}();n["default"]=j},{"../utils/logger":199}],181:[function(i,h,n){function m(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function b(f,e){for(var o=0;o<e.length;o++){var g=e[o];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),k=i("../utils/logger"),j=function(){function b(v){m(this,b),this._hasTimeStamp=!1;for(var u,t,s,r,q,p,o,f,d=0;;){if(o=this.readUTF(v,d,3),d+=3,"ID3"===o){d+=3,u=127&v[d++],t=127&v[d++],s=127&v[d++],r=127&v[d++],q=(u<<21)+(t<<14)+(s<<7)+r,p=d+q,this._parseID3Frames(v,d,p),d=p}else{if("3DI"!==o){return d-=3,f=d,void (f&&(this.hasTimeStamp||k.logger.warn("ID3 tag found, but no timestamp"),this._length=f,this._payload=v.subarray(0,f)))}d+=7,k.logger.log("3DI footer found, end: "+d)}}}return l(b,[{key:"readUTF",value:function(o,g,s){var r="",q=g,p=g+s;do{r+=String.fromCharCode(o[q++])}while(p>q);return r}},{key:"_parseID3Frames",value:function(v,u,t){for(var s,r,q,p,o;t>=u+8;){switch(s=this.readUTF(v,u,4),u+=4,r=v[u++]<<24+v[u++]<<16+v[u++]<<8+v[u++],p=v[u++]<<8+v[u++],q=u,s){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(v,u,44)){u+=44,u+=4;var f=1&v[u++];this._hasTimeStamp=!0,o=((v[u++]<<23)+(v[u++]<<15)+(v[u++]<<7)+v[u++])/45,f&&(o+=47721858.84),o=Math.round(o),k.logger.trace("ID3 timestamp found: "+o),this._timeStamp=o}}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),b}();n["default"]=j},{"../utils/logger":199}],182:[function(D,C,B){function A(b){return b&&b.__esModule?b:{"default":b}}function z(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(B,"__esModule",{value:!0});var y=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),x=D("./adts"),w=A(x),v=D("../events"),u=A(v),t=D("./exp-golomb"),s=A(t),r=D("../utils/logger"),q=D("../errors"),p=function(){function b(d,e){z(this,b),this.observer=d,this.remuxerClass=e,this.lastCC=0,this.remuxer=new this.remuxerClass(d)}return y(b,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this.lastAacPTS=null,this.aacOverFlow=null,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,nbNalu:0},this._aacTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(W,V,U,T,S,R,Q,P){var O,N,M,L,K,J,I,H,G=W.length,F=this.remuxer.passthrough;this.audioCodec=V,this.videoCodec=U,this.timeOffset=T,this._duration=P,this.contiguous=!1,S!==this.lastCC?(r.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=S):R!==this.lastLevel?(r.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=R):Q===this.lastSN+1&&(this.contiguous=!0),this.lastSN=Q,this.contiguous||(this.aacOverFlow=null);var E=this.pmtParsed,n=this._avcTrack.id,m=this._aacTrack.id,j=this._id3Track.id;for(G-=G%188,L=0;G>L;L+=188){if(71===W[L]){if(K=!!(64&W[L+1]),J=((31&W[L+1])<<8)+W[L+2],I=(48&W[L+3])>>4,I>1){if(H=L+5+W[L+4],H===L+188){continue}}else{H=L+4}if(E){if(J===n){if(K){if(O&&(this._parseAVCPES(this._parsePES(O)),F&&this._avcTrack.codec&&(-1===m||this._aacTrack.codec))){return void this.remux(W)}O={data:[],size:0}}O&&(O.data.push(W.subarray(H,L+188)),O.size+=L+188-H)}else{if(J===m){if(K){if(N&&(this._parseAACPES(this._parsePES(N)),F&&this._aacTrack.codec&&(-1===n||this._avcTrack.codec))){return void this.remux(W)}N={data:[],size:0}}N&&(N.data.push(W.subarray(H,L+188)),N.size+=L+188-H)}else{J===j&&(K&&(M&&this._parseID3PES(this._parsePES(M)),M={data:[],size:0}),M&&(M.data.push(W.subarray(H,L+188)),M.size+=L+188-H))}}}else{K&&(H+=W[H]+1),0===J?this._parsePAT(W,H):J===this._pmtId&&(this._parsePMT(W,H),E=this.pmtParsed=!0,n=this._avcTrack.id,m=this._aacTrack.id,j=this._id3Track.id)}}else{this.observer.trigger(u["default"].ERROR,{type:q.ErrorTypes.MEDIA_ERROR,details:q.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"})}}O&&this._parseAVCPES(this._parsePES(O)),N&&this._parseAACPES(this._parsePES(N)),M&&this._parseID3PES(this._parsePES(M)),this.remux(null)}},{key:"remux",value:function(c){this.remuxer.remux(this._aacTrack,this._avcTrack,this._id3Track,this._txtTrack,this.timeOffset,this.contiguous,c)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(d,c){this._pmtId=(31&d[c+10])<<8|d[c+11]}},{key:"_parsePMT",value:function(h,g){var l,k,j,i;for(l=(15&h[g+1])<<8|h[g+2],k=g+3+l-4,j=(15&h[g+10])<<8|h[g+11],g+=12+j;k>g;){switch(i=(31&h[g+1])<<8|h[g+2],h[g]){case 15:this._aacTrack.id=i;break;case 21:this._id3Track.id=i;break;case 27:this._avcTrack.id=i;break;default:r.logger.log("unkown stream type:"+h[g])}g+=((15&h[g+3])<<8|h[g+4])+5}}},{key:"_parsePES",value:function(O){var N,M,L,K,J,I,H,G,F,E=0,o=O.data;if(N=o[0],L=(N[0]<<16)+(N[1]<<8)+N[2],1===L){for(K=(N[4]<<8)+N[5],M=N[7],192&M&&(H=536870912*(14&N[9])+4194304*(255&N[10])+16384*(254&N[11])+128*(255&N[12])+(254&N[13])/2,H>4294967295&&(H-=8589934592),64&M?(G=536870912*(14&N[14])+4194304*(255&N[15])+16384*(254&N[16])+128*(255&N[17])+(254&N[18])/2,G>4294967295&&(G-=8589934592)):G=H),J=N[8],F=J+9,O.size-=F,I=new Uint8Array(O.size);o.length;){N=o.shift();var n=N.byteLength;if(F){if(F>n){F-=n;continue}N=N.subarray(F),n-=F,F=0}I.set(N,E),E+=n}return{data:I,pts:H,dts:G,len:K}}return null}},{key:"_parseAVCPES",value:function(R){var Q,P,O,N,M=this,L=this._avcTrack,K=L.samples,J=this._parseAVCNALu(R.data),I=[],H=!1,G=!1,F=0;if(0===J.length&&K.length>0){var E=K[K.length-1],m=E.units.units[E.units.units.length-1],l=new Uint8Array(m.data.byteLength+R.data.byteLength);l.set(m.data,0),l.set(R.data,m.data.byteLength),m.data=l,E.units.length+=R.data.byteLength,L.len+=R.data.byteLength}R.data=null;var S="";J.forEach(function(T){switch(T.type){case 1:O=!0,H&&(S+="NDR ");break;case 5:O=!0,H&&(S+="IDR "),G=!0;break;case 6:O=!0,H&&(S+="SEI "),Q=new s["default"](T.data),Q.readUByte();var n=Q.readUByte();if(4===n){var k=0;do{k=Q.readUByte()}while(255===k);var j=Q.readUByte();if(181===j){var f=Q.readUShort();if(49===f){var e=Q.readUInt();if(1195456820===e){var d=Q.readUByte();if(3===d){var Z=Q.readUByte(),Y=Q.readUByte(),X=31&Z,W=[Z,Y];for(N=0;X>N;N++){W.push(Q.readUByte()),W.push(Q.readUByte()),W.push(Q.readUByte())}M._txtTrack.samples.push({type:3,pts:R.pts,bytes:W})}}}}}break;case 7:if(O=!0,H&&(S+="SPS "),!L.sps){Q=new s["default"](T.data);var V=Q.readSPS();L.width=V.width,L.height=V.height,L.sps=[T.data],L.duration=M._duration;var U=T.data.subarray(1,4),o="avc1.";for(N=0;3>N;N++){var g=U[N].toString(16);g.length<2&&(g="0"+g),o+=g}L.codec=o}break;case 8:O=!0,H&&(S+="PPS "),L.pps||(L.pps=[T.data]);break;case 9:O=!1,H&&(S+="AUD ");break;default:O=!1,S+="unknown NAL "+T.type+" "}O&&(I.push(T),F+=T.data.byteLength)}),(H||S.length)&&r.logger.log(S),I.length&&(G===!0||L.sps)&&(P={units:{units:I,length:F},pts:R.pts,dts:R.dts,key:G},K.push(P),L.len+=F,L.nbNalu+=I.length)}},{key:"_parseAVCNALu",value:function(U){for(var T,S,R,Q,P,O,N=0,M=U.byteLength,L=0,K=[];M>N;){switch(T=U[N++],L){case 0:0===T&&(L=1);break;case 1:L=0===T?2:0;break;case 2:case 3:if(0===T){L=3}else{if(1===T&&M>N){if(Q=31&U[N],P){R={data:U.subarray(P,N-L-1),type:O},K.push(R)}else{if(S=N-L-1){var J=this._avcTrack,I=J.samples;if(I.length){var H=I[I.length-1],G=H.units.units,F=G[G.length-1],E=new Uint8Array(F.data.byteLength+S);E.set(F.data,0),E.set(U.subarray(0,S),F.data.byteLength),F.data=E,H.units.length+=S,J.len+=S}}}P=N,O=Q,L=0}else{L=0}}}}return P&&(R={data:U.subarray(P,M),type:O},K.push(R)),K}},{key:"_parseAACPES",value:function(V){var U,T,S,R,Q,P,O,N,M,L=this._aacTrack,K=V.data,J=V.pts,I=0,H=this._duration,G=this.audioCodec,F=this.aacOverFlow,E=this.lastAacPTS;if(F){var n=new Uint8Array(F.byteLength+K.byteLength);n.set(F,0),n.set(K,F.byteLength),K=n}for(Q=I,N=K.length;N-1>Q&&(255!==K[Q]||240!==(240&K[Q+1]));Q++){}if(Q){var m,j;if(N-1>Q?(m="AAC PES did not start with ADTS header,offset:"+Q,j=!1):(m="no ADTS header found in AAC PES",j=!0),this.observer.trigger(u["default"].ERROR,{type:q.ErrorTypes.MEDIA_ERROR,details:q.ErrorDetails.FRAG_PARSING_ERROR,fatal:j,reason:m}),j){return}}if(L.audiosamplerate||(U=w["default"].getAudioConfig(this.observer,K,Q,G),L.config=U.config,L.audiosamplerate=U.samplerate,L.channelCount=U.channelCount,L.codec=U.codec,L.duration=H,r.logger.log("parsed codec:"+L.codec+",rate:"+U.samplerate+",nb channel:"+U.channelCount)),R=0,S=92160000/L.audiosamplerate,F&&E){var h=E+S;Math.abs(h-J)>1&&(r.logger.log("AAC: align PTS for overlapping frames by "+Math.round((h-J)/90)),J=h)}for(;N>Q+5&&(P=1&K[Q+1]?7:9,T=(3&K[Q+3])<<11|K[Q+4]<<3|(224&K[Q+5])>>>5,T-=P,T>0&&N>=Q+P+T);){for(O=J+R*S,M={unit:K.subarray(Q+P,Q+P+T),pts:O,dts:O},L.samples.push(M),L.len+=T,Q+=T+P,R++;N-1>Q&&(255!==K[Q]||240!==(240&K[Q+1]));Q++){}}F=N>Q?K.subarray(Q,N):null,this.aacOverFlow=F,this.lastAacPTS=O}},{key:"_parseID3PES",value:function(c){this._id3Track.samples.push(c)}}],[{key:"probe",value:function(c){return c.length>=564&&71===c[0]&&71===c[188]&&71===c[376]?!0:!1}}]),b}();B["default"]=p},{"../errors":183,"../events":185,"../utils/logger":199,"./adts":176,"./exp-golomb":180}],183:[function(e,d,f){Object.defineProperty(f,"__esModule",{value:!0});f.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"},f.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_SEEK_STUCK_IN_BUFFERED:"bufferSeekStuckInBuffered",INTERNAL_EXCEPTION:"internalException"}},{}],184:[function(x,w,v){function u(b){return b&&b.__esModule?b:{"default":b}}function t(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(v,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol?"symbol":typeof b},r=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),q=x("./utils/logger"),p=x("./errors"),o=x("./events"),n=u(o),m=function(){function b(e){t(this,b),this.hls=e,this.onEvent=this.onEvent.bind(this);for(var i=arguments.length,h=Array(i>1?i-1:0),g=1;i>g;g++){h[g-1]=arguments[g]}this.handledEvents=h,this.useGenericHandler=!0,this.registerListeners()}return r(b,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===s(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(c){if("hlsEventGeneric"===c){throw new Error("Forbidden event name: "+c)}this.hls.on(c,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(c){this.hls.off(c,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(d,c){this.onEventGeneric(d,c)}},{key:"onEventGeneric",value:function(f,e){var h=function(i,d){var j="on"+i.replace("hls","");if("function"!=typeof this[j]){throw new Error("Event "+i+" has no generic handler in this "+this.constructor.name+" class (tried "+j+")")}return this[j].bind(this,d)};try{h.call(this,f,e).call()}catch(g){q.logger.error("internal error happened while processing "+f+":"+g.message),this.hls.trigger(n["default"].ERROR,{type:p.ErrorTypes.OTHER_ERROR,details:p.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:f,err:g})}}}]),b}();v["default"]=m},{"./errors":183,"./events":185,"./utils/logger":199}],185:[function(e,d,f){d.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded"}},{}],186:[function(h,g,l){function k(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(l,"__esModule",{value:!0});var j=function(){function b(f,e){for(var n=0;n<e.length;n++){var m=e[n];m.enumerable=m.enumerable||!1,m.configurable=!0,"value" in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}return function(e,m,f){return m&&b(e.prototype,m),f&&b(e,f),e}}(),i=function(){function b(){k(this,b)}return j(b,null,[{key:"bufferInfo",value:function(n,m,r){if(n){var q,p=n.buffered,o=[];for(q=0;q<p.length;q++){o.push({start:p.start(q),end:p.end(q)})}return this.bufferedInfo(o,m,r)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(z,y,x){var w,v,u,t,s,r=[];for(z.sort(function(e,d){var f=e.start-d.start;return f?f:d.end-e.end}),s=0;s<z.length;s++){var q=r.length;if(q){var p=r[q-1].end;z[s].start-p<x?z[s].end>p&&(r[q-1].end=z[s].end):r.push(z[s])}else{r.push(z[s])}}for(s=0,w=0,v=u=y;s<r.length;s++){var o=r[s].start,n=r[s].end;if(y+x>=o&&n>y){v=o,u=n,w=u-y}else{if(o>y+x){t=o;break}}}return{len:w,start:v,end:u,nextStart:t}}}]),b}();l["default"]=i},{}],187:[function(i,h,n){function m(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function b(f,e){for(var o=0;o<e.length;o++){var g=e[o];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),k=i("../utils/logger"),j=function(){function b(){m(this,b)}return l(b,null,[{key:"mergeDetails",value:function(A,z){var y,x=Math.max(A.startSN,z.startSN)-z.startSN,w=Math.min(A.endSN,z.endSN)-z.startSN,v=z.startSN-A.startSN,u=A.fragments,t=z.fragments,s=0;if(x>w){return void (z.PTSKnown=!1)}for(var r=x;w>=r;r++){var q=u[v+r],p=t[r];s=q.cc-p.cc,isNaN(q.startPTS)||(p.start=p.startPTS=q.startPTS,p.endPTS=q.endPTS,p.duration=q.duration,y=p)}if(s){for(k.logger.log("discontinuity sliding from playlist, take drift into account"),r=0;r<t.length;r++){t[r].cc+=s}}if(y){b.updateFragPTS(z,y.sn,y.startPTS,y.endPTS)}else{if(v>=0&&v<u.length){var f=u[v].start;for(r=0;r<t.length;r++){t[r].start+=f}}}z.PTSKnown=A.PTSKnown}},{key:"updateFragPTS",value:function(w,v,u,t){var s,r,q,p;if(v<w.startSN||v>w.endSN){return 0}s=v-w.startSN,r=w.fragments,q=r[s],isNaN(q.startPTS)||(u=Math.min(u,q.startPTS),t=Math.max(t,q.endPTS));var o=u-q.start;for(q.start=q.startPTS=u,q.endPTS=t,q.duration=t-u,p=s;p>0;p--){b.updatePTS(r,p,p-1)}for(p=s;p<r.length-1;p++){b.updatePTS(r,p,p+1)}return w.PTSKnown=!0,o}},{key:"updatePTS",value:function(o,f,s){var r=o[f],q=o[s],p=q.startPTS;isNaN(p)?s>f?q.start=r.start+r.duration:q.start=r.start-q.duration:s>f?(r.duration=p-r.start,r.duration<0&&k.logger.error("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(q.duration=r.start-p,q.duration<0&&k.logger.error("negative duration computed for frag "+q.sn+",level "+q.level+", there should be some duration drift between playlist and fragment!"))}}]),b}();n["default"]=j},{"../utils/logger":199}],188:[function(an,am,al){function ak(b){return b&&b.__esModule?b:{"default":b}}function aj(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(al,"__esModule",{value:!0});var ai=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),ah=an("./events"),ag=ak(ah),af=an("./errors"),ae=an("./loader/playlist-loader"),ad=ak(ae),ac=an("./loader/fragment-loader"),ab=ak(ac),aa=an("./controller/abr-controller"),Z=ak(aa),Y=an("./controller/buffer-controller"),W=ak(Y),U=an("./controller/cap-level-controller"),S=ak(U),Q=an("./controller/stream-controller"),O=ak(Q),M=an("./controller/level-controller"),K=ak(M),J=an("./controller/timeline-controller"),I=ak(J),H=an("./utils/logger"),X=an("./utils/xhr-loader"),V=ak(X),T=an("events"),R=ak(T),P=an("./loader/key-loader"),N=ak(P),L=function(){function b(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];aj(this,b);var i=b.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration)){throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration")}for(var h in i){h in e||(e[h]=i[h])}if(void 0!==e.liveMaxLatencyDurationCount&&e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount){throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"')}if(void 0!==e.liveMaxLatencyDuration&&(e.liveMaxLatencyDuration<=e.liveSyncDuration||void 0===e.liveSyncDuration)){throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"')}(0,H.enableLogs)(e.debug),this.config=e;var g=this.observer=new R["default"];g.trigger=function(j){for(var f=arguments.length,l=Array(f>1?f-1:0),k=1;f>k;k++){l[k-1]=arguments[k]}g.emit.apply(g,[j,j].concat(l))},g.off=function(j){for(var f=arguments.length,l=Array(f>1?f-1:0),k=1;f>k;k++){l[k-1]=arguments[k]}g.removeListener.apply(g,[j].concat(l))},this.on=g.on.bind(g),this.off=g.off.bind(g),this.trigger=g.trigger.bind(g),this.playlistLoader=new ad["default"](this),this.fragmentLoader=new ab["default"](this),this.levelController=new K["default"](this),this.abrController=new e.abrController(this),this.bufferController=new e.bufferController(this),this.capLevelController=new e.capLevelController(this),this.streamController=new e.streamController(this),this.timelineController=new e.timelineController(this),this.keyLoader=new N["default"](this)}return ai(b,null,[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"Events",get:function(){return ag["default"]}},{key:"ErrorTypes",get:function(){return af.ErrorTypes}},{key:"ErrorDetails",get:function(){return af.ErrorDetails}},{key:"DefaultConfig",get:function(){return b.defaultConfig||(b.defaultConfig={autoStartLoad:!0,debug:!1,capLevelToPlayerSize:!1,maxBufferLength:30,maxBufferSize:60000000,maxBufferHole:0.5,maxSeekHole:2,seekHoleNudgeDuration:0.01,stalledInBufferedNudgeThreshold:10,maxFragLookUpTolerance:0.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:10000,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1000,levelLoadingTimeOut:10000,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1000,fragLoadingTimeOut:20000,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1000,fragLoadingLoopThreshold:3,startFragPrefetch:!1,appendErrorMaxRetry:3,loader:V["default"],fLoader:void 0,pLoader:void 0,abrController:Z["default"],bufferController:W["default"],capLevelController:S["default"],streamController:O["default"],timelineController:I["default"],enableCEA708Captions:!0,enableMP2TPassThrough:!1}),b.defaultConfig},set:function(c){b.defaultConfig=c}}]),ai(b,[{key:"destroy",value:function(){H.logger.log("destroy"),this.trigger(ag["default"].DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.streamController.destroy(),this.timelineController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(c){H.logger.log("attachMedia"),this.media=c,this.trigger(ag["default"].MEDIA_ATTACHING,{media:c})}},{key:"detachMedia",value:function(){H.logger.log("detachMedia"),this.trigger(ag["default"].MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(c){H.logger.log("loadSource:"+c),this.url=c,this.trigger(ag["default"].MANIFEST_LOADING,{url:c})}},{key:"startLoad",value:function(){var c=arguments.length<=0||void 0===arguments[0]?0:arguments[0];H.logger.log("startLoad"),this.levelController.startLoad(),this.streamController.startLoad(c)}},{key:"stopLoad",value:function(){H.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad()}},{key:"swapAudioCodec",value:function(){H.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){H.logger.log("recoverMediaError");var c=this.media;this.detachMedia(),this.attachMedia(c)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(c){H.logger.log("set currentLevel:"+c),this.loadLevel=c,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(c){H.logger.log("set nextLevel:"+c),this.levelController.manualLevel=c,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(c){H.logger.log("set loadLevel:"+c),this.levelController.manualLevel=c}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(c){this.levelController.nextLoadLevel=c}},{key:"firstLevel",get:function(){return this.levelController.firstLevel},set:function(c){H.logger.log("set firstLevel:"+c),this.levelController.firstLevel=c}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(c){H.logger.log("set startLevel:"+c),this.levelController.startLevel=c}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(c){H.logger.log("set autoLevelCapping:"+c),this.abrController.autoLevelCapping=c}},{key:"autoLevelEnabled",get:function(){return -1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}}]),b}();al["default"]=L},{"./controller/abr-controller":166,"./controller/buffer-controller":167,"./controller/cap-level-controller":168,"./controller/level-controller":169,"./controller/stream-controller":170,"./controller/timeline-controller":171,"./errors":183,"./events":185,"./loader/fragment-loader":190,"./loader/key-loader":191,"./loader/playlist-loader":192,"./utils/logger":199,"./utils/xhr-loader":201,events:164}],189:[function(e,d,f){d.exports=e("./hls.js")["default"]},{"./hls.js":188}],190:[function(B,A,z){function y(b){return b&&b.__esModule?b:{"default":b}}function x(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function w(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function v(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(z,"__esModule",{value:!0});var u=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),t=B("../events"),s=y(t),r=B("../event-handler"),q=y(r),p=B("../errors"),o=function(d){function c(b){return x(this,c),w(this,Object.getPrototypeOf(c).call(this,b,s["default"].FRAG_LOADING))}return v(c,d),u(c,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),q["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(f){var e=f.frag;this.frag=e,this.frag.loaded=0;var g=this.hls.config;e.loader=this.loader="undefined"!=typeof g.fLoader?new g.fLoader(g):new g.loader(g),this.loader.load(e.url,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),g.fragLoadingTimeOut,1,0,this.loadprogress.bind(this),e)}},{key:"loadsuccess",value:function(f,e){var g=f.currentTarget.response;e.length=g.byteLength,this.frag.loader=void 0,this.hls.trigger(s["default"].FRAG_LOADED,{payload:g,frag:this.frag,stats:e})}},{key:"loaderror",value:function(b){this.loader&&this.loader.abort(),this.hls.trigger(s["default"].ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:this.frag,response:b})}},{key:"loadtimeout",value:function(){this.loader&&this.loader.abort(),this.hls.trigger(s["default"].ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:this.frag})}},{key:"loadprogress",value:function(f,e){this.frag.loaded=e.loaded,this.hls.trigger(s["default"].FRAG_LOAD_PROGRESS,{frag:this.frag,stats:e})}}]),c}(q["default"]);z["default"]=o},{"../errors":183,"../event-handler":184,"../events":185}],191:[function(B,A,z){function y(b){return b&&b.__esModule?b:{"default":b}}function x(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function w(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function v(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(z,"__esModule",{value:!0});var u=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),t=B("../events"),s=y(t),r=B("../event-handler"),q=y(r),p=B("../errors"),o=function(d){function c(b){x(this,c);var e=w(this,Object.getPrototypeOf(c).call(this,b,s["default"].KEY_LOADING));return e.decryptkey=null,e.decrypturl=null,e}return v(c,d),u(c,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),q["default"].prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(g){var f=this.frag=g.frag,j=f.decryptdata,i=j.uri;if(i!==this.decrypturl||null===this.decryptkey){var h=this.hls.config;f.loader=this.loader=new h.loader(h),this.decrypturl=i,this.decryptkey=null,f.loader.load(i,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),h.fragLoadingTimeOut,h.fragLoadingMaxRetry,h.fragLoadingRetryDelay,this.loadprogress.bind(this),f)}else{this.decryptkey&&(j.key=this.decryptkey,this.hls.trigger(s["default"].KEY_LOADED,{frag:f}))}}},{key:"loadsuccess",value:function(f){var e=this.frag;this.decryptkey=e.decryptdata.key=new Uint8Array(f.currentTarget.response),e.loader=void 0,this.hls.trigger(s["default"].KEY_LOADED,{frag:e})}},{key:"loaderror",value:function(b){this.loader&&this.loader.abort(),this.hls.trigger(s["default"].ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:this.frag,response:b})}},{key:"loadtimeout",value:function(){this.loader&&this.loader.abort(),this.hls.trigger(s["default"].ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:this.frag})}},{key:"loadprogress",value:function(){}}]),c}(q["default"]);z["default"]=o},{"../errors":183,"../event-handler":184,"../events":185}],192:[function(J,I,H){function G(b){return b&&b.__esModule?b:{"default":b}}function F(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}function E(d,c){if(!d){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!=typeof c&&"function"!=typeof c?d:c}function D(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=Object.create(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(d,c):d.__proto__=c)}Object.defineProperty(H,"__esModule",{value:!0});var C=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),B=J("../events"),A=G(B),z=J("../event-handler"),y=G(z),x=J("../errors"),w=J("../utils/url"),v=G(w),u=J("../utils/attr-list"),t=G(u),s=function(d){function c(b){return F(this,c),E(this,Object.getPrototypeOf(c).call(this,b,A["default"].MANIFEST_LOADING,A["default"].LEVEL_LOADING))}return D(c,d),C(c,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),this.url=this.id=null,y["default"].prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(b){this.load(b.url,null)}},{key:"onLevelLoading",value:function(b){this.load(b.url,b.level,b.id)}},{key:"load",value:function(i,h,n){var m,l,k,j=this.hls.config;this.url=i,this.id=h,this.id2=n,null===this.id?(m=j.manifestLoadingMaxRetry,l=j.manifestLoadingTimeOut,k=j.manifestLoadingRetryDelay):(m=j.levelLoadingMaxRetry,l=j.levelLoadingTimeOut,k=j.levelLoadingRetryDelay),this.loader="undefined"!=typeof j.pLoader?new j.pLoader(j):new j.loader(j),this.loader.load(i,"",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),l,m,k)}},{key:"resolve",value:function(f,e){return v["default"].buildAbsoluteURL(e,f)}},{key:"parseMasterPlaylist",value:function(N,M){for(var L=[],K=void 0,r=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g;null!=(K=r.exec(N));){var q={},p=q.attrs=new t["default"](K[1]);q.url=this.resolve(K[2],M);var o=p.decimalResolution("RESOLUTION");o&&(q.width=o.width,q.height=o.height),q.bitrate=p.decimalInteger("AVERAGE-BANDWIDTH")||p.decimalInteger("BANDWIDTH"),q.name=p.NAME;var n=p.CODECS;if(n){n=n.split(",");for(var m=0;m<n.length;m++){var l=n[m];-1!==l.indexOf("avc1")?q.videoCodec=this.avc1toavcoti(l):q.audioCodec=l}}L.push(q)}return L}},{key:"avc1toavcoti",value:function(f){var e,g=f.split(".");return g.length>2?(e=g.shift()+".",e+=parseInt(g.shift()).toString(16),e+=("000"+parseInt(g.shift()).toString(16)).substr(-4)):e=f,e}},{key:"cloneObj",value:function(b){return JSON.parse(JSON.stringify(b))}},{key:"parseLevelPlaylist",value:function(ai,ah,ag){var af,ae,ad,ac,ab=0,aa=0,Z={url:ah,fragments:[],live:!0,startSN:0},Y={method:null,key:null,iv:null,uri:null},X=0,W=null,V=null;for(ae=/(?:#EXT-X-(MEDIA-SEQUENCE):(\d+))|(?:#EXT-X-(TARGETDURATION):(\d+))|(?:#EXT-X-(KEY):(.*))|(?:#EXT(INF):([\d\.]+)[^\r\n]*([\r\n]+[^#|\r\n]+)?)|(?:#EXT-X-(BYTERANGE):([\d]+[@[\d]*)]*[\r\n]+([^#|\r\n]+)?|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(PROGRAM-DATE-TIME):(.*))/g;null!==(af=ae.exec(ai));){switch(af.shift(),af=af.filter(function(b){return void 0!==b}),af[0]){case"MEDIA-SEQUENCE":ab=Z.startSN=parseInt(af[1]);break;case"TARGETDURATION":Z.targetduration=parseFloat(af[1]);break;case"ENDLIST":Z.live=!1;break;case"DIS":X++;break;case"BYTERANGE":var U=af[1].split("@");ac=1===U.length?ad:parseInt(U[1]),ad=parseInt(U[0])+ac,V&&!V.url&&(V.byteRangeStartOffset=ac,V.byteRangeEndOffset=ad,V.url=this.resolve(af[2],ah));break;case"INF":var T=parseFloat(af[1]);if(!isNaN(T)){var R,Q=ab++;if(Y.method&&Y.uri&&!Y.iv){R=this.cloneObj(Y);for(var P=new Uint8Array(16),O=12;16>O;O++){P[O]=Q>>8*(15-O)&255}R.iv=P}else{R=Y}var N=af[2]?this.resolve(af[2],ah):null;V={url:N,duration:T,start:aa,sn:Q,level:ag,cc:X,byteRangeStartOffset:ac,byteRangeEndOffset:ad,decryptdata:R,programDateTime:W},Z.fragments.push(V),aa+=T,ac=null,W=null}break;case"KEY":var M=af[1],L=new t["default"](M),K=L.enumeratedString("METHOD"),q=L.URI,S=L.hexadecimalInteger("IV");K&&(Y={method:null,key:null,iv:null,uri:null},q&&"AES-128"===K&&(Y.method=K,Y.uri=this.resolve(q,ah),Y.key=null,Y.iv=S));break;case"PROGRAM-DATE-TIME":W=new Date(Date.parse(af[1]))}}return V&&!V.url&&(Z.fragments.pop(),aa-=V.duration),Z.totalduration=aa,Z.endSN=ab-1,Z}},{key:"loadsuccess",value:function(L,K){var r,q=L.currentTarget,p=q.responseText,o=q.responseURL,n=this.id,m=this.id2,l=this.hls;if(void 0===o&&(o=this.url),K.tload=performance.now(),K.mtime=new Date(q.getResponseHeader("Last-Modified")),0===p.indexOf("#EXTM3U")){if(p.indexOf("#EXTINF:")>0){if(null===this.id){l.trigger(A["default"].MANIFEST_LOADED,{levels:[{url:o}],url:o,stats:K})}else{var j=this.parseLevelPlaylist(p,o,n);K.tparsed=performance.now(),l.trigger(A["default"].LEVEL_LOADED,{details:j,level:n,id:m,stats:K})}}else{r=this.parseMasterPlaylist(p,o),r.length?l.trigger(A["default"].MANIFEST_LOADED,{levels:r,url:o,stats:K}):l.trigger(A["default"].ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no level found in manifest"})}}else{l.trigger(A["default"].ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no EXTM3U delimiter"})}}},{key:"loaderror",value:function(f){var e,g;null===this.id?(e=x.ErrorDetails.MANIFEST_LOAD_ERROR,g=!0):(e=x.ErrorDetails.LEVEL_LOAD_ERROR,g=!1),this.loader&&this.loader.abort(),this.hls.trigger(A["default"].ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:e,fatal:g,url:this.url,loader:this.loader,response:f.currentTarget,level:this.id,id:this.id2})}},{key:"loadtimeout",value:function(){var f,e;null===this.id?(f=x.ErrorDetails.MANIFEST_LOAD_TIMEOUT,e=!0):(f=x.ErrorDetails.LEVEL_LOAD_TIMEOUT,e=!1),this.loader&&this.loader.abort(),this.hls.trigger(A["default"].ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:f,fatal:e,url:this.url,loader:this.loader,level:this.id,id:this.id2})}}]),c}(y["default"]);H["default"]=s},{"../errors":183,"../event-handler":184,"../events":185,"../utils/attr-list":196,"../utils/url":200}],193:[function(h,g,l){function k(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(l,"__esModule",{value:!0});var j=function(){function b(f,e){for(var n=0;n<e.length;n++){var m=e[n];m.enumerable=m.enumerable||!1,m.configurable=!0,"value" in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}return function(e,m,f){return m&&b(e.prototype,m),f&&b(e,f),e}}(),i=function(){function b(){k(this,b)}return j(b,null,[{key:"init",value:function(){b.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var m;for(m in b.types){b.types.hasOwnProperty(m)&&(b.types[m]=[m.charCodeAt(0),m.charCodeAt(1),m.charCodeAt(2),m.charCodeAt(3)])}var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),s=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);b.HDLR_TYPES={video:t,audio:s};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),q=new Uint8Array([0,0,0,0,0,0,0,0]);b.STTS=b.STSC=b.STCO=q,b.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),b.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),b.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),b.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var p=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),n=new Uint8Array([0,0,0,1]);b.FTYP=b.box(b.types.ftyp,p,n,p,o),b.DINF=b.box(b.types.dinf,b.box(b.types.dref,r))}},{key:"box",value:function(n){for(var m,r=Array.prototype.slice.call(arguments,1),q=8,p=r.length,o=p;p--;){q+=r[p].byteLength}for(m=new Uint8Array(q),m[0]=q>>24&255,m[1]=q>>16&255,m[2]=q>>8&255,m[3]=255&q,m.set(n,4),p=0,q=8;o>p;p++){m.set(r[p],q),q+=r[p].byteLength}return m}},{key:"hdlr",value:function(c){return b.box(b.types.hdlr,b.HDLR_TYPES[c])}},{key:"mdat",value:function(c){return b.box(b.types.mdat,c)}},{key:"mdhd",value:function(d,e){return e*=d,b.box(b.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,d>>24&255,d>>16&255,d>>8&255,255&d,e>>24,e>>16&255,e>>8&255,255&e,85,196,0,0]))}},{key:"mdia",value:function(c){return b.box(b.types.mdia,b.mdhd(c.timescale,c.duration),b.hdlr(c.type),b.minf(c))}},{key:"mfhd",value:function(c){return b.box(b.types.mfhd,new Uint8Array([0,0,0,0,c>>24,c>>16&255,c>>8&255,255&c]))}},{key:"minf",value:function(c){return"audio"===c.type?b.box(b.types.minf,b.box(b.types.smhd,b.SMHD),b.DINF,b.stbl(c)):b.box(b.types.minf,b.box(b.types.vmhd,b.VMHD),b.DINF,b.stbl(c))}},{key:"moof",value:function(e,m,f){return b.box(b.types.moof,b.mfhd(e),b.traf(f,m))}},{key:"moov",value:function(e){for(var m=e.length,f=[];m--;){f[m]=b.trak(e[m])}return b.box.apply(null,[b.types.moov,b.mvhd(e[0].timescale,e[0].duration)].concat(f).concat(b.mvex(e)))}},{key:"mvex",value:function(e){for(var m=e.length,f=[];m--;){f[m]=b.trex(e[m])}return b.box.apply(null,[b.types.mvex].concat(f))}},{key:"mvhd",value:function(e,m){m*=e;var f=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,e>>24&255,e>>16&255,e>>8&255,255&e,m>>24&255,m>>16&255,m>>8&255,255&m,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return b.box(b.types.mvhd,f)}},{key:"sdtp",value:function(m){var q,p,o=m.samples||[],n=new Uint8Array(4+o.length);for(p=0;p<o.length;p++){q=o[p].flags,n[p+4]=q.dependsOn<<4|q.isDependedOn<<2|q.hasRedundancy}return b.box(b.types.sdtp,n)}},{key:"stbl",value:function(c){return b.box(b.types.stbl,b.stsd(c),b.box(b.types.stts,b.STTS),b.box(b.types.stsc,b.STSC),b.box(b.types.stsz,b.STSZ),b.box(b.types.stco,b.STCO))}},{key:"avc1",value:function(u){var t,s,r,q=[],p=[];for(t=0;t<u.sps.length;t++){s=u.sps[t],r=s.byteLength,q.push(r>>>8&255),q.push(255&r),q=q.concat(Array.prototype.slice.call(s))}for(t=0;t<u.pps.length;t++){s=u.pps[t],r=s.byteLength,p.push(r>>>8&255),p.push(255&r),p=p.concat(Array.prototype.slice.call(s))}var o=b.box(b.types.avcC,new Uint8Array([1,q[3],q[4],q[5],255,224|u.sps.length].concat(q).concat([u.pps.length]).concat(p))),n=u.width,m=u.height;return b.box(b.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>8&255,255&n,m>>8&255,255&m,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,b.box(b.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(d){var c=d.config.length;return new Uint8Array([0,0,0,0,3,23+c,0,1,0,4,15+c,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([c]).concat(d.config).concat([6,1,2]))}},{key:"mp4a",value:function(d){var e=d.audiosamplerate;return b.box(b.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,d.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]),b.box(b.types.esds,b.esds(d)))}},{key:"stsd",value:function(c){return"audio"===c.type?b.box(b.types.stsd,b.STSD,b.mp4a(c)):b.box(b.types.stsd,b.STSD,b.avc1(c))}},{key:"tkhd",value:function(m){var q=m.id,p=m.duration*m.timescale,o=m.width,n=m.height;return b.box(b.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,q>>24&255,q>>16&255,q>>8&255,255&q,0,0,0,0,p>>24,p>>16&255,p>>8&255,255&p,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,255&o,0,0,n>>8&255,255&n,0,0]))}},{key:"traf",value:function(f,o){var n=b.sdtp(f),m=f.id;return b.box(b.types.traf,b.box(b.types.tfhd,new Uint8Array([0,0,0,0,m>>24,m>>16&255,m>>8&255,255&m])),b.box(b.types.tfdt,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o])),b.trun(f,n.length+16+16+8+16+8+8),n)}},{key:"trak",value:function(c){return c.duration=c.duration||4294967295,b.box(b.types.trak,b.tkhd(c),b.mdia(c))}},{key:"trex",value:function(d){var e=d.id;return b.box(b.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(y,x){var w,v,u,t,s,r,q=y.samples||[],p=q.length,o=12+16*p,n=new Uint8Array(o);for(x+=8+o,n.set([0,0,15,1,p>>>24&255,p>>>16&255,p>>>8&255,255&p,x>>>24&255,x>>>16&255,x>>>8&255,255&x],0),w=0;p>w;w++){v=q[w],u=v.duration,t=v.size,s=v.flags,r=v.cts,n.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,t>>>24&255,t>>>16&255,t>>>8&255,255&t,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,r>>>24&255,r>>>16&255,r>>>8&255,255&r],12+16*w)}return b.box(b.types.trun,n)}},{key:"initSegment",value:function(e){b.types||b.init();var m,f=b.moov(e);return m=new Uint8Array(b.FTYP.byteLength+f.byteLength),m.set(b.FTYP),m.set(f,b.FTYP.byteLength),m}}]),b}();l["default"]=i},{}],194:[function(z,y,x){function w(b){return b&&b.__esModule?b:{"default":b}}function v(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(x,"__esModule",{value:!0});var u=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),t=z("../events"),s=w(t),r=z("../utils/logger"),q=z("../remux/mp4-generator"),p=w(q),o=z("../errors"),n=function(){function b(c){v(this,b),this.observer=c,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=90000,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return u(b,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=this.nextAacPts=this.nextAvcDts=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(h,g,l,k,j,i){this.ISGenerated||this.generateIS(h,g,j),this.ISGenerated&&(g.samples.length&&this.remuxVideo(g,j,i),h.samples.length&&this.remuxAudio(h,j,i)),l.samples.length&&this.remuxID3(l,j),k.samples.length&&this.remuxText(k,j),this.observer.trigger(s["default"].FRAG_PARSED)}},{key:"generateIS",value:function(H,G,F){var E,D,C=this.observer,B=H.samples,A=G.samples,l=this.PES_TIMESCALE,k={},i={tracks:k,unique:!1},h=void 0===this._initPTS;h&&(E=D=1/0),H.config&&B.length&&(H.timescale=H.audiosamplerate,H.timescale*H.duration>Math.pow(2,32)&&!function(){var d=function e(f,c){return c?e(c,f%c):f};H.timescale=H.audiosamplerate/d(H.audiosamplerate,1024)}(),r.logger.log("audio mp4 timescale :"+H.timescale),k.audio={container:"audio/mp4",codec:H.codec,initSegment:p["default"].initSegment([H]),metadata:{channelCount:H.channelCount}},h&&(E=D=B[0].pts-l*F)),G.sps&&G.pps&&A.length&&(G.timescale=this.MP4_TIMESCALE,k.video={container:"video/mp4",codec:G.codec,initSegment:p["default"].initSegment([G]),metadata:{width:G.width,height:G.height}},h&&(E=Math.min(E,A[0].pts-l*F),D=Math.min(D,A[0].dts-l*F))),Object.keys(k).length?(C.trigger(s["default"].FRAG_PARSING_INIT_SEGMENT,i),this.ISGenerated=!0,h&&(this._initPTS=E,this._initDTS=D)):C.trigger(s["default"].ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(Z,Y,X){var W,V,U,T,S,R,Q,P,O,N,L,J,H,G,F,E=8,D=this.PES_TIMESCALE,k=this.PES2MP4SCALEFACTOR,i=[];for(R=new Uint8Array(Z.len+4*Z.nbNalu+8),W=new DataView(R.buffer),W.setUint32(0,R.byteLength),R.set(p["default"].types.mdat,4);Z.samples.length;){for(V=Z.samples.shift(),T=0;V.units.units.length;){S=V.units.units.shift(),W.setUint32(E,S.data.byteLength),E+=4,R.set(S.data,E),E+=S.data.byteLength,T+=4+S.data.byteLength}if(L=V.pts-this._initDTS,J=V.dts-this._initDTS,J=Math.min(L,J),void 0!==N){H=this._PTSNormalize(L,N),G=this._PTSNormalize(J,N);var h=(G-N)/k;0>=h&&(r.logger.log("invalid sample duration at PTS/DTS: "+V.pts+"/"+V.dts+":"+h),h=1),U.duration=h}else{var M=void 0,K=void 0;M=X?this.nextAvcDts:Y*D,H=this._PTSNormalize(L,M),G=this._PTSNormalize(J,M),K=Math.round((G-M)/90),X&&K&&(K>1?r.logger.log("AVC:"+K+" ms hole between fragments detected,filling it"):-1>K&&r.logger.log("AVC:"+-K+" ms overlapping between fragments detected"),G=M,H=Math.max(H-K,G),r.logger.log("Video/PTS/DTS adjusted: "+H+"/"+G+",delta:"+K)),P=Math.max(0,H),O=Math.max(0,G)}U={size:T,duration:0,cts:(H-G)/k,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0}},F=U.flags,V.key===!0?(F.dependsOn=2,F.isNonSync=0):(F.dependsOn=1,F.isNonSync=1),i.push(U),N=G}var I=0;i.length>=2&&(I=i[i.length-2].duration,U.duration=I),this.nextAvcDts=G+I*k,Z.len=0,Z.nbNalu=0,i.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(F=i[0].flags,F.dependsOn=2,F.isNonSync=0),Z.samples=i,Q=p["default"].moof(Z.sequenceNumber++,O/k,Z),Z.samples=[],this.observer.trigger(s["default"].FRAG_PARSING_DATA,{data1:Q,data2:R,startPTS:P/D,endPTS:(H+k*I)/D,startDTS:O/D,endDTS:this.nextAvcDts/D,type:"video",nb:i.length})}},{key:"remuxAudio",value:function(ab,aa,Z){var Y,X,W,V,U,T,S,R,Q,P,N,L,J,H=8,G=this.PES_TIMESCALE,F=ab.timescale,E=G/F,k=1024*ab.timescale/ab.audiosamplerate,i=[],h=[];for(ab.samples.sort(function(d,c){return d.pts-c.pts}),h=ab.samples;h.length;){if(X=h.shift(),V=X.unit,P=X.pts-this._initDTS,N=X.dts-this._initDTS,void 0!==Q){L=this._PTSNormalize(P,Q),J=this._PTSNormalize(N,Q),W.duration=(J-Q)/E,Math.abs(W.duration-k)>k/10&&r.logger.log("invalid AAC sample duration at PTS "+Math.round(P/90)+",should be 1024,found :"+Math.round(W.duration*ab.audiosamplerate/ab.timescale)),W.duration=k,J=k*E+Q}else{var O=void 0,M=void 0;if(O=Z?this.nextAacPts:aa*G,L=this._PTSNormalize(P,O),J=this._PTSNormalize(N,O),M=Math.round(1000*(L-O)/G),Z&&M){if(M>0){r.logger.log(M+" ms hole between AAC samples detected,filling it")}else{if(-12>M){r.logger.log(-M+" ms overlapping between AAC samples detected, drop frame"),ab.len-=V.byteLength;continue}}L=J=O}if(S=Math.max(0,L),R=Math.max(0,J),!(ab.len>0)){return}U=new Uint8Array(ab.len+8),Y=new DataView(U.buffer),Y.setUint32(0,U.byteLength),U.set(p["default"].types.mdat,4)}U.set(V,H),H+=V.byteLength,W={size:V.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},i.push(W),Q=J}var K=0,I=i.length;I>=2&&(K=i[I-2].duration,W.duration=K),I&&(this.nextAacPts=L+E*K,ab.len=0,ab.samples=i,T=p["default"].moof(ab.sequenceNumber++,R/E,ab),ab.samples=[],this.observer.trigger(s["default"].FRAG_PARSING_DATA,{data1:T,data2:U,startPTS:S/G,endPTS:this.nextAacPts/G,startDTS:R/G,endDTS:(J+E*K)/G,type:"audio",nb:I}))}},{key:"remuxID3",value:function(g,f){var j,i=g.samples.length;if(i){for(var h=0;i>h;h++){j=g.samples[h],j.pts=(j.pts-this._initPTS)/this.PES_TIMESCALE,j.dts=(j.dts-this._initDTS)/this.PES_TIMESCALE}this.observer.trigger(s["default"].FRAG_PARSING_METADATA,{samples:g.samples})}g.samples=[],f=f}},{key:"remuxText",value:function(g,f){g.samples.sort(function(d,c){return d.pts-c.pts});var j,i=g.samples.length;if(i){for(var h=0;i>h;h++){j=g.samples[h],j.pts=(j.pts-this._initPTS)/this.PES_TIMESCALE}this.observer.trigger(s["default"].FRAG_PARSING_USERDATA,{samples:g.samples})}g.samples=[],f=f}},{key:"_PTSNormalize",value:function(e,d){var f;if(void 0===d){return e}for(f=e>d?-8589934592:8589934592;Math.abs(e-d)>4294967296;){e+=f}return e}},{key:"passthrough",get:function(){return !1}}]),b}();x["default"]=n},{"../errors":183,"../events":185,"../remux/mp4-generator":193,"../utils/logger":199}],195:[function(r,q,p){function o(b){return b&&b.__esModule?b:{"default":b}}function n(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(p,"__esModule",{value:!0});var m=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),l=r("../events"),k=o(l),j=function(){function b(c){n(this,b),this.observer=c,this.ISGenerated=!1}return m(b,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(B,A,z,y,x,w){var v=this.observer;if(!this.ISGenerated){var u={},t={tracks:u,unique:!0},s=A,h=s.codec;h&&(t.tracks.video={container:s.container,codec:h,metadata:{width:s.width,height:s.height}}),s=B,h=s.codec,h&&(t.tracks.audio={container:s.container,codec:h,metadata:{channelCount:s.channelCount}}),this.ISGenerated=!0,v.trigger(k["default"].FRAG_PARSING_INIT_SEGMENT,t)}v.trigger(k["default"].FRAG_PARSING_DATA,{data1:w,startPTS:x,startDTS:x,type:"audiovideo",nb:1})}},{key:"passthrough",get:function(){return !0}}]),b}();p["default"]=j},{"../events":185}],196:[function(h,g,l){function k(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(l,"__esModule",{value:!0});var j=function(){function b(f,e){for(var n=0;n<e.length;n++){var m=e[n];m.enumerable=m.enumerable||!1,m.configurable=!0,"value" in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}return function(e,m,f){return m&&b(e.prototype,m),f&&b(e,f),e}}(),i=function(){function b(d){k(this,b),"string"==typeof d&&(d=b.parseAttrList(d));for(var e in d){d.hasOwnProperty(e)&&(this[e]=d[e])}}return j(b,[{key:"decimalInteger",value:function(d){var c=parseInt(this[d],10);return c>Number.MAX_SAFE_INTEGER?1/0:c}},{key:"hexadecimalInteger",value:function(f){if(this[f]){var e=(this[f]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var n=new Uint8Array(e.length/2),m=0;m<e.length/2;m++){n[m]=parseInt(e.slice(2*m,2*m+2),16)}return n}return null}},{key:"hexadecimalIntegerAsNumber",value:function(d){var c=parseInt(this[d],16);return c>Number.MAX_SAFE_INTEGER?1/0:c}},{key:"decimalFloatingPoint",value:function(c){return parseFloat(this[c])}},{key:"enumeratedString",value:function(c){return this[c]}},{key:"decimalResolution",value:function(d){var c=/^(\d+)x(\d+)$/.exec(this[d]);return null===c?void 0:{width:parseInt(c[1],10),height:parseInt(c[2],10)}}}],[{key:"parseAttrList",value:function(n){for(var m,r=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,q={};null!==(m=r.exec(n));){var p=m[2],o='"';0===p.indexOf(o)&&p.lastIndexOf(o)===p.length-1&&(p=p.slice(1,-1)),q[m[1]]=p}return q}}]),b}();l["default"]=i},{}],197:[function(f,e,h){var g={search:function(j,i){for(var o=0,n=j.length-1,m=null,l=null;n>=o;){m=(o+n)/2|0,l=j[m];var k=i(l);if(k>0){o=m+1}else{if(!(0>k)){return l}n=m-1}}return null}};e.exports=g},{}],198:[function(h,g,l){function k(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(l,"__esModule",{value:!0});var j=function(){function b(f,e){for(var n=0;n<e.length;n++){var m=e[n];m.enumerable=m.enumerable||!1,m.configurable=!0,"value" in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}return function(e,m,f){return m&&b(e.prototype,m),f&&b(e,f),e}}(),i=function(){function b(){k(this,b)}return j(b,[{key:"attach",value:function(c){this.media=c,this.display=[],this.memory=[]}},{key:"detach",value:function(){this.clear()}},{key:"destroy",value:function(){}},{key:"_createCue",value:function(){var d=window.VTTCue||window.TextTrackCue,c=this.cue=new d(-1,-1,"");c.text="",c.pauseOnExit=!1,c.startTime=Number.MAX_VALUE,c.endTime=Number.MAX_VALUE,this.memory.push(c)}},{key:"clear",value:function(){var c=this._textTrack;if(c&&c.cues){for(;c.cues.length>0;){c.removeCue(c.cues[0])}}}},{key:"push",value:function(v,u){this.cue||this._createCue();for(var t,s,r,q,p,o=31&u[0],n=2,m=0;o>m;m++){if(t=u[n++],s=127&u[n++],r=127&u[n++],q=0===(4&t)?!1:!0,p=3&t,(0!==s||0!==r)&&q&&0===p){if(32&s||64&s){this.cue.text+=this._fromCharCode(s)+this._fromCharCode(r)}else{if((17===s||25===s)&&r>=48&&63>=r){switch(r){case 48:this.cue.text+="";break;case 49:this.cue.text+="";break;case 50:this.cue.text+="";break;case 51:this.cue.text+="";break;case 52:this.cue.text+="";break;case 53:this.cue.text+="";break;case 54:this.cue.text+="";break;case 55:this.cue.text+="";break;case 56:this.cue.text+="";break;case 57:this.cue.text+=" ";break;case 58:this.cue.text+="";break;case 59:this.cue.text+="";break;case 60:this.cue.text+="";break;case 61:this.cue.text+="";break;case 62:this.cue.text+="";break;case 63:this.cue.text+=""}}}if((17===s||25===s)&&r>=32&&47>=r){switch(r){case 32:break;case 33:break;case 34:break;case 35:break;case 36:break;case 37:break;case 38:break;case 39:break;case 40:break;case 41:break;case 42:break;case 43:break;case 44:break;case 45:break;case 46:break;case 47:}}if((20===s||28===s)&&r>=32&&47>=r){switch(r){case 32:this._clearActiveCues(v);break;case 33:this.cue.text=this.cue.text.substr(0,this.cue.text.length-1);break;case 34:break;case 35:break;case 36:break;case 37:break;case 38:break;case 39:break;case 40:break;case 41:this._clearActiveCues(v);break;case 42:break;case 43:break;case 44:this._clearActiveCues(v);break;case 45:break;case 46:this._text="";break;case 47:this._flipMemory(v)}}if((23===s||31===s)&&r>=33&&35>=r){switch(r){case 33:break;case 34:break;case 35:}}}}}},{key:"_fromCharCode",value:function(c){switch(c){case 42:return"";case 2:return"";case 2:return"";case 4:return"";case 5:return"";case 6:return"";case 3:return"";case 4:return"";case 5:return"";case 6:return"";case 7:return"";default:return String.fromCharCode(c)}}},{key:"_flipMemory",value:function(c){this._clearActiveCues(c),this._flushCaptions(c)}},{key:"_flushCaptions",value:function(n){this._has708||(this._textTrack=this.media.addTextTrack("captions","English","en"),this._has708=!0);var m=!0,t=!1,s=void 0;try{for(var r,q=this.memory[Symbol.iterator]();!(m=(r=q.next()).done);m=!0){var p=r.value;p.startTime=n,this._textTrack.addCue(p),this.display.push(p)}}catch(o){t=!0,s=o}finally{try{!m&&q["return"]&&q["return"]()}finally{if(t){throw s}}}this.memory=[],this.cue=null}},{key:"_clearActiveCues",value:function(n){var m=!0,t=!1,s=void 0;try{for(var r,q=this.display[Symbol.iterator]();!(m=(r=q.next()).done);m=!0){var p=r.value;p.endTime=n}}catch(o){t=!0,s=o}finally{try{!m&&q["return"]&&q["return"]()}finally{if(t){throw s}}}this.display=[]}},{key:"_clearBufferedCues",value:function(){}}]),b}();l["default"]=i},{}],199:[function(t,s,r){function q(){}function p(d,c){return c="["+d+"] > "+c}function o(d){var c=window.console[d];return c?function(){for(var g=arguments.length,e=Array(g),b=0;g>b;b++){e[b]=arguments[b]}e[0]&&(e[0]=p(d,e[0])),c.apply(window.console,e)}:q}function n(f){for(var e=arguments.length,h=Array(e>1?e-1:0),g=1;e>g;g++){h[g-1]=arguments[g]}h.forEach(function(c){k[c]=f[c]?f[c].bind(f):o(c)})}Object.defineProperty(r,"__esModule",{value:!0});var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol?"symbol":typeof b},l={trace:q,debug:q,log:q,warn:q,info:q,error:q},k=l;r.enableLogs=function(d){if(d===!0||"object"===("undefined"==typeof d?"undefined":m(d))){n(d,"debug","log","info","warn","error");try{k.log()}catch(c){k=l}}else{k=l}},r.logger=k},{}],200:[function(f,e,h){var g={buildAbsoluteURL:function(z,y){if(y=y.trim(),/^[a-z]+:/i.test(y)){return y}var x=null,w=null,v=/^([^#]*)(.*)$/.exec(y);v&&(w=v[2],y=v[1]);var u=/^([^\?]*)(.*)$/.exec(y);u&&(x=u[2],y=u[1]);var t=/^([^#]*)(.*)$/.exec(z);t&&(z=t[1]);var s=/^([^\?]*)(.*)$/.exec(z);s&&(z=s[1]);var r=/^((([a-z]+):)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?\/)(.*)$/i.exec(z),q=r[3],p=r[1],o=r[5],d=null;return d=/^\/\//.test(y)?q+"://"+g.buildAbsolutePath("",y.substring(2)):/^\//.test(y)?p+g.buildAbsolutePath("",y.substring(1)):g.buildAbsolutePath(p+o,y),x&&(d+=x),w&&(d+=w),d},buildAbsolutePath:function(j,i){for(var p,o,n=i,m="",l=j.replace(/[^\/]*$/,n.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),k=0;o=l.indexOf("/../",k),o>-1;k=o+p){p=/^\/(?:\.\.\/)*/.exec(l.slice(o))[0].length,m=(m+l.substring(k,o)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(p-1)/3+"}$"),"/")}return m+l.substr(k)}};e.exports=g},{}],201:[function(i,h,n){function m(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function b(f,e){for(var o=0;o<e.length;o++){var g=e[o];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(e,g,f){return g&&b(e.prototype,g),f&&b(e,f),e}}(),k=i("../utils/logger"),j=function(){function b(c){m(this,b),c&&c.xhrSetup&&(this.xhrSetup=c.xhrSetup)}return l(b,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var d=this.loader,c=this.timeoutHandle;d&&4!==d.readyState&&(this.stats.aborted=!0,d.abort()),c&&window.clearTimeout(c)}},{key:"load",value:function(x,w,v,u,t,s,r,q){var p=arguments.length<=8||void 0===arguments[8]?null:arguments[8],o=arguments.length<=9||void 0===arguments[9]?null:arguments[9];this.url=x,!o||isNaN(o.byteRangeStartOffset)||isNaN(o.byteRangeEndOffset)||(this.byteRange=o.byteRangeStartOffset+"-"+(o.byteRangeEndOffset-1)),this.responseType=w,this.onSuccess=v,this.onProgress=p,this.onTimeout=t,this.onError=u,this.stats={trequest:performance.now(),retry:0},this.timeout=s,this.maxRetry=r,this.retryDelay=q,this.loadInternal()}},{key:"loadInternal",value:function(){var c;c="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,c.onloadend=this.loadend.bind(this),c.onprogress=this.loadprogress.bind(this),c.open("GET",this.url,!0),this.byteRange&&c.setRequestHeader("Range","bytes="+this.byteRange),c.responseType=this.responseType,this.stats.tfirst=null,this.stats.loaded=0,this.xhrSetup&&this.xhrSetup(c,this.url),this.timeoutHandle=window.setTimeout(this.loadtimeout.bind(this),this.timeout),c.send()}},{key:"loadend",value:function(f){var e=f.currentTarget,o=e.status,g=this.stats;g.aborted||(o>=200&&300>o?(window.clearTimeout(this.timeoutHandle),g.tload=performance.now(),this.onSuccess(f,g)):g.retry<this.maxRetry?(k.logger.warn(o+" while loading "+this.url+", retrying in "+this.retryDelay+"..."),this.destroy(),window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64000),g.retry++):(window.clearTimeout(this.timeoutHandle),k.logger.error(o+" while loading "+this.url),this.onError(f)))}},{key:"loadtimeout",value:function(c){k.logger.warn("timeout while loading "+this.url),this.onTimeout(c,this.stats)}},{key:"loadprogress",value:function(d){var c=this.stats;null===c.tfirst&&(c.tfirst=performance.now()),c.loaded=d.loaded,this.onProgress&&this.onProgress(d,c)}}]),b}();n["default"]=j},{"../utils/logger":199}],202:[function(e,d,f){(function(b){!function(c){if("object"==typeof f&&"undefined"!=typeof d){d.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof b?b:"undefined"!=typeof self?self:this,g.HlsjsWrapper=c()}}}(function(){var g;return function h(c,m,l){function k(r,q){if(!m[r]){if(!c[r]){var p="function"==typeof e&&e;if(!q&&p){return p(r,!0)}if(j){return j(r,!0)}var o=new Error("Cannot find module '"+r+"'");throw o.code="MODULE_NOT_FOUND",o}var n=m[r]={exports:{}};c[r][0].call(n.exports,function(s){var t=c[r][1][s];return k(t?t:s)},n,n.exports,h,c,m,l)}return m[r].exports}for(var j="function"==typeof e&&e,i=0;i<l.length;i++){k(l[i])}return k}({1:[function(v,u,t){function s(c){return c&&c.__esModule?c:{"default":c}}function r(i,c){if(!(i instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(t,"__esModule",{value:!0});var q=function(){function c(j,i){for(var w=0;w<i.length;w++){var k=i[w];k.enumerable=k.enumerable||!1,k.configurable=!0,"value" in k&&(k.writable=!0),Object.defineProperty(j,k.key,k)}}return function(i,k,j){return k&&c(i.prototype,k),j&&c(i,j),i}}(),p=v("./segment-view"),o=s(p),n=v("./track-view"),m=s(n),l=function(){function c(i){r(this,c),this.hls=i}return q(c,[{key:"getSegmentTime",value:function(i){if(void 0===i.time){throw new Error("getSegmentTime: segmentView.time is undefined")}return i.time}},{key:"getSegmentList",value:function(k,j,B){var A=this.hls.levels[k.level];if(!A){throw new Error("getSegmentList: level doesn't exist")}if(!A.details){return[]}for(var z=[],y=A.details.fragments,x=0;x<y.length;x++){var w=y[x];j<=w.start&&w.start<=j+B&&z.push(new o["default"]({sn:w.sn,trackView:k,time:w.start}))}return z}},{key:"getNextSegmentView",value:function(F){var E=this.hls.levels[F.trackView.level],D=!1,C=!0,B=!1,A=void 0;try{for(var z,y=E.details.fragments[Symbol.iterator]();!(C=(z=y.next()).done);C=!0){var x=z.value;if(D){var w=new m["default"]({level:x.level});return new o["default"]({sn:x.sn,trackView:w,time:x.start})}x.sn===F.sn&&(D=!0)}}catch(j){B=!0,A=j}finally{try{!C&&y["return"]&&y["return"]()}finally{if(B){throw A}}}return null}},{key:"getTracksList",value:function(){if(!this.hls.levels){return[]}for(var j=[],i=0;i<this.hls.levels.length;i++){j.push(new m["default"]({level:i}))}return j}}]),c}();t["default"]=l,u.exports=t["default"]},{"./segment-view":2,"./track-view":3}],2:[function(t,s,r){function q(c){return c&&c.__esModule?c:{"default":c}}function p(i,c){if(!(i instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function c(B,A){var z=[],y=!0,x=!1,w=void 0;try{for(var v,u=B[Symbol.iterator]();!(y=(v=u.next()).done)&&(z.push(v.value),!A||z.length!==A);y=!0){}}catch(j){x=!0,w=j}finally{try{!y&&u["return"]&&u["return"]()}finally{if(x){throw w}}}return z}return function(i,j){if(Array.isArray(i)){return i}if(Symbol.iterator in Object(i)){return c(i,j)}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function c(j,i){for(var v=0;v<i.length;v++){var u=i[v];u.enumerable=u.enumerable||!1,u.configurable=!0,"value" in u&&(u.writable=!0),Object.defineProperty(j,u.key,u)}}return function(i,u,j){return u&&c(i.prototype,u),j&&c(i,j),i}}(),m=t("./track-view"),l=q(m),k=function(){function c(i){p(this,c),this.sn=i.sn,this.trackView=new l["default"](i.trackView),this.time=i.time}return n(c,null,[{key:"fromArrayBuffer",value:function(i){var w=new Uint32Array(i),v=o(w,2),u=v[0],j=v[1];return new c({trackView:new l["default"]({level:u}),sn:j})}}]),n(c,[{key:"isEqual",value:function(j){if(!j){return !1}var i=j.sn,u=j.trackView;return this.sn===i&&this.trackView.isEqual(u)}},{key:"isInTrack",value:function(i){return this.trackView.isEqual(i)}},{key:"viewToString",value:function(){return this.trackView.viewToString()+"S"+this.sn}},{key:"toArrayBuffer",value:function(){return new Uint32Array([this.trackView.level,this.sn]).buffer}}]),c}();r["default"]=k,s.exports=r["default"]},{"./track-view":3}],3:[function(j,i,n){function m(o,c){if(!(o instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function c(p,o){for(var r=0;r<o.length;r++){var q=o[r];q.enumerable=q.enumerable||!1,q.configurable=!0,"value" in q&&(q.writable=!0),Object.defineProperty(p,q.key,q)}}return function(o,q,p){return q&&c(o.prototype,q),p&&c(o,p),o}}(),k=function(){function c(o){m(this,c),this.level=o.level}return l(c,[{key:"viewToString",value:function(){return"L"+this.level}},{key:"isEqual",value:function(o){return o?o.level===this.level:!1}}]),c}();n["default"]=k,i.exports=n["default"]},{}],4:[function(J,I,H){function G(c){return c&&c.__esModule?c:{"default":c}}function F(i,c){if(!(i instanceof c)){throw new TypeError("Cannot call a class as a function")}}function E(i,c){if(!i){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!==("undefined"==typeof c?"undefined":C(c))&&"function"!=typeof c?i:c}function D(i,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":C(c)))}i.prototype=Object.create(c&&c.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(i,c):i.__proto__=c)}var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol?"symbol":typeof c};Object.defineProperty(H,"__esModule",{value:!0});var B=function(){function c(j,i){for(var l=0;l<i.length;l++){var k=i[l];k.enumerable=k.enumerable||!1,k.configurable=!0,"value" in k&&(k.writable=!0),Object.defineProperty(j,k.key,k)}}return function(i,k,j){return k&&c(i.prototype,k),j&&c(i,j),i}}(),A=function s(j,i,n){null===j&&(j=Function.prototype);var m=Object.getOwnPropertyDescriptor(j,i);if(void 0===m){var l=Object.getPrototypeOf(j);return null===l?void 0:s(l,i,n)}if("value" in m){return m.value}var k=m.get;return void 0===k?void 0:k.call(n)},z=J("./xhr-loader"),y=G(z),x=J("./mapping/segment-view"),w=G(x),v=J("./mapping/track-view"),u=G(v),t=function(c){return function(i){function j(l){F(this,j);var k=E(this,Object.getPrototypeOf(j).call(this));return l&&(k.withCredentials=!(!l.request||!l.request.withCredentials),k.headers=l.request&&l.request.headers?l.request.headers:[]),k}return D(j,i),B(j,[{key:"abort",value:function(){if(this.frag){var k=this.timeoutHandle;this.stats.aborted=!0,this.abortCallback&&this.abortCallback(),k&&window.clearTimeout(k)}else{A(Object.getPrototypeOf(j.prototype),"abort",this).call(this)}}},{key:"load",value:function(O,N,M,L,K,r,q,p){var o=arguments.length<=8||void 0===arguments[8]?null:arguments[8],n=arguments.length<=9||void 0===arguments[9]?null:arguments[9];if(n){if(!c.srModule){throw new Error("Streamroot module is not defined")}this.frag=n,A(Object.getPrototypeOf(j.prototype),"load",this).call(this,O,N,M,L,K,r,q,p,o)}else{A(Object.getPrototypeOf(j.prototype),"load",this).call(this,O,N,M,L,K,r,q,p,o)}}},{key:"loadSuccess",value:function(l,k){if(!this.stats.aborted){window.clearTimeout(this.timeoutHandle);var m={currentTarget:{response:l}};this.stats.tload=performance.now(),this.onSuccess(m,this.stats)}}},{key:"loadError",value:function(k){k.target.status,this.stats.aborted||(this.stats.retry<this.maxRetry?(this.destroy(),window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64000),this.stats.retry++):(window.clearTimeout(this.timeoutHandle),this.onError(k)))}},{key:"loadInternal",value:function(){if(this.frag){var k=this.headers;if(this.byteRange&&k.push(["Range",{start:this.frag.byteRangeStartOffset,end:this.frag.byteRangeEndOffset-1}]),this.stats.tfirst=null,this.stats.loaded=0,this.xhrSetup){throw new Error("xhrSetup setup is not usable with Streamroot version. Please contact Streamroot support")}var m=new u["default"]({level:this.frag.level}),l=new w["default"]({sn:this.frag.sn,trackView:m,time:this.frag.start});this.abortCallback=c.srModule.getSegment({url:this.url,headers:k,withCredentials:this.withCredentials},{onSuccess:this.loadSuccess.bind(this),onError:this.loadError.bind(this),onProgress:this.loadprogress.bind(this)},l)}else{A(Object.getPrototypeOf(j.prototype),"loadInternal",this).call(this)}}},{key:"loadprogress",value:function(l){if(this.frag){var k=0;if(l.cdnDownloaded&&(k+=l.cdnDownloaded),l.p2pDownloaded&&(k+=l.p2pDownloaded),this.stats.loaded=k,null===this.stats.tfirst){var n=performance.now();if(l.p2pDuration+l.cdnDuration>0&&l.p2pDownloaded>0){var m=l.p2pDuration+l.cdnDuration;this.stats.trequest=n-m,this.stats.tfirst=this.stats.trequest+Math.min(Math.round(m/2),10)}else{this.stats.tfirst=n}}this.onProgress&&this.onProgress(l,this.stats)}else{A(Object.getPrototypeOf(j.prototype),"loadprogress",this).call(this,l)}}}]),j}(y["default"])};H["default"]=t,I.exports=H["default"]},{"./mapping/segment-view":2,"./mapping/track-view":3,"./xhr-loader":8}],5:[function(B,A,z){function y(c){return c&&c.__esModule?c:{"default":c}}function x(i,c){if(!(i instanceof c)){throw new TypeError("Cannot call a class as a function")}}function w(i,c){if(!i){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return !c||"object"!==("undefined"==typeof c?"undefined":u(c))&&"function"!=typeof c?i:c}function v(i,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof c?"undefined":u(c)))}i.prototype=Object.create(c&&c.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(i,c):i.__proto__=c)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol?"symbol":typeof c};Object.defineProperty(z,"__esModule",{value:!0});var t=function(){function c(j,i){for(var l=0;l<i.length;l++){var k=i[l];k.enumerable=k.enumerable||!1,k.configurable=!0,"value" in k&&(k.writable=!0),Object.defineProperty(j,k.key,k)}}return function(i,k,j){return k&&c(i.prototype,k),j&&c(i,j),i}}(),s=B("events"),r=y(s),q=B("./mapping/track-view"),p=y(q),o=function(i){function c(j,n,m,l){x(this,c);var k=w(this,Object.getPrototypeOf(c).call(this));return k.hls=j,k.liveMinBufferMargin=m.liveMinBufferMargin||10,k.onDispose=l,k.hls.on(n.LEVEL_SWITCH,function(D,C){k.emit("onTrackChange",{video:new p["default"]({level:C.level})})}),k.hls.on(n.DESTROYING,function(){k.onDispose()}),k}return v(c,i),t(c,[{key:"isLive",value:function(){if(!this.hls.levels){throw new Error("Called isLive before the master playlist was parsed")}var k=!0,j=!1,D=void 0;try{for(var C,n=this.hls.levels[Symbol.iterator]();!(k=(C=n.next()).done);k=!0){var m=C.value;if(m.details){return !!m.details.live}}}catch(l){j=!0,D=l}finally{try{!k&&n["return"]&&n["return"]()}finally{if(j){throw D}}}throw new Error("Called isLive before any levelplaylist was parsed")}},{key:"getBufferLevelMax",value:function(){var k=void 0,j=void 0;if(this.hls.config.liveSyncDuration?(k="liveSyncDuration",j=this.hls.config.liveSyncDuration-this.liveMinBufferMargin):(k="maxBufferLength",j=this.hls.config.maxBufferLength-this.liveMinBufferMargin),0>j){throw Error("Invalid configuration: hlsjsConfig."+k+" must be greater than p2pConfig.liveMinBufferMargin")}return j}},{key:"setBufferMarginLive",value:function(j){this.hls.config.maxBufferSize=0,this.hls.config.maxBufferLength=j+this.liveMinBufferMargin}},{key:"addEventListener",value:function(k,j){"onTrackChange"===k&&this.on(k,j)}},{key:"removeEventListener",value:function(k,j){"onTrackChange"===k&&this.removeListener(k,j)}}]),c}(r["default"]);z["default"]=o,A.exports=z["default"]},{"./mapping/track-view":3,events:9}],6:[function(F,E,D){function C(c){return c&&c.__esModule?c:{"default":c}}function B(i,c){if(!(i instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(D,"__esModule",{value:!0});var A=function(){function c(j,i){for(var l=0;l<i.length;l++){var k=i[l];k.enumerable=k.enumerable||!1,k.configurable=!0,"value" in k&&(k.writable=!0),Object.defineProperty(j,k.key,k)}}return function(i,k,j){return k&&c(i.prototype,k),j&&c(i,j),i}}(),z=F("./playerInterface"),y=C(z),x=F("./mapping/media-map"),w=C(x),v=F("./mapping/segment-view"),u=C(v),t=F("./p2p-loader-factory"),s=C(t),r=F("./utils.js"),q=function(){function c(i){B(this,c),this.SRModule=i}return A(c,[{key:"createSRModule",value:function(j,i,o,n){var m=new y["default"](i,o,j,this.onDispose.bind(this)),l=new w["default"](i),k=(0,r.formatContentId)({contentUrl:i.url,contentId:n});this.srModule=new this.SRModule(m,k,l,j,u["default"])}},{key:"onDispose",value:function(){this.srModule.dispose()}},{key:"P2PLoader",get:function(){return(0,s["default"])(this)}}]),c}();D["default"]=q,E.exports=D["default"]},{"./mapping/media-map":1,"./mapping/segment-view":2,"./p2p-loader-factory":4,"./playerInterface":5,"./utils.js":7}],7:[function(j,i,o){function n(c){return c&&c.__esModule?c:{"default":c}}function m(q){var p=q.contentUrl,s=q.contentId;if(void 0!==s){if("string"==typeof s&&""!==s){return s}throw new TypeError("Content identifier needs to be a non-empty string")}var r=k["default"].parse(p,!0,!0);return r.host+r.pathname}Object.defineProperty(o,"__esModule",{value:!0}),o.formatContentId=void 0;var l=j("url"),k=n(l);o.formatContentId=m},{url:14}],8:[function(j,i,n){function m(o,c){if(!(o instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function c(p,o){for(var r=0;r<o.length;r++){var q=o[r];q.enumerable=q.enumerable||!1,q.configurable=!0,"value" in q&&(q.writable=!0),Object.defineProperty(p,q.key,q)}}return function(o,q,p){return q&&c(o.prototype,q),p&&c(o,p),o}}(),k=function(){function c(o){m(this,c),o&&o.xhrSetup&&(this.xhrSetup=o.xhrSetup)}return l(c,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var p=this.loader,o=this.timeoutHandle;p&&4!==p.readyState&&(this.stats.aborted=!0,p.abort()),o&&window.clearTimeout(o)}},{key:"load",value:function(x,w,v,u,t,s,r,q){var p=arguments.length<=8||void 0===arguments[8]?null:arguments[8],o=arguments.length<=9||void 0===arguments[9]?null:arguments[9];this.url=x,!o||isNaN(o.byteRangeStartOffset)||isNaN(o.byteRangeEndOffset)||(this.byteRange=o.byteRangeStartOffset+"-"+o.byteRangeEndOffset),this.responseType=w,this.onSuccess=v,this.onProgress=p,this.onTimeout=t,this.onError=u,this.stats={trequest:performance.now(),retry:0},this.timeout=s,this.maxRetry=r,this.retryDelay=q,this.timeoutHandle=window.setTimeout(this.loadtimeout.bind(this),s),this.loadInternal()}},{key:"loadInternal",value:function(){var o=this.loader=new XMLHttpRequest;o.onreadystatechange=this.statechange.bind(this),o.onprogress=this.loadprogress.bind(this),o.open("GET",this.url,!0),this.byteRange&&o.setRequestHeader("Range","bytes="+this.byteRange),o.responseType=this.responseType,this.stats.tfirst=null,this.stats.loaded=0,this.xhrSetup&&this.xhrSetup(o,this.url),o.send()}},{key:"statechange",value:function(p){var o=p.currentTarget,r=o.status,q=this.stats;q.aborted||4!==o.readyState||(r>=200&&300>r?(window.clearTimeout(this.timeoutHandle),q.tload=performance.now(),this.onSuccess(p,q)):q.retry<this.maxRetry?(this.destroy(),window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64000),q.retry++):(window.clearTimeout(this.timeoutHandle),this.onError(p)))}},{key:"loadtimeout",value:function(o){this.onTimeout(o,this.stats)}},{key:"loadprogress",value:function(p){var o=this.stats;null===o.tfirst&&(o.tfirst=performance.now()),o.loaded=p.loaded,this.onProgress&&this.onProgress(p,o)}}]),c}();n["default"]=k,i.exports=n["default"]},{}],9:[function(j,i,p){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(c){return"function"==typeof c}function m(c){return"number"==typeof c}function l(c){return"object"==typeof c&&null!==c}function k(c){return void 0===c}i.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(c){if(!m(c)||0>c||isNaN(c)){throw TypeError("n must be a positive number")}return this._maxListeners=c,this},o.prototype.emit=function(r){var q,w,v,u,t,s;if(this._events||(this._events={}),"error"===r&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if(q=arguments[1],q instanceof Error){throw q}throw TypeError('Uncaught, unspecified "error" event.')}if(w=this._events[r],k(w)){return !1}if(n(w)){switch(arguments.length){case 1:w.call(this);break;case 2:w.call(this,arguments[1]);break;case 3:w.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),w.apply(this,u)}}else{if(l(w)){for(u=Array.prototype.slice.call(arguments,1),s=w.slice(),v=s.length,t=0;v>t;t++){s[t].apply(this,u)}}}return !0},o.prototype.addListener=function(r,q){var s;if(!n(q)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",r,n(q.listener)?q.listener:q),this._events[r]?l(this._events[r])?this._events[r].push(q):this._events[r]=[this._events[r],q]:this._events[r]=q,l(this._events[r])&&!this._events[r].warned&&(s=k(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[r].length>s&&(this._events[r].warned=!0,"function"==typeof console.trace)),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(r,q){function t(){this.removeListener(r,t),s||(s=!0,q.apply(this,arguments))}if(!n(q)){throw TypeError("listener must be a function")}var s=!1;return t.listener=q,this.on(r,t),this},o.prototype.removeListener=function(r,q){var v,u,t,s;if(!n(q)){throw TypeError("listener must be a function")}if(!this._events||!this._events[r]){return this}if(v=this._events[r],t=v.length,u=-1,v===q||n(v.listener)&&v.listener===q){delete this._events[r],this._events.removeListener&&this.emit("removeListener",r,q)}else{if(l(v)){for(s=t;s-->0;){if(v[s]===q||v[s].listener&&v[s].listener===q){u=s;break}}if(0>u){return this}1===v.length?(v.length=0,delete this._events[r]):v.splice(u,1),this._events.removeListener&&this.emit("removeListener",r,q)}}return this},o.prototype.removeAllListeners=function(r){var q,s;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[r]&&delete this._events[r],this}if(0===arguments.length){for(q in this._events){"removeListener"!==q&&this.removeAllListeners(q)}return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[r],n(s)){this.removeListener(r,s)}else{if(s){for(;s.length;){this.removeListener(r,s[s.length-1])}}}return delete this._events[r],this},o.prototype.listeners=function(q){var c;return c=this._events&&this._events[q]?n(this._events[q])?[this._events[q]]:this._events[q].slice():[]},o.prototype.listenerCount=function(q){if(this._events){var c=this._events[q];if(n(c)){return 1}if(c){return c.length}}return 0},o.listenerCount=function(q,c){return q.listenerCount(c)}},{}],10:[function(i,k,j){(function(c){!function(au){function at(l){throw new RangeError(R[l])}function ar(m,l){for(var o=m.length,n=[];o--;){n[o]=l(m[o])}return n}function aq(m,l){var q=m.split("@"),p="";q.length>1&&(p=q[0]+"@",m=q[1]),m=m.replace(T,".");var o=m.split("."),n=ar(o,l).join(".");return p+n}function ap(m){for(var l,q,p=[],o=0,n=m.length;n>o;){l=m.charCodeAt(o++),l>=55296&&56319>=l&&n>o?(q=m.charCodeAt(o++),56320==(64512&q)?p.push(((1023&l)<<10)+(1023&q)+65536):(p.push(l),o--)):p.push(l)}return p}function ao(l){return ar(l,function(n){var m="";return n>65535&&(n-=65536,m+=M(n>>>10&1023|55296),n=56320|1023&n),m+=M(n)}).join("")}function an(l){return 10>l-48?l-22:26>l-65?l-65:26>l-97?l-97:S}function am(m,l){return m+22+75*(26>m)-((0!=l)<<5)}function al(m,l,o){var n=0;for(m=o?N(m/af):m>>1,m+=N(m/l);m>P*O>>1;n+=S){m=N(m/P)}return N(n+(P+1)*m/(m+ah))}function ak(G){var F,E,D,C,B,A,z,y,x,w,v=[],u=G.length,m=0,I=ab,H=ad;for(E=G.lastIndexOf(Z),0>E&&(E=0),D=0;E>D;++D){G.charCodeAt(D)>=128&&at("not-basic"),v.push(G.charCodeAt(D))}for(C=E>0?E+1:0;u>C;){for(B=m,A=1,z=S;C>=u&&at("invalid-input"),y=an(G.charCodeAt(C++)),(y>=S||y>N((U-m)/A))&&at("overflow"),m+=y*A,x=H>=z?Q:z>=H+O?O:z-H,!(x>y);z+=S){w=S-x,A>N(U/w)&&at("overflow"),A*=w}F=v.length+1,H=al(m-B,F,0==B),N(m/F)>U-I&&at("overflow"),I+=N(m/F),m%=F,v.splice(m++,0,I)}return ao(v)}function aj(G){var F,E,D,C,B,A,z,y,x,w,v,m,l,J,I,H=[];for(G=ap(G),m=G.length,F=ab,E=0,B=ad,A=0;m>A;++A){v=G[A],128>v&&H.push(M(v))}for(D=C=H.length,C&&H.push(Z);m>D;){for(z=U,A=0;m>A;++A){v=G[A],v>=F&&z>v&&(z=v)}for(l=D+1,z-F>N((U-E)/l)&&at("overflow"),E+=(z-F)*l,F=z,A=0;m>A;++A){if(v=G[A],F>v&&++E>U&&at("overflow"),v==F){for(y=E,x=S;w=B>=x?Q:x>=B+O?O:x-B,!(w>y);x+=S){I=y-w,J=S-w,H.push(M(am(w+I%J,0))),y=N(I/J)}H.push(M(am(y,0))),B=al(E,l,D==C),E=0,++D}}++E,++F}return H.join("")}function ai(l){return aq(l,function(m){return X.test(m)?ak(m.slice(4).toLowerCase()):m})}function ag(l){return aq(l,function(m){return V.test(m)?"xn--"+aj(m):m})}var ae="object"==typeof j&&j&&!j.nodeType&&j,ac="object"==typeof k&&k&&!k.nodeType&&k,aa="object"==typeof c&&c;(aa.global===aa||aa.window===aa||aa.self===aa)&&(au=aa);var Y,W,U=2147483647,S=36,Q=1,O=26,ah=38,af=700,ad=72,ab=128,Z="-",X=/^xn--/,V=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=S-Q,N=Math.floor,M=String.fromCharCode;if(Y={version:"1.4.1",ucs2:{decode:ap,encode:ao},decode:ak,encode:aj,toASCII:ag,toUnicode:ai},"function"==typeof g&&"object"==typeof g.amd&&g.amd){g("punycode",function(){return Y})}else{if(ae&&ac){if(k.exports==ae){ac.exports=Y}else{for(W in Y){Y.hasOwnProperty(W)&&(ae[W]=Y[W])}}}else{au.punycode=Y}}}(this)}).call(this,"undefined"!=typeof b?b:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(j,i,m){function l(n,c){return Object.prototype.hasOwnProperty.call(n,c)}i.exports=function(F,E,D,C){E=E||"&",D=D||"=";var B={};if("string"!=typeof F||0===F.length){return B}var A=/\+/g;F=F.split(E);var z=1000;C&&"number"==typeof C.maxKeys&&(z=C.maxKeys);var y=F.length;z>0&&y>z&&(y=z);for(var x=0;y>x;++x){var w,v,u,t,s=F[x].replace(A,"%20"),r=s.indexOf(D);r>=0?(w=s.substr(0,r),v=s.substr(r+1)):(w=s,v=""),u=decodeURIComponent(w),t=decodeURIComponent(v),l(B,u)?k(B[u])?B[u].push(t):B[u]=[B[u],t]:B[u]=t}return B};var k=Array.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)}},{}],12:[function(j,i,o){function n(q,p){if(q.map){return q.map(p)}for(var s=[],r=0;r<q.length;r++){s.push(p(q[r],r))}return s}var m=function(c){switch(typeof c){case"string":return c;case"boolean":return c?"true":"false";case"number":return isFinite(c)?c:"";default:return""}};i.exports=function(q,p,s,r){return p=p||"&",s=s||"=",null===q&&(q=void 0),"object"==typeof q?n(k(q),function(t){var c=encodeURIComponent(m(t))+s;return l(q[t])?n(q[t],function(u){return c+encodeURIComponent(m(u))}).join(p):c+encodeURIComponent(m(q[t]))}).join(p):r?encodeURIComponent(m(r))+s+encodeURIComponent(m(q)):""};var l=Array.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)},k=Object.keys||function(q){var p=[];for(var r in q){Object.prototype.hasOwnProperty.call(q,r)&&p.push(r)}return p}},{}],13:[function(j,i,k){k.decode=k.parse=j("./decode"),k.encode=k.stringify=j("./encode")},{"./decode":11,"./encode":12}],14:[function(X,W,V){function U(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function T(j,i,l){if(j&&O.isObject(j)&&j instanceof U){return j}var k=new U;return k.parse(j,i,l),k}function S(c){return O.isString(c)&&(c=T(c)),c instanceof U?c.format():U.prototype.format.call(c)}function R(i,c){return T(i,!1,!0).resolve(c)}function Q(i,c){return i?T(i,!1,!0).resolveObject(c):c}var P=X("punycode"),O=X("./util");V.parse=T,V.resolve=R,V.resolveObject=Q,V.format=S,V.Url=U;var N=/^([a-z0-9.+-]+:)/i,M=/:[0-9]*$/,L=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,K=["<",">",'"',"`"," ","\r","\n","	"],J=["{","}","|","\\","^","`"].concat(K),I=["'"].concat(J),H=["%","/","?",";","#"].concat(I),G=["/","?","#"],F=255,E=/^[+a-z0-9A-Z_-]{0,63}$/,D=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},B={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},z=X("querystring");U.prototype.parse=function(ar,aq,ap){if(!O.isString(ar)){throw new TypeError("Parameter 'url' must be a string, not "+typeof ar)}var ao=ar.indexOf("?"),an=-1!==ao&&ao<ar.indexOf("#")?"?":"#",am=ar.split(an),al=/\\/g;am[0]=am[0].replace(al,"/"),ar=am.join(an);var ak=ar;if(ak=ak.trim(),!ap&&1===ar.split("#").length){var aj=L.exec(ak);if(aj){return this.path=ak,this.href=ak,this.pathname=aj[1],aj[2]?(this.search=aj[2],aq?this.query=z.parse(this.search.substr(1)):this.query=this.search.substr(1)):aq&&(this.search="",this.query={}),this}}var ai=N.exec(ak);if(ai){ai=ai[0];var ah=ai.toLowerCase();this.protocol=ah,ak=ak.substr(ai.length)}if(ap||ai||ak.match(/^\/\/[^@\/]+@[^@\/]+/)){var x="//"===ak.substr(0,2);!x||ai&&B[ai]||(ak=ak.substr(2),this.slashes=!0)}if(!B[ai]&&(x||ai&&!A[ai])){for(var ag=-1,af=0;af<G.length;af++){var ae=ak.indexOf(G[af]);-1!==ae&&(-1===ag||ag>ae)&&(ag=ae)}var ad,ac;ac=-1===ag?ak.lastIndexOf("@"):ak.lastIndexOf("@",ag),-1!==ac&&(ad=ak.slice(0,ac),ak=ak.slice(ac+1),this.auth=decodeURIComponent(ad)),ag=-1;for(var af=0;af<H.length;af++){var ae=ak.indexOf(H[af]);-1!==ae&&(-1===ag||ag>ae)&&(ag=ae)}-1===ag&&(ag=ak.length),this.host=ak.slice(0,ag),ak=ak.slice(ag),this.parseHost(),this.hostname=this.hostname||"";var ab="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ab){for(var aa=this.hostname.split(/\./),af=0,Z=aa.length;Z>af;af++){var Y=aa[af];if(Y&&!Y.match(E)){for(var y="",w=0,v=Y.length;v>w;w++){y+=Y.charCodeAt(w)>127?"x":Y[w]}if(!y.match(E)){var u=aa.slice(0,af),t=aa.slice(af+1),s=Y.match(D);s&&(u.push(s[1]),t.unshift(s[2])),t.length&&(ak="/"+t.join(".")+ak),this.hostname=u.join(".");break}}}}this.hostname.length>F?this.hostname="":this.hostname=this.hostname.toLowerCase(),ab||(this.hostname=P.toASCII(this.hostname));var r=this.port?":"+this.port:"",q=this.hostname||"";this.host=q+r,this.href+=this.host,ab&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==ak[0]&&(ak="/"+ak))}if(!C[ah]){for(var af=0,Z=I.length;Z>af;af++){var p=I[af];if(-1!==ak.indexOf(p)){var m=encodeURIComponent(p);m===p&&(m=escape(p)),ak=ak.split(p).join(m)}}}var k=ak.indexOf("#");-1!==k&&(this.hash=ak.substr(k),ak=ak.slice(0,k));var j=ak.indexOf("?");if(-1!==j?(this.search=ak.substr(j),this.query=ak.substr(j+1),aq&&(this.query=z.parse(this.query)),ak=ak.slice(0,j)):aq&&(this.search="",this.query={}),ak&&(this.pathname=ak),A[ah]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var r=this.pathname||"",i=this.search||"";this.path=r+i}return this.href=this.format(),this},U.prototype.format=function(){var j=this.auth||"";j&&(j=encodeURIComponent(j),j=j.replace(/%3A/i,":"),j+="@");var i=this.protocol||"",o=this.pathname||"",n=this.hash||"",m=!1,l="";this.host?m=j+this.host:this.hostname&&(m=j+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(m+=":"+this.port)),this.query&&O.isObject(this.query)&&Object.keys(this.query).length&&(l=z.stringify(this.query));var k=this.search||l&&"?"+l||"";return i&&":"!==i.substr(-1)&&(i+=":"),this.slashes||(!i||A[i])&&m!==!1?(m="//"+(m||""),o&&"/"!==o.charAt(0)&&(o="/"+o)):m||(m=""),n&&"#"!==n.charAt(0)&&(n="#"+n),k&&"?"!==k.charAt(0)&&(k="?"+k),o=o.replace(/[?#]/g,function(c){return encodeURIComponent(c)}),k=k.replace("#","%23"),i+m+o+k+n},U.prototype.resolve=function(c){return this.resolveObject(T(c,!1,!0)).format()},U.prototype.resolveObject=function(aw){if(O.isString(aw)){var av=new U;av.parse(aw,!1,!0),aw=av}for(var au=new U,at=Object.keys(this),ar=0;ar<at.length;ar++){var aq=at[ar];au[aq]=this[aq]}if(au.hash=aw.hash,""===aw.href){return au.href=au.format(),au}if(aw.slashes&&!aw.protocol){for(var ap=Object.keys(aw),ao=0;ao<ap.length;ao++){var an=ap[ao];"protocol"!==an&&(au[an]=aw[an])}return A[au.protocol]&&au.hostname&&!au.pathname&&(au.path=au.pathname="/"),au.href=au.format(),au}if(aw.protocol&&aw.protocol!==au.protocol){if(!A[aw.protocol]){for(var am=Object.keys(aw),al=0;al<am.length;al++){var ak=am[al];au[ak]=aw[ak]}return au.href=au.format(),au}if(au.protocol=aw.protocol,aw.host||B[aw.protocol]){au.pathname=aw.pathname}else{for(var aj=(aw.pathname||"").split("/");aj.length&&!(aw.host=aj.shift());){}aw.host||(aw.host=""),aw.hostname||(aw.hostname=""),""!==aj[0]&&aj.unshift(""),aj.length<2&&aj.unshift(""),au.pathname=aj.join("/")}if(au.search=aw.search,au.query=aw.query,au.host=aw.host||"",au.auth=aw.auth,au.hostname=aw.hostname||aw.host,au.port=aw.port,au.pathname||au.search){var ai=au.pathname||"",ag=au.search||"";au.path=ai+ag}return au.slashes=au.slashes||aw.slashes,au.href=au.format(),au}var ae=au.pathname&&"/"===au.pathname.charAt(0),ac=aw.host||aw.pathname&&"/"===aw.pathname.charAt(0),aa=ac||ae||au.host&&aw.pathname,Y=aa,x=au.pathname&&au.pathname.split("/")||[],aj=aw.pathname&&aw.pathname.split("/")||[],w=au.protocol&&!A[au.protocol];if(w&&(au.hostname="",au.port=null,au.host&&(""===x[0]?x[0]=au.host:x.unshift(au.host)),au.host="",aw.protocol&&(aw.hostname=null,aw.port=null,aw.host&&(""===aj[0]?aj[0]=aw.host:aj.unshift(aw.host)),aw.host=null),aa=aa&&(""===aj[0]||""===x[0])),ac){au.host=aw.host||""===aw.host?aw.host:au.host,au.hostname=aw.hostname||""===aw.hostname?aw.hostname:au.hostname,au.search=aw.search,au.query=aw.query,x=aj}else{if(aj.length){x||(x=[]),x.pop(),x=x.concat(aj),au.search=aw.search,au.query=aw.query}else{if(!O.isNullOrUndefined(aw.search)){if(w){au.hostname=au.host=x.shift();var j=au.host&&au.host.indexOf("@")>0?au.host.split("@"):!1;j&&(au.auth=j.shift(),au.host=au.hostname=j.shift())}return au.search=aw.search,au.query=aw.query,O.isNull(au.pathname)&&O.isNull(au.search)||(au.path=(au.pathname?au.pathname:"")+(au.search?au.search:"")),au.href=au.format(),au}}}if(!x.length){return au.pathname=null,au.search?au.path="/"+au.search:au.path=null,au.href=au.format(),au}for(var ah=x.slice(-1)[0],af=(au.host||aw.host||x.length>1)&&("."===ah||".."===ah)||""===ah,ad=0,ab=x.length;ab>=0;ab--){ah=x[ab],"."===ah?x.splice(ab,1):".."===ah?(x.splice(ab,1),ad++):ad&&(x.splice(ab,1),ad--)}if(!aa&&!Y){for(;ad--;ad){x.unshift("..")}}!aa||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),af&&"/"!==x.join("/").substr(-1)&&x.push("");var Z=""===x[0]||x[0]&&"/"===x[0].charAt(0);if(w){au.hostname=au.host=Z?"":x.length?x.shift():"";var j=au.host&&au.host.indexOf("@")>0?au.host.split("@"):!1;j&&(au.auth=j.shift(),au.host=au.hostname=j.shift())}return aa=aa||au.host&&x.length,aa&&!Z&&x.unshift(""),x.length?au.pathname=x.join("/"):(au.pathname=null,au.path=null),O.isNull(au.pathname)&&O.isNull(au.search)||(au.path=(au.pathname?au.pathname:"")+(au.search?au.search:"")),au.auth=aw.auth||au.auth,au.slashes=au.slashes||aw.slashes,au.href=au.format(),au},U.prototype.parseHost=function(){var i=this.host,c=M.exec(i);c&&(c=c[0],":"!==c&&(this.port=c.substr(1)),i=i.substr(0,i.length-c.length)),i&&(this.hostname=i)}},{"./util":15,punycode:10,querystring:13}],15:[function(j,i,k){i.exports={isString:function(c){return"string"==typeof c},isObject:function(c){return"object"==typeof c&&null!==c},isNull:function(c){return null===c},isNullOrUndefined:function(c){return null==c}}},{}]},{},[6])(6)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],203:[function(f,e,h){var g=[].indexOf;e.exports=function(i,d){if(g){return i.indexOf(d)}for(var j=0;j<i.length;++j){if(i[j]===d){return j}}return -1}},{}],204:[function(e,d,f){d.exports=Array.isArray||function(b){return"[object Array]"==Object.prototype.toString.call(b)}},{}],205:[function(e,d,f){!function(ay){function ax(s){if(ax[s]!==au){return ax[s]}var r;if("bug-string-char-index"==s){r="a"!="a"[0]}else{if("json"==s){r=ax("json-stringify")&&ax("json-parse")}else{var q,p='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==s){var o=ap.stringify,k="function"==typeof o&&ao;if(k){(q=function(){return 1}).toJSON=q;try{k="0"===o(0)&&"0"===o(new Number)&&'""'==o(new String)&&o(at)===au&&o(au)===au&&o()===au&&"1"===o(q)&&"[1]"==o([q])&&"[null]"==o([au])&&"null"==o(null)&&"[null,null,null]"==o([au,at,null])&&o({a:[q,!0,!1,null,"\x00\b\n\f\r	"]})==p&&"1"===o(null,q)&&"[\n 1,\n 2\n]"==o([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==o(new Date(-8640000000000000))&&'"+275760-09-13T00:00:00.000Z"'==o(new Date(8640000000000000))&&'"-000001-01-01T00:00:00.000Z"'==o(new Date(-62198755200000))&&'"1969-12-31T23:59:59.999Z"'==o(new Date(-1))}catch(j){k=!1}}r=k}if("json-parse"==s){var g=ap.parse;if("function"==typeof g){try{if(0===g("0")&&!g(!1)){q=g(p);var b=5==q.a.length&&1===q.a[0];if(b){try{b=!g('"	"')}catch(j){}if(b){try{b=1!==g("01")}catch(j){}}if(b){try{b=1!==g("1.")}catch(j){}}}}}catch(j){b=!1}}r=b}}}return ax[s]=!!r}var aw,av,au,at={}.toString,ar="function"==typeof define&&define.amd,aq="object"==typeof JSON&&JSON,ap="object"==typeof f&&f&&!f.nodeType&&f;ap&&aq?(ap.stringify=aq.stringify,ap.parse=aq.parse):ap=ay.JSON=aq||{};var ao=new Date(-3509827334573292);try{ao=-109252==ao.getUTCFullYear()&&0===ao.getUTCMonth()&&1===ao.getUTCDate()&&10==ao.getUTCHours()&&37==ao.getUTCMinutes()&&6==ao.getUTCSeconds()&&708==ao.getUTCMilliseconds()}catch(an){}if(!ax("json")){var am="[object Function]",al="[object Date]",ak="[object Number]",aj="[object String]",ai="[object Array]",ah="[object Boolean]",ag=ax("bug-string-char-index");if(!ao){var af=Math.floor,ae=[0,31,59,90,120,151,181,212,243,273,304,334],ad=function(h,g){return ae[g]+365*(h-1970)+af((h-1969+(g=+(g>1)))/4)-af((h-1901+g)/100)+af((h-1601+g)/400)}}(aw={}.hasOwnProperty)||(aw=function(h){var g,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=at?aw=function(k){var j=this.__proto__,l=k in (this.__proto__=null,this);return this.__proto__=j,l}:(g=i.constructor,aw=function(b){var j=(this.constructor||g).prototype;return b in this&&!(b in j&&this[b]===j[b])}),i=null,aw.call(this,h)});var ac={"boolean":1,number:1,string:1,undefined:1},ab=function(h,g){var i=typeof h[g];return"object"==i?!!h[g]:!ac[i]};if(av=function(j,g){var n,m,l,k=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,m=new n;for(l in m){aw.call(m,l)&&k++}return n=m=null,k?av=2==k?function(i,h){var q,p={},o=at.call(i)==am;for(q in i){o&&"prototype"==q||aw.call(p,q)||!(p[q]=1)||!aw.call(i,q)||h(q)}}:function(i,h){var q,p,o=at.call(i)==am;for(q in i){o&&"prototype"==q||!aw.call(i,q)||(p="constructor"===q)||h(q)}(p||aw.call(i,q="constructor"))&&h(q)}:(m=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],av=function(p,o){var t,s,r=at.call(p)==am,q=!r&&"function"!=typeof p.constructor&&ab(p,"hasOwnProperty")?p.hasOwnProperty:aw;for(t in p){r&&"prototype"==t||!q.call(p,t)||o(t)}for(s=m.length;t=m[--s];q.call(p,t)&&o(t)){}}),av(j,g)},!ax("json-stringify")){var aa={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},Z="000000",Y=function(h,g){return(Z+(g||0)).slice(-h)},X="\\u00",W=function(i){var h,n='"',m=0,l=i.length,k=l>10&&ag;for(k&&(h=i.split(""));l>m;m++){var j=i.charCodeAt(m);switch(j){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=aa[j];break;default:if(32>j){n+=X+Y(2,j.toString(16));break}n+=k?h[m]:ag?i.charAt(m):i[m]}}return n+'"'},V=function(aK,aJ,aI,aH,aG,aF,aE){var aD,aC,aA,M,A,t,q,o,aB,az,D,C,v,r,p,n;try{aD=aJ[aK]}catch(g){}if("object"==typeof aD&&aD){if(aC=at.call(aD),aC!=al||aw.call(aD,"toJSON")){"function"==typeof aD.toJSON&&(aC!=ak&&aC!=aj&&aC!=ai||aw.call(aD,"toJSON"))&&(aD=aD.toJSON(aK))}else{if(aD>-1/0&&1/0>aD){if(ad){for(A=af(aD/86400000),aA=af(A/365.2425)+1970-1;ad(aA+1,0)<=A;aA++){}for(M=af((A-ad(aA,0))/30.42);ad(aA,M+1)<=A;M++){}A=1+A-ad(aA,M),t=(aD%86400000+86400000)%86400000,q=af(t/3600000)%24,o=af(t/60000)%60,aB=af(t/1000)%60,az=t%1000}else{aA=aD.getUTCFullYear(),M=aD.getUTCMonth(),A=aD.getUTCDate(),q=aD.getUTCHours(),o=aD.getUTCMinutes(),aB=aD.getUTCSeconds(),az=aD.getUTCMilliseconds()}aD=(0>=aA||aA>=10000?(0>aA?"-":"+")+Y(6,0>aA?-aA:aA):Y(4,aA))+"-"+Y(2,M+1)+"-"+Y(2,A)+"T"+Y(2,q)+":"+Y(2,o)+":"+Y(2,aB)+"."+Y(3,az)+"Z"}else{aD=null}}}if(aI&&(aD=aI.call(aJ,aK,aD)),null===aD){return"null"}if(aC=at.call(aD),aC==ah){return""+aD}if(aC==ak){return aD>-1/0&&1/0>aD?""+aD:"null"}if(aC==aj){return W(""+aD)}if("object"==typeof aD){for(r=aE.length;r--;){if(aE[r]===aD){throw TypeError()}}if(aE.push(aD),D=[],p=aF,aF+=aG,aC==ai){for(v=0,r=aD.length;r>v;v++){C=V(v,aD,aI,aH,aG,aF,aE),D.push(C===au?"null":C)}n=D.length?aG?"[\n"+aF+D.join(",\n"+aF)+"\n"+p+"]":"["+D.join(",")+"]":"[]"}else{av(aH||aD,function(i){var h=V(i,aD,aI,aH,aG,aF,aE);h!==au&&D.push(W(i)+":"+(aG?" ":"")+h)}),n=D.length?aG?"{\n"+aF+D.join(",\n"+aF)+"\n"+p+"}":"{"+D.join(",")+"}":"{}"}return aE.pop(),n}};ap.stringify=function(t,s,r){var q,p,o,n;if("function"==typeof s||"object"==typeof s&&s){if((n=at.call(s))==am){p=s}else{if(n==ai){o={};for(var m,l=0,g=s.length;g>l;m=s[l++],n=at.call(m),(n==aj||n==ak)&&(o[m]=1)){}}}}if(r){if((n=at.call(r))==ak){if((r-=r%1)>0){for(q="",r>10&&(r=10);q.length<r;q+=" "){}}}else{n==aj&&(q=r.length<=10?r:r.slice(0,10))}}return V("",(m={},m[""]=t,m),p,o,q,"",[])}}if(!ax("json-parse")){var U,T,S=String.fromCharCode,R={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},Q=function(){throw U=T=null,SyntaxError()},P=function(){for(var i,h,n,m,l,k=T,j=k.length;j>U;){switch(l=k.charCodeAt(U)){case 9:case 10:case 13:case 32:U++;break;case 123:case 125:case 91:case 93:case 58:case 44:return i=ag?k.charAt(U):k[U],U++,i;case 34:for(i="@",U++;j>U;){if(l=k.charCodeAt(U),32>l){Q()}else{if(92==l){switch(l=k.charCodeAt(++U)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:i+=R[l],U++;break;case 117:for(h=++U,n=U+4;n>U;U++){l=k.charCodeAt(U),l>=48&&57>=l||l>=97&&102>=l||l>=65&&70>=l||Q()}i+=S("0x"+k.slice(h,U));break;default:Q()}}else{if(34==l){break}for(l=k.charCodeAt(U),h=U;l>=32&&92!=l&&34!=l;){l=k.charCodeAt(++U)}i+=k.slice(h,U)}}}if(34==k.charCodeAt(U)){return U++,i}Q();default:if(h=U,45==l&&(m=!0,l=k.charCodeAt(++U)),l>=48&&57>=l){for(48==l&&(l=k.charCodeAt(U+1),l>=48&&57>=l)&&Q(),m=!1;j>U&&(l=k.charCodeAt(U),l>=48&&57>=l);U++){}if(46==k.charCodeAt(U)){for(n=++U;j>n&&(l=k.charCodeAt(n),l>=48&&57>=l);n++){}n==U&&Q(),U=n}if(l=k.charCodeAt(U),101==l||69==l){for(l=k.charCodeAt(++U),(43==l||45==l)&&U++,n=U;j>n&&(l=k.charCodeAt(n),l>=48&&57>=l);n++){}n==U&&Q(),U=n}return +k.slice(h,U)}if(m&&Q(),"true"==k.slice(U,U+4)){return U+=4,!0}if("false"==k.slice(U,U+5)){return U+=5,!1}if("null"==k.slice(U,U+4)){return U+=4,null}Q()}}return"$"},O=function(h){var g,i;if("$"==h&&Q(),"string"==typeof h){if("@"==(ag?h.charAt(0):h[0])){return h.slice(1)}if("["==h){for(g=[];h=P(),"]"!=h;i||(i=!0)){i&&(","==h?(h=P(),"]"==h&&Q()):Q()),","==h&&Q(),g.push(O(h))}return g}if("{"==h){for(g={};h=P(),"}"!=h;i||(i=!0)){i&&(","==h?(h=P(),"}"==h&&Q()):Q()),(","==h||"string"!=typeof h||"@"!=(ag?h.charAt(0):h[0])||":"!=P())&&Q(),g[h.slice(1)]=O(P())}return g}Q()}return h},N=function(h,g,j){var i=c(h,g,j);i===au?delete h[g]:h[g]=i},c=function(h,g,k){var j,i=h[g];if("object"==typeof i&&i){if(at.call(i)==ai){for(j=i.length;j--;){N(i,j,k)}}else{av(i,function(b){N(i,b,k)})}}return k.call(h,g,i)};ap.parse=function(h,g){var j,i;return U=0,T=""+h,j=O(P()),"$"!=P()&&Q(),U=T=null,g&&at.call(g)==am?c((i={},i[""]=j,i),"",g):j}}}ar&&define(function(){return ap})}(this)},{}],206:[function(f,e,h){var g=Object.prototype.hasOwnProperty;h.keys=Object.keys||function(i){var d=[];for(var j in i){g.call(i,j)&&d.push(j)}return d},h.values=function(i){var d=[];for(var j in i){g.call(i,j)&&d.push(i[j])}return d},h.merge=function(i,d){for(var j in d){g.call(d,j)&&(i[j]=d[j])}return i},h.length=function(b){return h.keys(b).length},h.isEmpty=function(b){return 0==h.length(b)}},{}],207:[function(e,d,f){(function(b){var n=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,k=/(?:^|:|,)(?:\s*\[)+/g,j=/^\s+/,i=/\s+$/;d.exports=function(c){return"string"==typeof c&&c?(c=c.replace(j,"").replace(i,""),b.JSON&&JSON.parse?JSON.parse(c):n.test(c.replace(m,"@").replace(l,"]").replace(k,""))?new Function("return "+c)():void 0):null}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],208:[function(e,d,f){f.encode=function(h){var g="";for(var i in h){h.hasOwnProperty(i)&&(g.length&&(g+="&"),g+=encodeURIComponent(i)+"="+encodeURIComponent(h[i]))}return g},f.decode=function(h){for(var g={},l=h.split("&"),k=0,j=l.length;j>k;k++){var i=l[k].split("=");g[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return g}},{}],209:[function(e,d,f){d.exports=e("./lib/")},{"./lib/":210}],210:[function(r,q,p){function o(g,e){"object"==typeof g&&(e=g,g=void 0),e=e||{};var t,s=n(g),i=s.source,h=s.id;return e.forceNew||e["force new connection"]||!1===e.multiplex?(k("ignoring socket cache for %s",i),t=l(i,e)):(j[h]||(k("new io instance for %s",i),j[h]=l(i,e)),t=j[h]),t.socket(s.path)}var n=r("./url"),m=r("socket.io-parser"),l=r("./manager"),k=r("debug")("socket.io-client");q.exports=p=o;var j=p.managers={};p.protocol=m.protocol,p.connect=o,p.Manager=r("./manager"),p.Socket=r("./socket")},{"./manager":211,"./socket":213,"./url":214,debug:216,"socket.io-parser":239}],211:[function(z,y,x){function w(d,c){return this instanceof w?(d&&"object"==typeof d&&(c=d,d=void 0),c=c||{},c.path=c.path||"/socket.io",this.nsps={},this.subs=[],this.opts=c,this.reconnection(c.reconnection!==!1),this.reconnectionAttempts(c.reconnectionAttempts||1/0),this.reconnectionDelay(c.reconnectionDelay||1000),this.reconnectionDelayMax(c.reconnectionDelayMax||5000),this.randomizationFactor(c.randomizationFactor||0.5),this.backoff=new n({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==c.timeout?20000:c.timeout),this.readyState="closed",this.uri=d,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=c.autoConnect!==!1,void (this.autoConnect&&this.open())):new w(d,c)}var v=(z("./url"),z("engine.io-client")),u=z("./socket"),t=z("component-emitter"),s=z("socket.io-parser"),r=z("./on"),q=z("component-bind"),p=(z("object-component"),z("debug")("socket.io-client:manager")),o=z("indexof"),n=z("backo2");y.exports=w,w.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var b in this.nsps){this.nsps[b].emit.apply(this.nsps[b],arguments)}},w.prototype.updateSocketIds=function(){for(var b in this.nsps){this.nsps[b].id=this.engine.id}},t(w.prototype),w.prototype.reconnection=function(b){return arguments.length?(this._reconnection=!!b,this):this._reconnection},w.prototype.reconnectionAttempts=function(b){return arguments.length?(this._reconnectionAttempts=b,this):this._reconnectionAttempts},w.prototype.reconnectionDelay=function(b){return arguments.length?(this._reconnectionDelay=b,this.backoff&&this.backoff.setMin(b),this):this._reconnectionDelay},w.prototype.randomizationFactor=function(b){return arguments.length?(this._randomizationFactor=b,this.backoff&&this.backoff.setJitter(b),this):this._randomizationFactor},w.prototype.reconnectionDelayMax=function(b){return arguments.length?(this._reconnectionDelayMax=b,this.backoff&&this.backoff.setMax(b),this):this._reconnectionDelayMax},w.prototype.timeout=function(b){return arguments.length?(this._timeout=b,this):this._timeout},w.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},w.prototype.open=w.prototype.connect=function(i){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open")){return this}p("opening %s",this.uri),this.engine=v(this.uri,this.opts);var e=this.engine,A=this;this.readyState="opening",this.skipReconnect=!1;var m=r(e,"open",function(){A.onopen(),i&&i()}),l=r(e,"error",function(c){if(p("connect_error"),A.cleanup(),A.readyState="closed",A.emitAll("connect_error",c),i){var f=new Error("Connection error");f.data=c,i(f)}else{A.maybeReconnectOnOpen()}});if(!1!==this._timeout){var k=this._timeout;p("connect attempt will timeout after %d",k);var j=setTimeout(function(){p("connect attempt timed out after %d",k),m.destroy(),e.close(),e.emit("error","timeout"),A.emitAll("connect_timeout",k)},k);this.subs.push({destroy:function(){clearTimeout(j)}})}return this.subs.push(m),this.subs.push(l),this},w.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var b=this.engine;this.subs.push(r(b,"data",q(this,"ondata"))),this.subs.push(r(this.decoder,"decoded",q(this,"ondecoded"))),this.subs.push(r(b,"error",q(this,"onerror"))),this.subs.push(r(b,"close",q(this,"onclose")))},w.prototype.ondata=function(b){this.decoder.add(b)},w.prototype.ondecoded=function(b){this.emit("packet",b)},w.prototype.onerror=function(b){p("error",b),this.emitAll("error",b)},w.prototype.socket=function(e){var d=this.nsps[e];if(!d){d=new u(this,e),this.nsps[e]=d;var f=this;d.on("connect",function(){d.id=f.engine.id,~o(f.connected,d)||f.connected.push(d)})}return d},w.prototype.destroy=function(d){var c=o(this.connected,d);~c&&this.connected.splice(c,1),this.connected.length||this.close()},w.prototype.packet=function(d){p("writing packet %j",d);var c=this;c.encoding?c.packetBuffer.push(d):(c.encoding=!0,this.encoder.encode(d,function(b){for(var e=0;e<b.length;e++){c.engine.write(b[e])}c.encoding=!1,c.processPacketQueue()}))},w.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var b=this.packetBuffer.shift();this.packet(b)}},w.prototype.cleanup=function(){for(var b;b=this.subs.shift();){b.destroy()}this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},w.prototype.close=w.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},w.prototype.onclose=function(b){p("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",b),this._reconnection&&!this.skipReconnect&&this.reconnect()},w.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect){return this}var e=this;if(this.backoff.attempts>=this._reconnectionAttempts){p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1}else{var d=this.backoff.duration();p("will wait %dms before reconnect attempt",d),this.reconnecting=!0;var f=setTimeout(function(){e.skipReconnect||(p("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(c){c?(p("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",c.data)):(p("reconnect success"),e.onreconnect())}))},d);this.subs.push({destroy:function(){clearTimeout(f)}})}},w.prototype.onreconnect=function(){var b=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",b)}},{"./on":212,"./socket":213,"./url":214,backo2:64,"component-bind":66,"component-emitter":67,debug:216,"engine.io-client":217,indexof:203,"object-component":206,"socket.io-parser":239}],212:[function(f,e,h){function g(i,d,j){return i.on(d,j),{destroy:function(){i.removeListener(d,j)}}}e.exports=g},{}],213:[function(z,y,x){function w(d,c){this.io=d,this.nsp=c,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var v=z("socket.io-parser"),u=z("component-emitter"),t=z("to-array"),s=z("./on"),r=z("component-bind"),q=z("debug")("socket.io-client:socket"),p=z("has-binary");y.exports=x=w;var o={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},n=u.prototype.emit;u(w.prototype),w.prototype.subEvents=function(){if(!this.subs){var b=this.io;this.subs=[s(b,"open",r(this,"onopen")),s(b,"packet",r(this,"onpacket")),s(b,"close",r(this,"onclose"))]}},w.prototype.open=w.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},w.prototype.send=function(){var b=t(arguments);return b.unshift("message"),this.emit.apply(this,b),this},w.prototype.emit=function(f){if(o.hasOwnProperty(f)){return n.apply(this,arguments),this}var e=t(arguments),h=v.EVENT;p(e)&&(h=v.BINARY_EVENT);var g={type:h,data:e};return"function"==typeof e[e.length-1]&&(q("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),g.id=this.ids++),this.connected?this.packet(g):this.sendBuffer.push(g),this},w.prototype.packet=function(b){b.nsp=this.nsp,this.io.packet(b)},w.prototype.onopen=function(){q("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:v.CONNECT})},w.prototype.onclose=function(b){q("close (%s)",b),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",b)},w.prototype.onpacket=function(b){if(b.nsp==this.nsp){switch(b.type){case v.CONNECT:this.onconnect();break;case v.EVENT:this.onevent(b);break;case v.BINARY_EVENT:this.onevent(b);break;case v.ACK:this.onack(b);break;case v.BINARY_ACK:this.onack(b);break;case v.DISCONNECT:this.ondisconnect();break;case v.ERROR:this.emit("error",b.data)}}},w.prototype.onevent=function(d){var c=d.data||[];q("emitting event %j",c),null!=d.id&&(q("attaching ack callback to event"),c.push(this.ack(d.id))),this.connected?n.apply(this,c):this.receiveBuffer.push(c)},w.prototype.ack=function(e){var d=this,f=!1;return function(){if(!f){f=!0;var c=t(arguments);q("sending ack %j",c);var b=p(c)?v.BINARY_ACK:v.ACK;d.packet({type:b,id:e,data:c})}}},w.prototype.onack=function(d){q("calling ack %s with %j",d.id,d.data);var c=this.acks[d.id];c.apply(this,d.data),delete this.acks[d.id]},w.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},w.prototype.emitBuffered=function(){var b;for(b=0;b<this.receiveBuffer.length;b++){n.apply(this,this.receiveBuffer[b])}for(this.receiveBuffer=[],b=0;b<this.sendBuffer.length;b++){this.packet(this.sendBuffer[b])}this.sendBuffer=[]},w.prototype.ondisconnect=function(){q("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},w.prototype.destroy=function(){if(this.subs){for(var b=0;b<this.subs.length;b++){this.subs[b].destroy()}this.subs=null}this.io.destroy(this)},w.prototype.close=w.prototype.disconnect=function(){return this.connected&&(q("performing disconnect (%s)",this.nsp),this.packet({type:v.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":212,"component-bind":66,"component-emitter":67,debug:216,"has-binary":232,"socket.io-parser":239,"to-array":336}],214:[function(e,d,f){(function(i){function h(j,c){var k=j,c=c||i.location;return null==j&&(j=c.protocol+"//"+c.host),"string"==typeof j&&("/"==j.charAt(0)&&(j="/"==j.charAt(1)?c.protocol+j:c.hostname+j),/^(https?|wss?):\/\//.test(j)||(b("protocol-less url %s",j),j="undefined"!=typeof c?c.protocol+"//"+j:"https://"+j),b("parse %s",j),k=g(j)),k.port||(/^(http|ws)$/.test(k.protocol)?k.port="80":/^(http|ws)s$/.test(k.protocol)&&(k.port="443")),k.path=k.path||"/",k.id=k.protocol+"://"+k.host+":"+k.port,k.href=k.protocol+"://"+k.host+(c&&c.port==k.port?"":":"+k.port),k}var g=e("parseuri"),b=e("debug")("socket.io-client:url");d.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:216,parseuri:235}],215:[function(e,d,f){(function(b){function j(l,k){k=k||{};for(var n=new i,m=0;m<l.length;m++){n.append(l[m])}return k.type?n.getBlob(k.type):n.getBlob()}var i=b.BlobBuilder||b.WebKitBlobBuilder||b.MSBlobBuilder||b.MozBlobBuilder,h=function(){try{var k=new Blob(["hi"]);return 2==k.size}catch(c){return !1}}(),g=i&&i.prototype.append&&i.prototype.getBlob;d.exports=function(){return h?b.Blob:g?j:void 0}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],216:[function(h,g,l){function k(b){return k.enabled(b)?function(d){d=j(d);var m=new Date,e=m-(k[b]||m);k[b]=m,d=b+" "+d+" +"+k.humanize(e),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function j(b){return b instanceof Error?b.stack||b.message:b}g.exports=k,k.names=[],k.skips=[],k.enable=function(m){try{localStorage.debug=m}catch(d){}for(var p=(m||"").split(/[\s,]+/),o=p.length,n=0;o>n;n++){m=p[n].replace("*",".*?"),"-"===m[0]?k.skips.push(new RegExp("^"+m.substr(1)+"$")):k.names.push(new RegExp("^"+m+"$"))}},k.disable=function(){k.enable("")},k.humanize=function(f){var e=1000,n=60000,m=60*n;return f>=m?(f/m).toFixed(1)+"h":f>=n?(f/n).toFixed(1)+"m":f>=e?(f/e|0)+"s":f+"ms"},k.enabled=function(e){for(var d=0,f=k.skips.length;f>d;d++){if(k.skips[d].test(e)){return !1}}for(var d=0,f=k.names.length;f>d;d++){if(k.names[d].test(e)){return !0}}return !1};try{window.localStorage&&k.enable(localStorage.debug)}catch(i){}},{}],217:[function(e,d,f){d.exports=e("./lib/")},{"./lib/":218}],218:[function(e,d,f){d.exports=e("./socket"),d.exports.parser=e("engine.io-parser")},{"./socket":219,"engine.io-parser":230}],219:[function(e,d,f){(function(w){function v(g,c){if(!(this instanceof v)){return new v(g,c)}if(c=c||{},g&&"object"==typeof g&&(c=g,g=null),g&&(g=o(g),c.host=g.host,c.secure="https"==g.protocol||"wss"==g.protocol,c.port=g.port,g.query&&(c.query=g.query)),this.secure=null!=c.secure?c.secure:w.location&&"https:"==location.protocol,c.host){var h=c.host.split(":");c.hostname=h.shift(),h.length?c.port=h.pop():c.port||(c.port=this.secure?"443":"80")}this.agent=c.agent||!1,this.hostname=c.hostname||(w.location?location.hostname:"localhost"),this.port=c.port||(w.location&&location.port?location.port:this.secure?443:80),this.query=c.query||{},"string"==typeof this.query&&(this.query=b.decode(this.query)),this.upgrade=!1!==c.upgrade,this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!c.forceJSONP,this.jsonp=!1!==c.jsonp,this.forceBase64=!!c.forceBase64,this.enablesXDR=!!c.enablesXDR,this.timestampParam=c.timestampParam||"t",this.timestampRequests=c.timestampRequests,this.transports=c.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=c.policyPort||843,this.rememberUpgrade=c.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=c.onlyBinaryUpgrades,this.pfx=c.pfx||null,this.key=c.key||null,this.passphrase=c.passphrase||null,this.cert=c.cert||null,this.ca=c.ca||null,this.ciphers=c.ciphers||null,this.rejectUnauthorized=c.rejectUnauthorized||null,this.open()}function u(h){var g={};for(var i in h){h.hasOwnProperty(i)&&(g[i]=h[i])}return g}var t=e("./transports"),s=e("component-emitter"),r=e("debug")("engine.io-client:socket"),q=e("indexof"),p=e("engine.io-parser"),o=e("parseuri"),n=e("parsejson"),b=e("parseqs");d.exports=v,v.priorWebsocketSuccess=!1,s(v.prototype),v.protocol=p.protocol,v.Socket=v,v.Transport=e("./transport"),v.transports=e("./transports"),v.parser=e("engine.io-parser"),v.prototype.createTransport=function(h){r('creating transport "%s"',h);var g=u(this.query);g.EIO=p.protocol,g.transport=h,this.id&&(g.sid=this.id);var i=new t[h]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:g,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return i},v.prototype.open=function(){var h;if(this.rememberUpgrade&&v.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket")){h="websocket"}else{if(0==this.transports.length){var g=this;return void setTimeout(function(){g.emit("error","No transports available")},0)}h=this.transports[0]}this.readyState="opening";var h;try{h=this.createTransport(h)}catch(i){return this.transports.shift(),void this.open()}h.open(),this.setTransport(h)},v.prototype.setTransport=function(g){r("setting transport %s",g.name);var c=this;this.transport&&(r("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=g,g.on("drain",function(){c.onDrain()}).on("packet",function(h){c.onPacket(h)}).on("error",function(h){c.onError(h)}).on("close",function(){c.onClose("transport close")})},v.prototype.probe=function(G){function F(){if(h.onlyBinaryUpgrades){var c=!this.supportsBinary&&h.transport.supportsBinary;x=x||c}x||(r('probe transport "%s" opened',G),y.send([{type:"ping",data:"probe"}]),y.once("packet",function(g){if(!x){if("pong"==g.type&&"probe"==g.data){if(r('probe transport "%s" pong',G),h.upgrading=!0,h.emit("upgrading",y),!y){return}v.priorWebsocketSuccess="websocket"==y.name,r('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){x||"closed"!=h.readyState&&(r("changing transport and sending upgrade packet"),z(),h.setTransport(y),y.send([{type:"upgrade"}]),h.emit("upgrade",y),y=null,h.upgrading=!1,h.flush())})}else{r('probe transport "%s" failed',G);var i=new Error("probe error");i.transport=y.name,h.emit("upgradeError",i)}}}))}function E(){x||(x=!0,z(),y.close(),y=null)}function D(c){var g=new Error("probe error: "+c);g.transport=y.name,E(),r('probe transport "%s" failed because of error: %s',G,c),h.emit("upgradeError",g)}function C(){D("transport closed")}function B(){D("socket closed")}function A(c){y&&c.name!=y.name&&(r('"%s" works - aborting "%s"',c.name,y.name),E())}function z(){y.removeListener("open",F),y.removeListener("error",D),y.removeListener("close",C),h.removeListener("close",B),h.removeListener("upgrading",A)}r('probing transport "%s"',G);var y=this.createTransport(G,{probe:1}),x=!1,h=this;v.priorWebsocketSuccess=!1,y.once("open",F),y.once("error",D),y.once("close",C),this.once("close",B),this.once("upgrading",A),y.open()},v.prototype.onOpen=function(){if(r("socket open"),this.readyState="open",v.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){r("starting upgrade probes");for(var g=0,c=this.upgrades.length;c>g;g++){this.probe(this.upgrades[g])}}},v.prototype.onPacket=function(g){if("opening"==this.readyState||"open"==this.readyState){switch(r('socket receive: type "%s", data "%s"',g.type,g.data),this.emit("packet",g),this.emit("heartbeat"),g.type){case"open":this.onHandshake(n(g.data));break;case"pong":this.setPing();break;case"error":var c=new Error("server error");c.code=g.data,this.emit("error",c);break;case"message":this.emit("data",g.data),this.emit("message",g.data)}}else{r('packet received with socket readyState "%s"',this.readyState)}},v.prototype.onHandshake=function(c){this.emit("handshake",c),this.id=c.sid,this.transport.query.sid=c.sid,this.upgrades=this.filterUpgrades(c.upgrades),this.pingInterval=c.pingInterval,this.pingTimeout=c.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},v.prototype.onHeartbeat=function(g){clearTimeout(this.pingTimeoutTimer);var c=this;c.pingTimeoutTimer=setTimeout(function(){"closed"!=c.readyState&&c.onClose("ping timeout")},g||c.pingInterval+c.pingTimeout)},v.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer),c.pingIntervalTimer=setTimeout(function(){r("writing ping packet - expecting pong within %sms",c.pingTimeout),c.ping(),c.onHeartbeat(c.pingTimeout)},c.pingInterval)},v.prototype.ping=function(){this.sendPacket("ping")},v.prototype.onDrain=function(){for(var c=0;c<this.prevBufferLen;c++){this.callbackBuffer[c]&&this.callbackBuffer[c]()}this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},v.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(r("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},v.prototype.write=v.prototype.send=function(g,c){return this.sendPacket("message",g,c),this},v.prototype.sendPacket=function(h,g,j){if("closing"!=this.readyState&&"closed"!=this.readyState){var i={type:h,data:g};this.emit("packetCreate",i),this.writeBuffer.push(i),this.callbackBuffer.push(j),this.flush()}},v.prototype.close=function(){function h(){i.onClose("forced close"),r("socket closing - telling transport to close"),i.transport.close()}function g(){i.removeListener("upgrade",g),i.removeListener("upgradeError",g),h()}function j(){i.once("upgrade",g),i.once("upgradeError",g)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var i=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?j():h()}):this.upgrading?j():h()}return this},v.prototype.onError=function(c){r("socket error %j",c),v.priorWebsocketSuccess=!1,this.emit("error",c),this.onClose("transport error",c)},v.prototype.onClose=function(h,g){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){r('socket close with reason: "%s"',h);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){i.writeBuffer=[],i.callbackBuffer=[],i.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",h,g)}},v.prototype.filterUpgrades=function(h){for(var g=[],j=0,i=h.length;i>j;j++){~q(this.transports,h[j])&&g.push(h[j])}return g}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":220,"./transports":221,"component-emitter":67,debug:227,"engine.io-parser":230,indexof:203,parsejson:207,parseqs:208,parseuri:229}],220:[function(h,g,l){function k(b){this.path=b.path,this.hostname=b.hostname,this.port=b.port,this.secure=b.secure,this.query=b.query,this.timestampParam=b.timestampParam,this.timestampRequests=b.timestampRequests,this.readyState="",this.agent=b.agent||!1,this.socket=b.socket,this.enablesXDR=b.enablesXDR,this.pfx=b.pfx,this.key=b.key,this.passphrase=b.passphrase,this.cert=b.cert,this.ca=b.ca,this.ciphers=b.ciphers,this.rejectUnauthorized=b.rejectUnauthorized}var j=h("engine.io-parser"),i=h("component-emitter");g.exports=k,i(k.prototype),k.timestamps=0,k.prototype.onError=function(e,d){var f=new Error(e);return f.type="TransportError",f.description=d,this.emit("error",f),this},k.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},k.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},k.prototype.send=function(b){if("open"!=this.readyState){throw new Error("Transport not open")}this.write(b)},k.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},k.prototype.onData=function(d){var c=j.decodePacket(d,this.socket.binaryType);this.onPacket(c)},k.prototype.onPacket=function(b){this.emit("packet",b)},k.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":67,"engine.io-parser":230}],221:[function(e,d,f){(function(c){function m(b){var r,q=!1,p=!1,o=!1!==b.jsonp;if(c.location){var n="https:"==location.protocol,g=location.port;g||(g=n?443:80),q=b.hostname!=location.hostname||g!=b.port,p=b.secure!=n}if(b.xdomain=q,b.xscheme=p,r=new l(b),"open" in r&&!b.forceJSONP){return new k(b)}if(!o){throw new Error("JSONP disabled")}return new j(b)}var l=e("xmlhttprequest"),k=e("./polling-xhr"),j=e("./polling-jsonp"),i=e("./websocket");f.polling=m,f.websocket=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":222,"./polling-xhr":223,"./websocket":225,xmlhttprequest:226}],222:[function(e,d,f){(function(q){function p(){}function o(g){n.call(this,g),this.query=this.query||{},l||(q.___eio||(q.___eio=[]),l=q.___eio),this.index=l.length;var c=this;l.push(function(h){c.onData(h)}),this.query.j=this.index,q.document&&q.addEventListener&&q.addEventListener("beforeunload",function(){c.script&&(c.script.onerror=p)},!1)}var n=e("./polling"),m=e("component-inherit");d.exports=o;var l,k=/\n/g,b=/\\n/g;m(o,n),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},o.prototype.doPoll=function(){var h=this,g=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),g.async=!0,g.src=this.uri(),g.onerror=function(c){h.onError("jsonp poll error",c)};var j=document.getElementsByTagName("script")[0];j.parentNode.insertBefore(g,j),this.script=g;var i="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);i&&setTimeout(function(){var c=document.createElement("iframe");document.body.appendChild(c),document.body.removeChild(c)},100)},o.prototype.doWrite=function(y,x){function w(){v(),x()}function v(){if(u.iframe){try{u.form.removeChild(u.iframe)}catch(g){u.onError("jsonp polling iframe removal error",g)}}try{var c='<iframe src="javascript:0" name="'+u.iframeId+'">';t=document.createElement(c)}catch(g){t=document.createElement("iframe"),t.name=u.iframeId,t.src="javascript:0"}t.id=u.iframeId,u.form.appendChild(t),u.iframe=t}var u=this;if(!this.form){var t,s=document.createElement("form"),r=document.createElement("textarea"),j=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=j,s.method="POST",s.setAttribute("accept-charset","utf-8"),r.name="d",s.appendChild(r),document.body.appendChild(s),this.form=s,this.area=r}this.form.action=this.uri(),v(),y=y.replace(b,"\\\n"),this.area.value=y.replace(k,"\\n");try{this.form.submit()}catch(i){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==u.iframe.readyState&&w()}:this.iframe.onload=w}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":224,"component-inherit":68}],223:[function(e,d,f){(function(u){function t(){}function s(g){if(o.call(this,g),u.location){var c="https:"==location.protocol,h=location.port;h||(h=c?443:80),this.xd=g.hostname!=u.location.hostname||h!=g.port,this.xs=g.secure!=c}}function r(c){this.method=c.method||"GET",this.uri=c.uri,this.xd=!!c.xd,this.xs=!!c.xs,this.async=!1!==c.async,this.data=void 0!=c.data?c.data:null,this.agent=c.agent,this.isBinary=c.isBinary,this.supportsBinary=c.supportsBinary,this.enablesXDR=c.enablesXDR,this.pfx=c.pfx,this.key=c.key,this.passphrase=c.passphrase,this.cert=c.cert,this.ca=c.ca,this.ciphers=c.ciphers,this.rejectUnauthorized=c.rejectUnauthorized,this.create()}function q(){for(var c in r.requests){r.requests.hasOwnProperty(c)&&r.requests[c].abort()}}var p=e("xmlhttprequest"),o=e("./polling"),n=e("component-emitter"),m=e("component-inherit"),b=e("debug")("engine.io-client:polling-xhr");d.exports=s,d.exports.Request=r,m(s,o),s.prototype.supportsBinary=!0,s.prototype.request=function(c){return c=c||{},c.uri=this.uri(),c.xd=this.xd,c.xs=this.xs,c.agent=this.agent||!1,c.supportsBinary=this.supportsBinary,c.enablesXDR=this.enablesXDR,c.pfx=this.pfx,c.key=this.key,c.passphrase=this.passphrase,c.cert=this.cert,c.ca=this.ca,c.ciphers=this.ciphers,c.rejectUnauthorized=this.rejectUnauthorized,new r(c)},s.prototype.doWrite=function(h,g){var k="string"!=typeof h&&void 0!==h,j=this.request({method:"POST",data:h,isBinary:k}),i=this;j.on("success",g),j.on("error",function(c){i.onError("xhr post error",c)}),this.sendXhr=j},s.prototype.doPoll=function(){b("xhr poll");var g=this.request(),c=this;g.on("data",function(h){c.onData(h)}),g.on("error",function(h){c.onError("xhr poll error",h)}),this.pollXhr=g},n(r.prototype),r.prototype.create=function(){var g={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};g.pfx=this.pfx,g.key=this.key,g.passphrase=this.passphrase,g.cert=this.cert,g.ca=this.ca,g.ciphers=this.ciphers,g.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new p(g),i=this;try{if(b("xhr open %s: %s",this.method,this.uri),c.open(this.method,this.uri,this.async),this.supportsBinary&&(c.responseType="arraybuffer"),"POST"==this.method){try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(h){}}"withCredentials" in c&&(c.withCredentials=!0),this.hasXDR()?(c.onload=function(){i.onLoad()},c.onerror=function(){i.onError(c.responseText)}):c.onreadystatechange=function(){4==c.readyState&&(200==c.status||1223==c.status?i.onLoad():setTimeout(function(){i.onError(c.status)},0))},b("xhr data %s",this.data),c.send(this.data)}catch(h){return void setTimeout(function(){i.onError(h)},0)}u.document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(c){this.emit("data",c),this.onSuccess()},r.prototype.onError=function(c){this.emit("error",c),this.cleanup(!0)},r.prototype.cleanup=function(g){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=t:this.xhr.onreadystatechange=t,g){try{this.xhr.abort()}catch(c){}}u.document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var h;try{var g;try{g=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(i){}h="application/octet-stream"===g?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(i){this.onError(i)}null!=h&&this.onData(h)},r.prototype.hasXDR=function(){return"undefined"!=typeof u.XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},u.document&&(r.requestsCount=0,r.requests={},u.attachEvent?u.attachEvent("onunload",q):u.addEventListener&&u.addEventListener("beforeunload",q,!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":224,"component-emitter":67,"component-inherit":68,debug:227,xmlhttprequest:226}],224:[function(t,s,r){function q(d){var c=d&&d.forceBase64;(!k||c)&&(this.supportsBinary=!1),p.call(this,d)}var p=t("../transport"),o=t("parseqs"),n=t("engine.io-parser"),m=t("component-inherit"),l=t("debug")("engine.io-client:polling");s.exports=q;var k=function(){var d=t("xmlhttprequest"),e=new d({xdomain:!1});return null!=e.responseType}();m(q,p),q.prototype.name="polling",q.prototype.doOpen=function(){this.poll()},q.prototype.pause=function(f){function e(){l("paused"),h.readyState="paused",f()}var h=this;if(this.readyState="pausing",this.polling||!this.writable){var g=0;this.polling&&(l("we are currently polling - waiting to pause"),g++,this.once("pollComplete",function(){l("pre-pause polling complete"),--g||e()})),this.writable||(l("we are currently writing - waiting to pause"),g++,this.once("drain",function(){l("pre-pause writing complete"),--g||e()}))}else{e()}},q.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},q.prototype.onData=function(e){var d=this;l("polling got data %s",e);var f=function(b,h,g){return"opening"==d.readyState&&d.onOpen(),"close"==b.type?(d.onClose(),!1):void d.onPacket(b)};n.decodePayload(e,this.socket.binaryType,f),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},q.prototype.doClose=function(){function d(){l("writing close packet"),c.write([{type:"close"}])}var c=this;"open"==this.readyState?(l("transport open - closing"),d()):(l("transport not open - deferring close"),this.once("open",d))},q.prototype.write=function(e){var d=this;this.writable=!1;var f=function(){d.writable=!0,d.emit("drain")},d=this;n.encodePayload(e,this.supportsBinary,function(b){d.doWrite(b,f)})},q.prototype.uri=function(){var e=this.query||{},d=this.secure?"https":"http",f="";return !1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+p.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==d&&443!=this.port||"http"==d&&80!=this.port)&&(f=":"+this.port),e.length&&(e="?"+e),d+"://"+this.hostname+f+this.path+e}},{"../transport":220,"component-inherit":68,debug:227,"engine.io-parser":230,parseqs:208,xmlhttprequest:226}],225:[function(t,s,r){function q(d){var c=d&&d.forceBase64;c&&(this.supportsBinary=!1),p.call(this,d)}var p=t("../transport"),o=t("engine.io-parser"),n=t("parseqs"),m=t("component-inherit"),l=t("debug")("engine.io-client:websocket"),k=t("ws");s.exports=q,m(q,p),q.prototype.name="websocket",q.prototype.supportsBinary=!0,q.prototype.doOpen=function(){if(this.check()){var e=this.uri(),d=void 0,f={agent:this.agent};f.pfx=this.pfx,f.key=this.key,f.passphrase=this.passphrase,f.cert=this.cert,f.ca=this.ca,f.ciphers=this.ciphers,f.rejectUnauthorized=this.rejectUnauthorized,this.ws=new k(e,d,f),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},q.prototype.addEventListeners=function(){var b=this;this.ws.onopen=function(){b.onOpen()},this.ws.onclose=function(){b.onClose()},this.ws.onmessage=function(c){b.onData(c.data)},this.ws.onerror=function(c){b.onError("websocket error",c)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(q.prototype.onData=function(d){var c=this;setTimeout(function(){p.prototype.onData.call(c,d)},0)}),q.prototype.write=function(g){function f(){j.writable=!0,j.emit("drain")}var j=this;this.writable=!1;for(var i=0,h=g.length;h>i;i++){o.encodePacket(g[i],this.supportsBinary,function(d){try{j.ws.send(d)}catch(c){l("websocket closed before onclose event")}})}setTimeout(f,0)},q.prototype.onClose=function(){p.prototype.onClose.call(this)},q.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},q.prototype.uri=function(){var e=this.query||{},d=this.secure?"wss":"ws",f="";return this.port&&("wss"==d&&443!=this.port||"ws"==d&&80!=this.port)&&(f=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),e=n.encode(e),e.length&&(e="?"+e),d+"://"+this.hostname+f+this.path+e},q.prototype.check=function(){return !(!k||"__initialize" in k&&this.name===q.prototype.name)}},{"../transport":220,"component-inherit":68,debug:227,"engine.io-parser":230,parseqs:208,ws:237}],226:[function(f,e,h){var g=f("has-cors");e.exports=function(i){var d=i.xdomain,l=i.xscheme,k=i.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!d||g)){return new XMLHttpRequest}}catch(j){}try{if("undefined"!=typeof XDomainRequest&&!l&&k){return new XDomainRequest}}catch(j){}if(!d){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(j){}}}},{"has-cors":233}],227:[function(j,i,p){function o(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function n(){var g=arguments,c=this.useColors;if(g[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+g[0]+(c?"%c ":" ")+"+"+p.humanize(this.diff),!c){return g}var r="color: "+this.color;g=[g[0],r,"color: inherit"].concat(Array.prototype.slice.call(g,1));var q=0,h=0;return g[0].replace(/%[a-z%]/g,function(b){"%%"!==b&&(q++,"%c"===b&&(h=q))}),g.splice(h,0,r),g}function m(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function l(d){try{null==d?localStorage.removeItem("debug"):localStorage.debug=d}catch(c){}}function k(){var d;try{d=localStorage.debug}catch(c){}return d}p=i.exports=j("./debug"),p.log=m,p.formatArgs=n,p.save=l,p.load=k,p.useColors=o,p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(b){return JSON.stringify(b)},p.enable(k())},{"./debug":228}],228:[function(v,u,t){function s(){return t.colors[l++%t.colors.length]}function r(d){function c(){}function h(){var j=h,e=+new Date,y=e-(m||e);j.diff=y,j.prev=m,j.curr=e,m=e,null==j.useColors&&(j.useColors=t.useColors()),null==j.color&&j.useColors&&(j.color=s());var x=Array.prototype.slice.call(arguments);x[0]=t.coerce(x[0]),"string"!=typeof x[0]&&(x=["%o"].concat(x));var w=0;x[0]=x[0].replace(/%([a-z%])/g,function(i,B){if("%%"===i){return i}w++;var A=t.formatters[B];if("function"==typeof A){var z=x[w];i=A.call(j,z),x.splice(w,1),w--}return i}),"function"==typeof t.formatArgs&&(x=t.formatArgs.apply(j,x));var k=h.log||t.log||void 0;k.apply(j,x)}c.enabled=!1,h.enabled=!0;var g=t.enabled(d)?h:c;return g.namespace=d,g}function q(f){t.save(f);for(var c=(f||"").split(/[\s,]+/),h=c.length,g=0;h>g;g++){c[g]&&(f=c[g].replace(/\*/g,".*?"),"-"===f[0]?t.skips.push(new RegExp("^"+f.substr(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}}function p(){t.enable("")}function o(e){var c,f;for(c=0,f=t.skips.length;f>c;c++){if(t.skips[c].test(e)){return !1}}for(c=0,f=t.names.length;f>c;c++){if(t.names[c].test(e)){return !0}}return !1}function n(b){return b instanceof Error?b.stack||b.message:b}t=u.exports=r,t.coerce=n,t.disable=p,t.enable=q,t.enabled=o,t.humanize=v("ms"),t.names=[],t.skips=[],t.formatters={};var m,l=0},{ms:234}],229:[function(g,f,j){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,h=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];f.exports=function(e){var d=e,o=e.indexOf("["),n=e.indexOf("]");-1!=o&&-1!=n&&(e=e.substring(0,o)+e.substring(o,n).replace(/:/g,";")+e.substring(n,e.length));for(var m=i.exec(e||""),l={},k=14;k--;){l[h[k]]=m[k]||""}return -1!=o&&-1!=n&&(l.source=d,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l}},{}],230:[function(e,d,f){(function(M){function L(h,g){var i="b"+f.packets[h.type]+h.data.data;return g(i)}function K(j,i,o){if(!i){return f.encodeBase64Packet(j,o)}var n=j.data,m=new Uint8Array(n),l=new Uint8Array(1+n.byteLength);l[0]=x[j.type];for(var k=0;k<m.length;k++){l[k+1]=m[k]}return o(l.buffer)}function J(h,g,j){if(!g){return f.encodeBase64Packet(h,j)}var i=new FileReader;return i.onload=function(){h.data=i.result,f.encodePacket(h,g,!0,j)},i.readAsArrayBuffer(h.data)}function I(i,h,l){if(!h){return f.encodeBase64Packet(i,l)}if(y){return J(i,h,l)}var k=new Uint8Array(1);k[0]=x[i.type];var j=new c([k.buffer,i.data]);return l(j)}function H(i,h,n){for(var m=new Array(i.length),l=C(i.length,n),k=function(b,o,g){h(o,function(p,q){m[b]=q,g(p,m)})},j=0;j<i.length;j++){k(j,i[j],l)}}var G=e("./keys"),F=e("has-binary"),E=e("arraybuffer.slice"),D=e("base64-arraybuffer"),C=e("after"),B=e("utf8"),A=navigator.userAgent.match(/Android/i),z=/PhantomJS/i.test(navigator.userAgent),y=A||z;f.protocol=3;var x=f.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},w=G(x),v={type:"error",data:"parser error"},c=e("blob");f.encodePacket=function(b,n,m,l){"function"==typeof n&&(l=n,n=!1),"function"==typeof m&&(l=m,m=null);var k=void 0===b.data?void 0:b.data.buffer||b.data;if(M.ArrayBuffer&&k instanceof ArrayBuffer){return K(b,n,l)}if(c&&k instanceof M.Blob){return I(b,n,l)}if(k&&k.base64){return L(b,l)}var g=x[b.type];return void 0!==b.data&&(g+=m?B.encode(String(b.data)):String(b.data)),l(""+g)},f.encodeBase64Packet=function(s,r){var q="b"+f.packets[s.type];if(c&&s.data instanceof c){var p=new FileReader;return p.onload=function(){var g=p.result.split(",")[1];r(q+g)},p.readAsDataURL(s.data)}var o;try{o=String.fromCharCode.apply(null,new Uint8Array(s.data))}catch(n){for(var m=new Uint8Array(s.data),l=new Array(m.length),b=0;b<m.length;b++){l[b]=m[b]}o=String.fromCharCode.apply(null,l)}return q+=M.btoa(o),r(q)},f.decodePacket=function(j,i,o){if("string"==typeof j||void 0===j){if("b"==j.charAt(0)){return f.decodeBase64Packet(j.substr(1),i)}if(o){try{j=B.decode(j)}catch(n){return v}}var m=j.charAt(0);return Number(m)==m&&w[m]?j.length>1?{type:w[m],data:j.substring(1)}:{type:w[m]}:v}var l=new Uint8Array(j),m=l[0],k=E(j,1);return c&&"blob"===i&&(k=new c([k])),{type:w[m],data:k}},f.decodeBase64Packet=function(b,i){var h=w[b.charAt(0)];if(!M.ArrayBuffer){return{type:h,data:{base64:!0,data:b.substr(1)}}}var g=D.decode(b.substr(1));return"blob"===i&&c&&(g=new c([g])),{type:h,data:g}},f.encodePayload=function(i,h,m){function l(b){return b.length+":"+b}function k(b,g){f.encodePacket(b,j?h:!1,!0,function(n){g(null,l(n))})}"function"==typeof h&&(m=h,h=null);var j=F(i);return h&&j?c&&!y?f.encodePayloadAsBlob(i,m):f.encodePayloadAsArrayBuffer(i,m):i.length?void H(i,k,function(n,g){return m(g.join(""))}):m("0:")},f.decodePayload=function(O,N,u){if("string"!=typeof O){return f.decodePayloadAsBinary(O,N,u)}"function"==typeof N&&(u=N,N=null);var t;if(""==O){return u(v,0,1)}for(var s,r,q="",p=0,o=O.length;o>p;p++){var n=O.charAt(p);if(":"!=n){q+=n}else{if(""==q||q!=(s=Number(q))){return u(v,0,1)}if(r=O.substr(p+1,s),q!=r.length){return u(v,0,1)}if(r.length){if(t=f.decodePacket(r,N,!0),v.type==t.type&&v.data==t.data){return u(v,0,1)}var m=u(t,p+s,o);if(!1===m){return}}p+=s,q=""}}return""!=q?u(v,0,1):void 0},f.encodePayloadAsArrayBuffer=function(h,g){function i(k,j){f.encodePacket(k,!0,!0,function(b){return j(null,b)})}return h.length?void H(h,i,function(b,m){var l=m.reduce(function(o,n){var p;return p="string"==typeof n?n.length:n.byteLength,o+p.toString().length+p+2},0),k=new Uint8Array(l),j=0;return m.forEach(function(o){var n="string"==typeof o,s=o;if(n){for(var r=new Uint8Array(o.length),q=0;q<o.length;q++){r[q]=o.charCodeAt(q)}s=r.buffer}n?k[j++]=0:k[j++]=1;for(var p=s.byteLength.toString(),q=0;q<p.length;q++){k[j++]=parseInt(p[q])}k[j++]=255;for(var r=new Uint8Array(s),q=0;q<r.length;q++){k[j++]=r[q]}}),g(k.buffer)}):g(new ArrayBuffer(0))},f.encodePayloadAsBlob=function(h,g){function i(k,j){f.encodePacket(k,!0,!0,function(b){var r=new Uint8Array(1);if(r[0]=1,"string"==typeof b){for(var q=new Uint8Array(b.length),p=0;p<b.length;p++){q[p]=b.charCodeAt(p)}b=q.buffer,r[0]=0}for(var o=b instanceof ArrayBuffer?b.byteLength:b.size,n=o.toString(),m=new Uint8Array(n.length+1),p=0;p<n.length;p++){m[p]=parseInt(n[p])}if(m[n.length]=255,c){var l=new c([r.buffer,m.buffer,b]);j(null,l)}})}H(h,i,function(b,j){return g(new c(j))})},f.decodePayloadAsBinary=function(U,T,S){"function"==typeof T&&(S=T,T=null);for(var R=U,Q=[],P=!1;R.byteLength>0;){for(var O=new Uint8Array(R),N=0===O[0],u="",t=1;255!=O[t];t++){if(u.length>310){P=!0;break}u+=O[t]}if(P){return S(v,0,1)}R=E(R,2+u.length),u=parseInt(u);var s=E(R,0,u);if(N){try{s=String.fromCharCode.apply(null,new Uint8Array(s))}catch(r){var q=new Uint8Array(s);s="";for(var t=0;t<q.length;t++){s+=String.fromCharCode(q[t])}}}Q.push(s),R=E(R,u)}var k=Q.length;Q.forEach(function(b,g){S(f.decodePacket(b,T,!0),g,k)})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":231,after:3,"arraybuffer.slice":4,"base64-arraybuffer":65,blob:215,"has-binary":232,utf8:236}],231:[function(e,d,f){d.exports=Object.keys||function(h){var g=[],j=Object.prototype.hasOwnProperty;for(var i in h){j.call(h,i)&&g.push(i)}return g}},{}],232:[function(e,d,f){(function(h){function g(i){function c(j){if(!j){return !1}if(h.Buffer&&h.Buffer.isBuffer(j)||h.ArrayBuffer&&j instanceof ArrayBuffer||h.Blob&&j instanceof Blob||h.File&&j instanceof File){return !0}if(b(j)){for(var l=0;l<j.length;l++){if(c(j[l])){return !0}}}else{if(j&&"object"==typeof j){j.toJSON&&(j=j.toJSON());for(var k in j){if(j.hasOwnProperty(k)&&c(j[k])){return !0}}}}return !1}return c(i)}var b=e("isarray");d.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:204}],233:[function(g,f,j){var i=g("global");try{f.exports="XMLHttpRequest" in i&&"withCredentials" in new i.XMLHttpRequest}catch(h){f.exports=!1}},{global:163}],234:[function(x,w,v){function u(f){var e=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(f);if(e){var h=parseFloat(e[1]),g=(e[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"y":return h*m;case"days":case"day":case"d":return h*n;case"hours":case"hour":case"h":return h*o;case"minutes":case"minute":case"m":return h*p;case"seconds":case"second":case"s":return h*q;case"ms":return h}}}function t(b){return b>=n?Math.round(b/n)+"d":b>=o?Math.round(b/o)+"h":b>=p?Math.round(b/p)+"m":b>=q?Math.round(b/q)+"s":b+"ms"}function s(b){return r(b,n,"day")||r(b,o,"hour")||r(b,p,"minute")||r(b,q,"second")||b+" ms"}function r(e,d,f){return d>e?void 0:1.5*d>e?Math.floor(e/d)+" "+f:Math.ceil(e/d)+" "+f+"s"}var q=1000,p=60*q,o=60*p,n=24*o,m=365.25*n;w.exports=function(d,c){return c=c||{},"string"==typeof d?u(d):c["long"]?s(d):t(d)}},{}],235:[function(g,f,j){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,h=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];f.exports=function(e){for(var d=i.exec(e||""),l={},k=14;k--;){l[h[k]]=d[k]||""}return l}},{}],236:[function(e,d,f){(function(b){!function(P){function O(h){for(var g,l,k=[],j=0,i=h.length;i>j;){g=h.charCodeAt(j++),g>=55296&&56319>=g&&i>j?(l=h.charCodeAt(j++),56320==(64512&l)?k.push(((1023&g)<<10)+(1023&l)+65536):(k.push(g),j--)):k.push(g)}return k}function N(h){for(var g,k=h.length,j=-1,i="";++j<k;){g=h[j],g>65535&&(g-=65536,i+=A(g>>>10&1023|55296),g=56320|1023&g),i+=A(g)}return i}function M(h,g){return A(h>>g&63|128)}function L(h){if(0==(4294967168&h)){return A(h)}var g="";return 0==(4294965248&h)?g=A(h>>6&31|192):0==(4294901760&h)?(g=A(h>>12&15|224),g+=M(h,6)):0==(4292870144&h)&&(g=A(h>>18&7|240),g+=M(h,12),g+=M(h,6)),g+=A(63&h|128)}function K(i){for(var h,m=O(i),l=m.length,k=-1,j="";++k<l;){h=m[k],j+=L(h)}return j}function J(){if(B>=C){throw Error("Invalid byte index")}var g=255&D[B];if(B++,128==(192&g)){return 63&g}throw Error("Invalid continuation byte")}function I(){var h,g,k,j,i;if(B>C){throw Error("Invalid byte index")}if(B==C){return !1}if(h=255&D[B],B++,0==(128&h)){return h}if(192==(224&h)){var g=J();if(i=(31&h)<<6|g,i>=128){return i}throw Error("Invalid continuation byte")}if(224==(240&h)){if(g=J(),k=J(),i=(15&h)<<12|g<<6|k,i>=2048){return i}throw Error("Invalid continuation byte")}if(240==(248&h)&&(g=J(),k=J(),j=J(),i=(15&h)<<18|g<<12|k<<6|j,i>=65536&&1114111>=i)){return i}throw Error("Invalid UTF-8 detected")}function H(h){D=O(h),C=D.length,B=0;for(var g,i=[];(g=I())!==!1;){i.push(g)}return N(i)}var G="object"==typeof f&&f,F="object"==typeof d&&d&&d.exports==G&&d,E="object"==typeof b&&b;(E.global===E||E.window===E)&&(P=E);var D,C,B,A=String.fromCharCode,z={version:"2.0.0",encode:K,decode:H};if("function"==typeof define&&"object"==typeof define.amd&&define.amd){define(function(){return z})}else{if(G&&!G.nodeType){if(F){F.exports=z}else{var y={},x=y.hasOwnProperty;for(var c in z){x.call(z,c)&&(G[c]=z[c])}}}else{P.utf8=z}}}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],237:[function(h,g,l){function k(f,e,n){var m;return m=e?new i(f,e):new i(f)}var j=function(){return this}(),i=j.WebSocket||j.MozWebSocket;g.exports=i?k:null,i&&(k.prototype=i.prototype)},{}],238:[function(e,d,f){(function(c){var h=e("isarray"),g=e("./is-buffer");f.deconstructPacket=function(j){function i(b){if(!b){return b}if(g(b)){var q={_placeholder:!0,num:m.length};return m.push(b),q}if(h(b)){for(var p=new Array(b.length),o=0;o<b.length;o++){p[o]=i(b[o])}return p}if("object"==typeof b&&!(b instanceof Date)){var p={};for(var n in b){p[n]=i(b[n])}return p}return b}var m=[],l=j.data,k=j;return k.data=i(l),k.attachments=m.length,{packet:k,buffers:m}},f.reconstructPacket=function(j,i){function k(b){if(b&&b._placeholder){var n=i[b.num];return n}if(h(b)){for(var m=0;m<b.length;m++){b[m]=k(b[m])}return b}if(b&&"object"==typeof b){for(var l in b){b[l]=k(b[l])}return b}return b}return j.data=k(j.data),j.attachments=void 0,j},f.removeBlobs=function(b,l){function k(p,s,r){if(!p){return p}if(c.Blob&&p instanceof Blob||c.File&&p instanceof File){j++;var q=new FileReader;q.onload=function(){r?r[s]=this.result:i=this.result,--j||l(i)},q.readAsArrayBuffer(p)}else{if(h(p)){for(var o=0;o<p.length;o++){k(p[o],o,p)}}else{if(p&&"object"==typeof p&&!g(p)){for(var n in p){k(p[n],n,p)}}}}}var j=0,i=b;k(i),j||l(i)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":240,isarray:204}],239:[function(D,C,B){function A(){}function z(e){var c="",f=!1;return c+=e.type,(B.BINARY_EVENT==e.type||B.BINARY_ACK==e.type)&&(c+=e.attachments,c+="-"),e.nsp&&"/"!=e.nsp&&(f=!0,c+=e.nsp),null!=e.id&&(f&&(c+=",",f=!1),c+=e.id),null!=e.data&&(f&&(c+=","),c+=s.stringify(e.data)),t("encoded %j as %s",e,c),c}function y(e,d){function f(b){var i=q.deconstructPacket(b),h=z(i.packet),g=i.buffers;g.unshift(h),d(g)}q.removeBlobs(e,f)}function x(){this.reconstructor=null}function w(h){var c={},l=0;if(c.type=Number(h.charAt(0)),null==B.types[c.type]){return u()}if(B.BINARY_EVENT==c.type||B.BINARY_ACK==c.type){for(c.attachments="";"-"!=h.charAt(++l);){c.attachments+=h.charAt(l)}c.attachments=Number(c.attachments)}if("/"==h.charAt(l+1)){for(c.nsp="";++l;){var k=h.charAt(l);if(","==k){break}if(c.nsp+=k,l+1==h.length){break}}}else{c.nsp="/"}var j=h.charAt(l+1);if(""!=j&&Number(j)==j){for(c.id="";++l;){var k=h.charAt(l);if(null==k||Number(k)!=k){--l;break}if(c.id+=h.charAt(l),l+1==h.length){break}}c.id=Number(c.id)}if(h.charAt(++l)){try{c.data=s.parse(h.substr(l))}catch(i){return u()}}return t("decoded %s as %j",h,c),c}function v(b){this.reconPack=b,this.buffers=[]}function u(b){return{type:B.ERROR,data:"parser error"}}var t=D("debug")("socket.io-parser"),s=D("json3"),r=(D("isarray"),D("component-emitter")),q=D("./binary"),p=D("./is-buffer");B.protocol=4,B.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],B.CONNECT=0,B.DISCONNECT=1,B.EVENT=2,B.ACK=3,B.ERROR=4,B.BINARY_EVENT=5,B.BINARY_ACK=6,B.Encoder=A,B.Decoder=x,A.prototype.encode=function(e,c){if(t("encoding packet %j",e),B.BINARY_EVENT==e.type||B.BINARY_ACK==e.type){y(e,c)}else{var f=z(e);c([f])}},r(x.prototype),x.prototype.add=function(d){var c;if("string"==typeof d){c=w(d),B.BINARY_EVENT==c.type||B.BINARY_ACK==c.type?(this.reconstructor=new v(c),0==this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c)}else{if(!p(d)&&!d.base64){throw new Error("Unknown type: "+d)}if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}c=this.reconstructor.takeBinaryData(d),c&&(this.reconstructor=null,this.emit("decoded",c))}},x.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},v.prototype.takeBinaryData=function(d){if(this.buffers.push(d),this.buffers.length==this.reconPack.attachments){var c=q.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),c}return null},v.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":238,"./is-buffer":240,"component-emitter":67,debug:241,isarray:204,json3:205}],240:[function(e,d,f){(function(b){function g(c){return b.Buffer&&b.Buffer.isBuffer(c)||b.ArrayBuffer&&c instanceof ArrayBuffer}d.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],241:[function(h,g,l){function k(b){return k.enabled(b)?function(d){d=j(d);var m=new Date,e=m-(k[b]||m);k[b]=m,d=b+" "+d+" +"+k.humanize(e),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function j(b){return b instanceof Error?b.stack||b.message:b}g.exports=k,k.names=[],k.skips=[],k.enable=function(m){try{localStorage.debug=m}catch(d){}for(var p=(m||"").split(/[\s,]+/),o=p.length,n=0;o>n;n++){m=p[n].replace("*",".*?"),"-"===m[0]?k.skips.push(new RegExp("^"+m.substr(1)+"$")):k.names.push(new RegExp("^"+m+"$"))}},k.disable=function(){k.enable("")},k.humanize=function(f){var e=1000,n=60000,m=60*n;return f>=m?(f/m).toFixed(1)+"h":f>=n?(f/n).toFixed(1)+"m":f>=e?(f/e|0)+"s":f+"ms"},k.enabled=function(e){for(var d=0,f=k.skips.length;f>d;d++){if(k.skips[d].test(e)){return !1}}for(var d=0,f=k.names.length;f>d;d++){if(k.names[d].test(e)){return !0}}return !1};try{window.localStorage&&k.enable(localStorage.debug)}catch(i){}},{}],242:[function(g,f,j){Object.defineProperty(j,"__esModule",{value:!0});var i=function(){this.SIGNALING_URL="wss://sig.streamroot.io/websocket/",this.TRACKER_URL="https://tracker.streamroot.io",this.ERRORS_URL="https://errors.streamroot.io",this.CLIENT_TRACKER_PROTOCOL_VERSION="2.0.0",this.ANALYTICS_RETRY_NUMBER=3,this.ANALYTICS_RETRY_DELAY=10000,this.ANALYTICS_SERVER_URL="https://klara.streamroot.io",this.CHUNK_SIZE=15360,this.P2P_CACHE_MAX_SIZE=136314880,this.GETSEGMENTTIME_CACHE_MAX_SIZE=200,this.MAX_DL_REQUEST_SPEED=1000,this.TIME_BETWEEN_CHUNK_DL=50,this.NB_CHUNK_DL_GROUP=10,this.MAX_CHUNK_BY_SEEDER=300,this.NB_SEGMENT_P2P_PREBUFFER=6,this.MAX_SEGMENT_REQUEST_STORE=this.NB_SEGMENT_P2P_PREBUFFER,this.NB_SEGMENT_P2P_SKIP=2,this.MAX_BUFFER_DURATION=300,this.MAX_UP_SPEED=600,this.CHUNK_UP_RETRY_DELAY=10,this.PEER_CONNECTION_TIMEOUT=50000,this.PEER_UP_TIMEOUT=5000,this.SEND_HEARTBEAT_INTERVAL=5000,this.CHECK_HEARTBEAT_INTERVAL=10000,this.MAX_USELESS_COUNT=100,this.MIN_USEFUL_SPEED=5,this.MIN_NUMBER_OF_PEERS=8,this.MAX_NUMBER_OF_PEERS=13,this.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE=10,this.ASK_PEERS_INTERVAL=60000,this.CHECK_USELESS_INTERVAL=60000,this.SPEED_MONITOR_INTERVAL=1000,this.MEAN_SPEED_CALCULATION_INTERVAL=500,this.CHUNK_TIMEOUT=2500,this.CHUNK_UP_TIMEOUT=this.CHUNK_TIMEOUT-600,this.ICECANDIDATES_TIMEOUT=1000,this.UP_MAX_BUFFERED_AMOUNT=10,this.OFFER_DECLINED_TIMEOUT=60000,this.PEER_REMOVED_TIMEOUT=900000,this.PEER_CONNEXION_ATTEMPT_TIMEOUT=900000,this.GEOLOCATION_REQUEST_TIMEOUT=3000,this.GEOLOCATION_REQUEST_MAX_RETRY=1,this.MAX_P2P_PREBUFFERING_TIME=720,this.RETRY_P2P_START_DL_SEGMENT_DELAY=5000,this.ANALYTICS={DOWNLOAD_TRACK_INTERVAL:120000,LATENCIES_TRACK_INTERVAL:300000},this.RY_TRACK=!0,this.RY_TRACKER="srTracker",this.ABR_DEL_T=30,this.LIVE={P2P_CACHE_MAX_SIZE:62914560},this.ENABLE_TURN=!1,this.STUNSERVERS=[{urls:"stun:stun.l.google.com:19302"}],this.TURNSERVERS=[{urls:"turn:23.97.160.254:3478?transport=udp",credential:"streamroot",username:"streamroot"}],this.ALLOW_P2P=!0,this.RANGE_REQUEST_ALLOWED=!0,this.DISPLAY_ERROR=!1,this.PEER_INSTANT_SPEED_CALCULATION_INTERVAL=100,this.PEER_INSTANT_SPEED_CALCULATION_WINDOW=10000,this.PEER_COMPUTE_RTT_INTERVAL=5000,this.USE_SIGNALING_SERVER=!0,this.SIGNALING_DELAY_STEP=2000,this.SIGNALING_DELAY_MAX=300000,this.LOCKED_RETRY_INTERVAL=30,this.LOCKED_RETRY_TIMEOUT=this.TIMEOUT_GET_FULL_SEGMENT=500,this.RETURN_COPY_SEGMENT=!0},h=new i;j["default"]=h,f.exports=j["default"]},{}],243:[function(B,A,z){var y=B("babel-runtime/helpers/create-class")["default"],x=B("babel-runtime/helpers/class-call-check")["default"],w=B("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(z,"__esModule",{value:!0});var v=B("./MetricSender"),u=w(v),t=B("../../conf"),s=w(t),r=Math.random().toString().substring(2),q=Math.random().toString().substring(2),p=Math.random().toString().substring(2);window.Streamroot=window.Streamroot||{},window.Streamroot.klaraToken=window.Streamroot.klaraToken||r+q+p;var o=function(){function b(e){var k=e.serverURL,j=e.clientID,i=e.content,h=e.namespace;x(this,b),this._serverURL=k||s["default"].ANALYTICS_SERVER_URL,this._clientID=j,this._namespace=h,this._content=i}return y(b,[{key:"track",value:function(g,f){f.customer=this._clientID,f.content=this._content,f.label=g,f.version="3.0.13",f.token=window.Streamroot.klaraToken;var j=JSON.stringify(f),i=this._serverURL+"/"+this._namespace,h=new u["default"](i,j);h.send(j)}}]),b}();z["default"]=o,A.exports=z["default"]},{"../../conf":242,"./MetricSender":245,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],244:[function(v,u,t){var s=v("babel-runtime/helpers/create-class")["default"],r=v("babel-runtime/helpers/class-call-check")["default"],q=v("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(t,"__esModule",{value:!0});var p=v("../../conf"),o=q(p),n=v("./AnalyticsClient"),m=q(n),l=function(){function b(e){r(this,b);var i=new m["default"]({serverURL:o["default"].ERRORS_URL,clientID:o["default"].ID_CLIENT,content:e,namespace:"errors"}),h=function g(d){if("Script error."!==d.message){var c={origin:"browser",version:"3.0.13",message:d.message,url:d.filename,line:d.lineno,column:d.colno};window.removeEventListener("error",g),i.track("error",c)}};window.addEventListener("error",h),this._errorHandler=h}return s(b,[{key:"dispose",value:function(){window.removeEventListener("error",this._errorHandler)}}]),b}();t["default"]=l,u.exports=t["default"]},{"../../conf":242,"./AnalyticsClient":243,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],245:[function(r,q,p){var o=r("babel-runtime/helpers/create-class")["default"],n=r("babel-runtime/helpers/class-call-check")["default"],m=r("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(p,"__esModule",{value:!0});var l=r("../../conf"),k=m(l),j=function(){function b(d,e){n(this,b),this._serverURL=d,this._payload=e,this._retryCount=0}return o(b,[{key:"_retry",value:function(){this._retryCount<k["default"].ANALYTICS_RETRY_NUMBER&&setTimeout(this.send.bind(this),k["default"].ANALYTICS_RETRY_DELAY)}},{key:"_onLoad",value:function(c){c.target.status>=500&&c.target.status<600&&this._retry()}},{key:"_onError",value:function(){this._retry()}},{key:"send",value:function(){var c=new XMLHttpRequest;c.open("POST",this._serverURL),c.setRequestHeader("Content-Type","application/json;charset=UTF-8"),c.onload=this._onLoad.bind(this),c.onerror=this._onError.bind(this),c.send(this._payload),this._retryCount++}}]),b}();p["default"]=j,q.exports=p["default"]},{"../../conf":242,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],246:[function(e,d,f){(function(M){var L=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(f,"__esModule",{value:!0});var K=e("../../conf"),J=L(K),I=e("underscore"),H=L(I),G=e("../p2p/status"),F=L(G),E=e("../utils/Timers"),D=L(E),C=e("./AnalyticsClient"),B=L(C),A=e("./ErrorAnalytics"),z=L(A),y=e("../p2p/GlobalEventBus"),x=L(y),w=e("../utils/Delta"),c=e("../utils/ObjectHelper"),b=function(i,g,m,l,k,j){this._playerInterface=i,this.externalEventManager=g,this.apiStartTimestamp=Date.now(),this._timers=new D["default"],this._p2pCache=l,this.peerPool=k,this.p2pDownloader=j,this.mediaStats="function"==typeof i.getMediaStats?i.getMediaStats():void 0,this.content=m,this.alreadyPlayed=!1,this.lastP2PDownloaded=0,this.lastP2PDownloadedNewAnalytics=0,this.lastP2PUploaded=0,this.lastCDNDownloaded=0,this.lastCDNCancelled=0,this.lastP2PDownloadedUncorrected=0,this.lastDataDlTwice=0,this.lastDataDlTwice_PP=0,this.lastDataDlTwice_PC=0,this.lastDataDlTwice_CP=0,this.lastDataDlTwice_CC=0,this.lastDataDlTwice_HP=0,this.lastDataDlTwice_HD=0,this.lastDataDlTwice_M=0,this.lastMinSwitchCount=0,this.lastLowerSwitchCount=0,this.lastUpperSwitchCount=0,this.lastInternalTrackSwitchCount=0,this.lastTrackerMsgCount=0,this.lastTrackerSgnCount=0,this.peerUpdateRequestDelta=new w.Delta,this.peerUpdateResponseDelta=new w.Delta,this.missedIceCandidateDelta=new w.Delta,this.newPeerConnectionCountDelta=new w.Delta,this.droppedFramesDelta=new w.Delta,this.downloadTrackCounter=0,this.uploadSaturation=0,this.sumDistance=0,this.maxDistance=0,this.nbDistance=0,this.peerConnecting=[],this.isUnloadPayloadSent=!1,this._timers.setInterval(this.sendDownloadAnalytics.bind(this),J["default"].ANALYTICS.DOWNLOAD_TRACK_INTERVAL),M.RY=function(n){var h=["identify","track","page"],s="realytics",r=function(u,t){return function(){var v=Array.prototype.slice.call(arguments);u[t]||(u[t]=[]),u[t].push(v)}},q=function(v){for(var u=0;u<h.length;u++){var t=h[u];v?n[v][t]=r(n._q[v],t):n[t]=n[s][t]=r(n._q[s],t)}},p=function o(t,v){var u=t?t:s;n[u]||(n[u]={}),n._q[u]||(n._q[u]={}),v&&(n._q[u].init=[[v]]),q(t)};return n._q||(n._q={},p(null,null)),n.init=function(t,O){if(O&&h){for(var N=0;N<h.length;N++){if(O==h[N]||"init"==O){return}}}p(O,t);var v=document.createElement("script");v.type="text/javascript",v.async=!0,v.src=("https:"==document.location.protocol?"https://":"http://")+"dcniko1cv0rz.cloudfront.net/realytics-0.2.min.js";var u=document.getElementsByTagName("script")[0];u.parentNode.insertBefore(v,u)},n}(M.RY||{}),RY.init(J["default"].ID_CLIENT,J["default"].RY_TRACKER),this.realytics_count=0,this.analyticsSender=new B["default"]({clientID:J["default"].ID_CLIENT,content:this.content,namespace:"viewers"}),this.errorAnalytics=new z["default"](this.content),this.externalEventManager.addWindowEventListener("beforeunload",this.onUnload.bind(this)),this.externalEventManager.addWindowEventListener("unload",this.onUnload.bind(this)),F["default"].getEE().once("tracker_ready",this.onTrackerReady.bind(this)),F["default"].getEE().once("tracker_ready",this.trackKlaraTrackerInit.bind(this)),this.track_realytics("video views"),x["default"].on("uploadSaturated",this.incrementUploadSaturation.bind(this))};b.prototype.trackKlaraTrackerInit=function(){var g={trackerConnectionTime:F["default"].getTrackerConnectionTime(),trackerConnected:1};this.analyticsSender.track("init",g)},b.prototype.track_realytics=function(h,g,i){g=g||{},g.customerID="Integros",g.mpdURL=this.content,i&&(g.conf={p2pMaxCacheSize:J["default"].P2P_CACHE_MAX_SIZE,maxDlRequestSpeed:J["default"].MAX_DL_REQUEST_SPEED,maxChunkBySeed:J["default"].MAX_CHUNK_BY_SEEDER,nbSegmentP2PPrebuffer:J["default"].NB_SEGMENT_P2P_PREBUFFER,maxUpSpeed:J["default"].MAX_UP_SPEED,chunkUpRetryDelay:J["default"].CHUNK_UP_RETRY_DELAY,chunkTimeout:J["default"].CHUNK_TIMEOUT,chunkUpTimeout:J["default"].CHUNK_UP_TIMEOUT}),J["default"].RY_TRACK&&(h+="1",RY.srTracker.track(h,g)),this.realytics_count++},b.prototype.trackKlaraGlobal=function(h,g){var l=h.doubleDl;l.total=l.totalDlTwice,delete l.totalDlTwice;var k;h.peers&&(k={seeders:h.peers.seeders,leechers:h.peers.leechers,total:h.peers.totalPeers,useless:h.peers.uselessPeers,ready:h.peers.peerReady});var j=this.getPeersDetails(),i={id:F["default"].getMyPeerId(),p2p:h.nP2p,cdn:h.cdn,upload:h.up,rawP2p:h.p2pUncorrected,multipleDl:l,fullP2P:g,peers:k,peersDetails:j,p2pSgtCheckSuccess:h.nbRightHashP2P,p2pSgtCheckFail:h.nbWrongHashP2P,hybridSgtCheckSuccess:h.nbRightHashDLM,hybridSgtCheckFail:h.nbWrongHashDLM,trackSwitchCount:h.abr.internalTrackSwitchCount,droppedFrameCount:h.droppedFrameCount,trackerConnected:h.trackerConnected,trackerUpgraded:h.trackerUpgraded,signalingServerConnected:h.signalingServerConnected,meanMissedIceCandidate:h.missedIceCandidateRate,newPeerConnectionCount:h.newPeerConnectionCount,counter:h.downloadTrackCounter,live:this._playerInterface.isLive()};this.analyticsSender.track("global",i)},b.prototype.trackKlaraUnload=function(h){var g;h.qos.percentageTimeSpentPlaying&&(g=100-h.qos.percentageTimeSpentPlaying);var j;h.qos.avgBitrate&&(j=Math.round(1000*h.qos.avgBitrate));var i={startup:h.qos.startupTime,rebuffering:g,avgBitrate:j,live:this._playerInterface.isLive(),dispose:!!h.dispose};this.analyticsSender.track("unload",i)},b.prototype.sendDownloadAnalytics=function(){var aM=F["default"].getP2PDownloaded(),aL=F["default"].getp2pDownloadedNewAnalytics(),aK=0>aM?1:0,aJ=F["default"].getP2PUploaded(),aI=F["default"].getCDNDownloaded(),aH=F["default"].getCdnCancelled(),aG=F["default"].getP2PDownloadedUncorrected(),aF=F["default"].getDataDownloadedTwice_PP(),aE=F["default"].getDataDownloadedTwice_PC(),aD=F["default"].getDataDownloadedTwice_CP(),aC=F["default"].getDataDownloadedTwice_CC(),aB=F["default"].getDataDownloadedTwice_HP(),aA=F["default"].getDataDownloadedTwice_HD(),az=F["default"].getDataDownloadedTwice_M(),ay=aF+aE+aD+aC+aB+aA+az,ax=aM-this.lastP2PDownloaded,aw=aL-this.lastP2PDownloadedNewAnalytics,av=aJ-this.lastP2PUploaded,au=aI-this.lastCDNDownloaded,at=aH-this.lastCDNCancelled,ar=aG-this.lastP2PDownloadedUncorrected,aq=aF-this.lastDataDlTwice_PP,ap=aE-this.lastDataDlTwice_PC,ao=aD-this.lastDataDlTwice_CP,an=aC-this.lastDataDlTwice_CC,am=aB-this.lastDataDlTwice_HP,al=aA-this.lastDataDlTwice_HD,ak=az-this.lastDataDlTwice_M,aj=ay-this.lastDataDlTwice,ai=F["default"].getNbRightHashP2P(),ah=F["default"].getNbWrongHashP2P(),ag=F["default"].getNbRightHashDLM(),af=F["default"].getNbWrongHashDLM();F["default"].setNbRightHashP2P(0),F["default"].setNbWrongHashP2P(0),F["default"].setNbRightHashDLM(0),F["default"].setNbWrongHashDLM(0);var ae=this.trackPeers(),ad=this.trackTracker(),ac=F["default"].getConnectedToSignalingServer(),ab=this.missedIceCandidateDelta.calcDelta(F["default"].getMissedIceCandidateCount()),aa=this.newPeerConnectionCountDelta.calcDelta(F["default"].getNewPeerConnectionCount()),Z=ab?ab/aa:0;aa===F["default"].getNewPeerConnectionCount()&&(aa=void 0);var Y=this.trackABR(),X=0;if(this.mediaStats){var W=this.mediaStats.getStats();W.droppedFrameCount&&(X=this.droppedFramesDelta.calcDelta(this.mediaStats.getStats().droppedFrameCount))}var V=F["default"].getConnected()?1:0,U=F["default"].getUpgraded()?1:0;this.lastP2PDownloaded=aM,this.lastP2PDownloadedNewAnalytics=aL,this.lastP2PUploaded=aJ,this.lastCDNDownloaded=aI,this.lastDataDlTwice=ay;var k={missedIceCandidateRate:Z,newPeerConnectionCount:aa,p2p:ax,nP2p:aw,cdn:au,cdnCancelled:at,totalDl:ax+au,up:av,p2pUncorrected:ar,doubleDl:{PP:aq,PC:ap,CP:ao,CC:an,HP:am,HD:al,M:ak,totalDlTwice:aj},testP2PNegative:aK,peers:ae,nbRightHashP2P:ai,nbWrongHashP2P:ah,nbRightHashDLM:ag,nbWrongHashDLM:af,avgDistance:this.nbDistance>0?this.sumDistance/this.nbDistance:0,maxDistance:this.maxDistance,uploadSaturation:this.uploadSaturation,abr:Y,tracker:ad,droppedFrameCount:X,trackerConnected:V,trackerUpgraded:U,downloadTrackCounter:this.downloadTrackCounter,signalingServerConnected:ac};this.track_realytics("download",k,!0),this.trackKlaraGlobal(k,aM),this.lastCDNCancelled=aH,this.lastP2PDownloadedUncorrected=aG,this.lastDataDlTwice_PP=aF,this.lastDataDlTwice_PC=aE,this.lastDataDlTwice_CP=aD,this.lastDataDlTwice_CC=aC,this.lastDataDlTwice_HP=aB,this.lastDataDlTwice_HD=aA,this.lastDataDlTwice_M=az,this.uploadSaturation=0,this.downloadTrackCounter++},b.prototype.trackSpeed=function(){return{avgDl:Math.round(F["default"].getAvgDlSpeed()),maxDl:Math.round(F["default"].getMaxDlSpeed()),avgUp:Math.round(F["default"].getAvgUpSpeed()),maxUp:Math.round(F["default"].getMaxUpSpeed())}},b.prototype.incrementUploadSaturation=function(){this.uploadSaturation++},b.prototype.sendUnloadPayload=function(ah){if(this.p2pDownloader){this.sendDownloadAnalytics();var ag=F["default"].getP2PDownloaded(),af=F["default"].getp2pDownloadedNewAnalytics(),ae=F["default"].getP2PUploaded(),ad=F["default"].getCDNDownloaded(),ac=F["default"].getP2PDownloadedUncorrected(),ab=F["default"].getDataDownloadedTwice_PP(),aa=F["default"].getDataDownloadedTwice_PC(),Z=F["default"].getDataDownloadedTwice_CP(),Y=F["default"].getDataDownloadedTwice_CC(),X=F["default"].getDataDownloadedTwice_HP(),W=F["default"].getDataDownloadedTwice_HD(),V=F["default"].getDataDownloadedTwice_M(),U=ab+aa+Z+Y+X+W+V,T=this._p2pCache.doubleCheckP2PDownload_CDNDownload(),S=T.p2pDownloaded+T.cdnDownloaded,R=this.trackPeers(),Q=this.trackSpeed(),P=this.trackTrackerConnection(),O=this.getRandomPeerLatency(),N=this.trackQoS(),k={timeBeforeTrackerReady:this.timeBeforeTrackerReady,p2p:ag,nP2p:af,cdn:ad,totalDl:ag+ad,up:ae,p2pUncorrected:ac,doubleDl:{PP:ab,PC:aa,CP:Z,CC:Y,HP:X,HD:W,M:V,totalDlTwice:U},tracker:{peerUpdateRequestCount:F["default"].getPeerUpdateRequestCount(),peerUpdateResponseCount:F["default"].getPeerUpdateResponseCount()},qos:N,connection:P,p2pCache:S,speeds:Q,peers:R,peerConnectionLatency:O,dispose:ah?1:0};this.trackKlaraUnload(k),this.track_realytics("unload",k,!0),this.isUnloadPayloadSent=!0}},b.prototype.onUnload=function(g){this.isUnloadPayloadSent||this.sendUnloadPayload(!g)},b.prototype.onTrackerReady=function(){this.timeBeforeTrackerReady=Date.now()-this.apiStartTimestamp},b.prototype.trackPeers=function(){if(this.peerPool){var h=0,g=0,k=0,j=0,i=0;return H["default"].each(this.peerPool.getPeerArray(),function(m){k++,i++;var l=!0;m.getDataDownloaded()&&(h++,l=!1),m.getDataUploaded()&&(g++,l=!1),l&&j++},this),{seeders:h,leechers:g,totalPeers:k,uselessPeers:j,peerReady:i}}},b.prototype.getPeersDetails=function(){if(this.peerPool){var g=[];return this.peerPool.getPeerArray().forEach(function(h){g.push({id:h.getId(),downloaded:h.getDataDownloaded(),uploaded:h.getDataUploaded(),bufferLevel:h.getBufferLevel(),rtt:h.getRtt()})}),g}},b.prototype.findPeer=function(h){var g=H["default"].where(this.peerConnecting,{peer:h});return g.length?g[0]:!1},b.prototype.getRandomPeerLatency=function(h){var g=H["default"].filter(this.peerConnecting,function(j){return j.timestampAnswer&&j.timeStampReady});if(g.length){var i=g[Math.floor(Math.random()*g.length)];return{answer:i.timestampAnswer-i.timestampOffer,ready:i.timeStampReady-i.timestampOffer,distance:i.peer.getDistance()}}return void 0},b.prototype.trackABR=function(){var i,h=F["default"].getTrackSwitchCount(),n={minSwitchCount:0,lowerSwitchCount:0,upperSwitchCount:0};this.mediaStats&&(i=this.mediaStats.getStats(),n=(0,c.overrideDefaults)(n,i));var m=n.minSwitchCount-this.lastMinSwitchCount,l=n.lowerSwitchCount-this.lastLowerSwitchCount,k=n.upperSwitchCount-this.lastUpperSwitchCount,j=h-this.lastInternalTrackSwitchCount;return this.lastMinSwitchCount=n.minSwitchCount,this.lastLowerSwitchCount=n.lowerSwitchCount,this.lastUpperSwitchCount=n.upperSwitchCount,this.lastInternalTrackSwitchCount=h,{minSwitchCount:m,lowerSwitchCount:l,upperSwitchCount:k,internalTrackSwitchCount:j}},b.prototype.trackQoS=function(){var h,g=F["default"].getTrackSwitchCount(),i={startupTime:0,startupTimeLoad:0,rebufferingCount:0,timeSpentRebuffering:0,timeSpentPlaying:0,timeSpentSeeking:0,percentageTimeSpentPlaying:0,avgBitrate:0,bitrateSwitchCount:0,minSwitchCount:0,lowerSwitchCount:0,upperSwitchCount:0};return this.mediaStats&&(h=this.mediaStats.getStats(),i=(0,c.overrideDefaults)(i,h)),i.internalTrackSwitchCount=g,i},b.prototype.trackTracker=function(){var h=F["default"].getTrackerMsgCount(),g=F["default"].getTrackerSgnCount(),j=h-this.lastTrackerMsgCount,i=g-this.lastTrackerSgnCount;return this.lastTrackerMsgCount=h,this.lastTrackerSgnCount=g,{trackerMsgCount:j,trackerSgnCount:i,peerUpdateRequestCount:this.peerUpdateRequestDelta.calcDelta(F["default"].getPeerUpdateRequestCount()),peerUpdateResponseCount:this.peerUpdateResponseDelta.calcDelta(F["default"].getPeerUpdateResponseCount()),peerUpdateAvgRespTime:Math.round(F["default"].getPeerUpdateAvgResponseTime())}},b.prototype.trackTrackerConnection=function(){var h=F["default"].getTrackerConnectionCount(),g=F["default"].getTrackerDeconnectionCount(),i=F["default"].getTrackerReconnectionCount();return{trackerConnectionCount:h,trackerDeconnectionCount:g,trackerReconnectionCount:i}},b.prototype.dispose=function(){this.onUnload();var h=document.querySelectorAll('script[src*="realytics"');this._timers.clearAll();for(var g=0;g<h.length;g++){h[g].remove()}delete this.peerPool,delete window.RY,this.errorAnalytics.dispose()},b.prototype.isFake=function(){return this.fake},f["default"]=b,d.exports=f["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../conf":242,"../p2p/GlobalEventBus":255,"../p2p/status":286,"../utils/Delta":297,"../utils/ObjectHelper":299,"../utils/Timers":302,"./AnalyticsClient":243,"./ErrorAnalytics":244,"babel-runtime/helpers/interop-require-default":331,underscore:338}],247:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("./TimedValue"),k=m(l),j=function(o){var f=[],t=o,s=function(){for(var b=-1,g=Date.now(),c=0;c<f.length&&g-f[c].timestamp()>t;c++){b=c}return b},r=function(){var b=s();b>-1&&f.splice(0,b+1)},q=function(b){if(0!==b){r();var d=new k["default"](b);f.push(d)}},p=function(){if(r(),!f.length){return 0}for(var b=0,d=0;d<f.length;d++){b+=f[d].value()}return b/f.length};this.addPoint=q,this.compute=p};n["default"]=j,h.exports=n["default"]},{"./TimedValue":248,"babel-runtime/helpers/interop-require-default":331}],248:[function(f,e,h){Object.defineProperty(h,"__esModule",{value:!0});var g=function(i){var d=i,j=Date.now();this.timestamp=function(){return j},this.value=function(){return d}};h["default"]=g,e.exports=h["default"]},{}],249:[function(t,s,r){var q=t("babel-runtime/core-js/get-iterator")["default"],p=t("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var o=t("../../conf"),n=p(o),m=t("../utils/Timers"),l=p(m),k=function(C,B){function A(){if(y()+n["default"].NB_CHUNK_DL_GROUP*n["default"].CHUNK_SIZE/1024<n["default"].MAX_DL_REQUEST_SPEED){for(var b=0;b<n["default"].NB_CHUNK_DL_GROUP;b++){z()}}}function z(){var K=i.getSegmentListToDownload().slice(0,n["default"].NB_SEGMENT_P2P_PREBUFFER),J=!0,I=!1,H=void 0;try{for(var G,F=function(){var f=G.value,e=g.getOrCreateSegmentHandler(f),L=e.seeders.getNextSeeder(e.chunkManager.chunkNumber);if(L){var h=function(){var b=e.chunkManager.getNextChunk();return b>=0?(L.requestChunk(f,b),w(),u.setTimeout(function(){e.chunkManager.timeOut(b),L.getHeuristic().incrementNbChunkTimeOut()},n["default"].CHUNK_TIMEOUT),{v:{v:void 0}}):void 0}();if("object"==typeof h){return h.v}}},E=q(K);!(J=(G=E.next()).done);J=!0){var D=F();if("object"==typeof D){return D.v}}}catch(j){I=!0,H=j}finally{try{!J&&E["return"]&&E["return"]()}finally{if(I){throw H}}}}function y(){var b=x();return b===!1?d=[]:b>0&&d.splice(0,b),d.length*n["default"].CHUNK_SIZE/1024}function x(){for(var e=Date.now(),c=0;c<d.length;c++){if(e-d[c]<=1000){return c}}return !1}function w(){var b=Date.now();d.push(b)}function v(){u.clearAll()}var u=new l["default"],i=B,g=C,d=[];u.setInterval(A,n["default"].TIME_BETWEEN_CHUNK_DL),this.addChunkRequest=w,this.dispose=v};r["default"]=k,s.exports=r["default"]},{"../../conf":242,"../utils/Timers":302,"babel-runtime/core-js/get-iterator":310,"babel-runtime/helpers/interop-require-default":331}],250:[function(D,C,B){var A=D("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(B,"__esModule",{value:!0});var z=D("./status"),y=A(z),x=D("../../conf"),w=A(x),v=D("./PartialSegment/PartialSegmentP2P"),u=A(v),t=D("eventemitter3"),s=A(t),r=D("../security/callHashWorker"),q=A(r),p=function(g,f,j,i){var h=new s["default"];this.p2pCache=f,this.dataLocked=!1,this._isEmpty=!0,this._segmentCoord=g,this.downloadStatus=[],this.getEE=function(){return h},this._segmentRequestQueue=j,this._segmentInfoMap=i};p.prototype.addSegmentSize=function(d){if(!this.size){this.size=d,this.chunkNumber=Math.ceil(this.size/w["default"].CHUNK_SIZE);for(var c=0;c<this.chunkNumber;c++){this.downloadStatus.push("pending")}this.segment=new Uint8Array(this.size)}},p.prototype.getChunk=function(b){return this.dataLocked||"downloaded"!=this.downloadStatus[b]&&"CDNdownloaded"!=this.downloadStatus[b]?(this.dataLocked,!1):b<this.chunkNumber-1?this.segment.buffer.slice(b*w["default"].CHUNK_SIZE,(b+1)*w["default"].CHUNK_SIZE):this.segment.buffer.slice(b*w["default"].CHUNK_SIZE)},p.prototype.getNextChunk=function(){var b=this.downloadStatus.indexOf("failed");return 0>b&&(b=this.downloadStatus.indexOf("pending")),b>=0&&(this.downloadStatus[b]="downloading"),b},p.prototype.chunkDownloaded=function(f,e){if(this._isEmpty=!1,"downloaded"===this.downloadStatus[e]){y["default"].correctP2PDownloaded(f.byteLength,"PP")}else{if("CDNdownloaded"===this.downloadStatus[e]){y["default"].correctP2PDownloaded(f.byteLength,"CP")}else{if(this.downloadStatus[e]="downloaded",y["default"].setp2pDownloadedNewAnalytics(y["default"].getp2pDownloadedNewAnalytics()+f.byteLength),this.segment.set(new Uint8Array(f),e*w["default"].CHUNK_SIZE),this.isSegmentDownloaded()){var h=this.segment.buffer,g=this.p2pCache.getSegmentHandler(this._segmentCoord);g.seeders.cleanAfterDownloaded(),this.lockSegmentData(),this._checkHashP2P(h)}}}},p.prototype.timeOut=function(b){"downloading"===this.downloadStatus[b]&&(this.downloadStatus[b]="failed")},p.prototype.isSegmentDownloaded=function(){if(this.size){for(var b=this.downloadStatus.length-1;b>=0;b--){if("downloaded"!==this.downloadStatus[b]&&"CDNdownloaded"!==this.downloadStatus[b]){return !1}}return !0}return !1},p.prototype.shouldDownloadSegment=function(){return !(this.isSegmentDownloaded()||this.partialSegment)},p.prototype.getPartialSegment=function(){if(this.size&&!this._isEmpty){var b=this.partialSegment||new u["default"](this._segmentCoord,this.p2pCache,this.segment,this.downloadStatus,this.size,this,this.isSegmentDownloaded(),this._segmentInfoMap);return this.dataLocked||(this.partialSegment=b),b}return !1},p.prototype.getIndexLastChunkInARow=function(){for(var b=0;b<this.downloadStatus.length;b++){if("downloaded"!==this.downloadStatus[b]&&"CDNdownloaded"!==this.downloadStatus[b]){return b-1}}return this.downloadStatus.length-1},p.prototype.storeSegment=function(b){this._isEmpty=!1,this.size||this.addSegmentSize(b.byteLength),this.segment=new Uint8Array(b),this._updateDownloadStatus()},p.prototype._updateDownloadStatus=function(){var e;e={start:0,end:this.chunkNumber},this.partialSegment&&this.partialSegment.getCDNIndexRange()&&(e=this.partialSegment.getCDNIndexRange());for(var d=e.start;d<e.end;d++){if("downloaded"===this.downloadStatus[d]||"CDNdownloaded"===this.downloadStatus[d]){var f=w["default"].CHUNK_SIZE;d===this.chunkNumber-1&&(f=this.size-(this.chunkNumber-1)*w["default"].CHUNK_SIZE),"downloaded"===this.downloadStatus[d]?y["default"].correctP2PDownloaded(f,"PC"):"CDNdownloaded"===this.downloadStatus[d]&&y["default"].correctP2PDownloaded(f,"CC")}this.downloadStatus[d]="CDNdownloaded"}},p.prototype.getP2PDownload_CDNDownload=function(){var g=0,f=0;if(this.size){for(var j=0,i=this.downloadStatus.length-1;i>j;j++){"downloaded"===this.downloadStatus[j]?g+=w["default"].CHUNK_SIZE:"CDNdownloaded"===this.downloadStatus[j]&&(f+=w["default"].CHUNK_SIZE)}var h=this.size-(this.chunkNumber-1)*w["default"].CHUNK_SIZE;"downloaded"===this.downloadStatus[this.chunkNumber-1]?g+=h:"CDNdownloaded"===this.downloadStatus[this.chunkNumber-1]&&(f+=h)}return{p2pDownloaded:g,cdnDownloaded:f}},p.prototype.lockSegmentData=function(){this.dataLocked=!0},p.prototype.unlockSegmentData=function(){this.dataLocked=!1},p.prototype.removePartialSegment=function(){delete this.partialSegment},p.prototype._checkHashP2P=function(f){var e=this,h=this._segmentInfoMap.getSegmentInfo(this._segmentCoord),g=function(b,c){h.hash===c?(y["default"].setNbRightHashP2P(y["default"].getNbRightHashP2P()+1),e.segment=new Uint8Array(b),e.unlockSegmentData(),e._segmentRequestQueue.answerRequests(h.segmentCoord,e.chunkNumber)):(y["default"].setNbWrongHashP2P(y["default"].getNbWrongHashP2P()+1),e.p2pCache.removeSegmentHandler(h.segmentCoord),y["default"].correctP2PDownloaded(e.size,"HP"))};(0,q["default"])(f,g)},B["default"]=p,C.exports=B["default"]},{"../../conf":242,"../security/callHashWorker":292,"./PartialSegment/PartialSegmentP2P":264,"./status":286,"babel-runtime/helpers/interop-require-default":331,eventemitter3:162}],251:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("./status"),k=m(l),j=function(f,e){function o(p,d,s,r){var q=g.getSegmentHandler(d).chunkManager;q?q.chunkDownloaded(r,s):k["default"].correctP2PDownloaded(r.byteLength,"M"),p.getHeuristic().incrementNbChunkDownloaded()}var g=f;e.getEE().on("chunkReceived",o)};n["default"]=j,h.exports=n["default"]},{"./status":286,"babel-runtime/helpers/interop-require-default":331}],252:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("./UploadQueue"),k=m(l),j=function(g,f){function q(e,d,u){var t=Date.now(),s=p.getSegmentHandler(d).chunkManager;if(s){var r=s.getChunk(u);r&&o.add(e,d,u,r,t)}}var p=g,o=new k["default"];f.getEE().on("chunkRequested",q)};n["default"]=j,h.exports=n["default"]},{"./UploadQueue":274,"babel-runtime/helpers/interop-require-default":331}],253:[function(r,q,p){var o=r("babel-runtime/helpers/create-class")["default"],n=r("babel-runtime/helpers/class-call-check")["default"],m=r("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(p,"__esModule",{value:!0});var l=r("../utils/Timers"),k=m(l),j=function(){function b(c){n(this,b),this._exclusionArray=[],this._timers=new k["default"],this._retentionTime=c}return o(b,[{key:"add",value:function(d){var c=this;this._exclusionArray.push(d),this._timers.setTimeout(function(){c._exclusionArray.splice(0,1)},this._retentionTime)}},{key:"getExclusionList",value:function(){return this._exclusionArray}},{key:"dispose",value:function(){this._timers.clearAll()}}]),b}();p["default"]=j,q.exports=p["default"]},{"../utils/Timers":302,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],254:[function(f,e,h){Object.defineProperty(h,"__esModule",{value:!0});var g=function(z){var y=z,x={},w=[],v=[],u=function(b,d){w.push({eventName:b,fn:d}),y.addEventListener(b,d)},t=function(d,c){v.push({eventName:d,fn:c}),window.addEventListener(d,c)},s=function(){for(var b=0;b<w.length;b++){var i=w[b].eventName,d=w[b].fn;y.removeEventListener(i,d)}w=[]},r=function(){for(var i=0;i<v.length;i++){var d=v[i].eventName,j=v[i].fn;window.removeEventListener(d,j)}v=[]},q=function(){s(),r()},p=function(d){function c(){x[d].arguments=arguments}return x[d]={arguments:void 0,handler:c},c},o=function(b){y.addEventListener(b,p(b))},n=function(b,c){x[b]&&(y.removeEventListener(b,x[b].handler),x[b].arguments&&c.apply(void 0,x[b].arguments))};this.addMediaEventListener=u,this.addWindowEventListener=t,this.removeAllExternalEventListener=q,this.cacheMediaEvent=o,this.triggerCachedEvent=n};h["default"]=g,e.exports=h["default"]},{}],255:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("eventemitter3"),k=m(l),j=new k["default"];n["default"]=j,h.exports=n["default"]},{"babel-runtime/helpers/interop-require-default":331,eventemitter3:162}],256:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("../utils/Timers"),k=m(l),j=function(){var J=0.3,I=0,H=4000,G=0,F=0,E=0,D=0.5,C=0,B=new k["default"],A=function(){G++},z=function(){F++},y=function(){E++},x=function(){var b,d=F/G;return b=isNaN(d)?I:Math.min(d,1),C=b,b},w=function(){var c;return 0!==G&&(c=(1-J)*D+J*x(),D=c),D},v=function(){G=0,F=0,E=0},u=function(){w(),v()},t=function(){B.setInterval(u,H)},f=function(){B.clearAll()};this.incrementNbChunkRequested=function(){return A()},this.incrementNbChunkDownloaded=function(){return z()},this.incrementNbChunkTimeOut=function(){return y()},this.heurisInst=function(){return x()},this.mean=function(){return w()},this.getNbChunkRequested=function(){return G},this.getHeuristicScore=function(){return D},this.getLastHeuristInst=function(){return C},this.dispose=function(){f()},t()};n["default"]=j,h.exports=n["default"]},{"../utils/Timers":302,"babel-runtime/helpers/interop-require-default":331}],257:[function(f,e,h){Object.defineProperty(h,"__esModule",{value:!0});var g=function(j,i,l,k){this.city=j,this.country=i,this.latitude=l,this.longitude=k};h["default"]=g,e.exports=h["default"]},{}],258:[function(v,u,t){var s=v("babel-runtime/helpers/create-class")["default"],r=v("babel-runtime/helpers/class-call-check")["default"],q=v("babel-runtime/core-js/map")["default"],p=v("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=v("../utils/Delta"),n=v("../../conf"),m=p(n),l=function(){function b(c){r(this,b),this._mediaMap=c,this._cachedSegmentList=new q,this._cachedSegmentTime=new q}return s(b,[{key:"getSegmentList",value:function(g,f,j){var i=this._cachedSegmentList.get(g.viewToString());if(i&&i.beginTime===f&&i.duration===j){return i.cachedSegmentList}var h=this._mediaMap.getSegmentList(g,f,j);return this._cachedSegmentList.set(g.viewToString(),{beginTime:f,cachedSegmentList:h,duration:j}),h}},{key:"getSegmentTime",value:function(g){var f=this._cachedSegmentTime.get(g.viewToString());if((0,o.isNumeric)(f)){return f}var j=this._mediaMap.getSegmentTime(g);if(this._cachedSegmentTime.set(g.viewToString(),j),this._cachedSegmentTime.size>m["default"].GETSEGMENTTIME_CACHE_MAX_SIZE){var i=this._cachedSegmentTime.keys(),h=i.next().value;this._cachedSegmentTime["delete"](h)}return j}}]),b}();t["default"]=l,u.exports=t["default"]},{"../../conf":242,"../utils/Delta":297,"babel-runtime/core-js/map":312,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],259:[function(H,G,F){var E=H("babel-runtime/helpers/sliced-to-array")["default"],D=H("babel-runtime/helpers/to-consumable-array")["default"],C=H("babel-runtime/core-js/map")["default"],B=H("babel-runtime/core-js/get-iterator")["default"],A=H("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(F,"__esModule",{value:!0});var z=H("./structures/SegmentHandler"),y=A(z),x=H("../../conf"),w=A(x),v=H("./status"),u=A(v),t=H("../utils/Timers"),s=A(t),r=function(V,U,T,S){function R(h){var c=e.get(h.viewToString());return c?c:!1}function Q(m){var k=!0,Z=!1,Y=void 0;try{for(var X,W=B(e.values());!(k=(X=W.next()).done);k=!0){var q=X.value;q.seeders.removeSeeder(m)}}catch(o){Z=!0,Y=o}finally{try{!k&&W["return"]&&W["return"]()}finally{if(Z){throw Y}}}}function P(h){var c=R(h);return c===!1&&(c=new y["default"](h,this,d,L),e.set(c.segmentCoord.viewToString(),c),J.requestHasSegment(h),O()),c}function O(){var ap,ao=0,an=N()?w["default"].LIVE.P2P_CACHE_MAX_SIZE:w["default"].P2P_CACHE_MAX_SIZE,am=0,al=!0,ak=!1,aj=void 0;try{for(var ai,ah=B(e.values());!(al=(ai=ah.next()).done);al=!0){var ag=ai.value;if(ag.chunkManager.size&&(ao+=ag.chunkManager.size),ao>an){ap=e.size-am;break}am++}}catch(af){ak=!0,aj=af}finally{try{!al&&ah["return"]&&ah["return"]()}finally{if(ak){throw aj}}}if(ap){var ae=[],ad=!0,ac=!1,ab=void 0;try{for(var aa,Z=B(e);!(ad=(aa=Z.next()).done);ad=!0){var Y=E(aa.value,2),X=Y[0],W=Y[1];if(0===ap){break}ae.push(W),e["delete"](X),L.removeSegmentInfo(W.segmentCoord),ap--}}catch(af){ac=!0,ab=af}finally{try{!ad&&Z["return"]&&Z["return"]()}finally{if(ac){throw ab}}}}}function M(b){e["delete"](b.viewToString())}function K(){var ac=0,ab=0,aa=!0,Z=!1,Y=void 0;try{for(var X,W=B(e.values());!(aa=(X=W.next()).done);aa=!0){var q=X.value,o=q.chunkManager.getP2PDownload_CDNDownload();ac+=o.p2pDownloaded,ab+=o.cdnDownloaded}}catch(m){Z=!0,Y=m}finally{try{!aa&&W["return"]&&W["return"]()}finally{if(Z){throw Y}}}return u["default"].setCDNDoubleCheck(ab),u["default"].setP2PDoubleCheck(ac),{p2pDownloaded:ac,cdnDownloaded:ab}}function I(i,h){var m=P(i,h.byteLength),k=m.chunkManager;k.storeSegment(h),d.answerRequests(i,h.byteLength,k.chunkNumber)}function n(h){var c=R(h).chunkManager;return c?c.getPartialSegment():!1}function l(b){return[].concat(D(e)).filter(function(h){var k=E(h,2),i=(k[0],k[1]);return i.segmentCoord.isInTrack(b)&&!i.chunkManager.shouldDownloadSegment()}).map(function(i){var h=E(i,2),k=(h[0],h[1]);return k.segmentCoord})}function j(){return[].concat(D(e)).map(function(i){var h=E(i,2),k=(h[0],h[1]);return{segmentcoord:k.segmentCoord,downloadStatusList:k.chunkManager.downloadStatus,seederCount:k.seeders.getLength()}})}function g(b){return[].concat(D(e)).filter(function(h){var k=E(h,2),i=(k[0],k[1]);return i.segmentCoord.isInTrack(b)&&!i.chunkManager.isSegmentDownloaded()}).map(function(i){var h=E(i,2),k=(h[0],h[1]);return k.segmentCoord})}function f(){p.clearAll(),e=new C}var e=new C,d=V,N=U,L=S,J=T,p=new s["default"];K(),p.setInterval(K,10000),this.dispose=f,this.getOrCreateSegmentHandler=P,this.removeSegmentHandler=M,this.doubleCheckP2PDownload_CDNDownload=K,this.fillSegment=I,this.getSegmentHandler=R,this.getPartialSegment=n,this.removePeer=Q,this.listSegmentsToSkipForTrack=l,this.listSegmentsDownloadStatus=j,this.listDownloadedSegmentsForTrack=g};F["default"]=r,G.exports=F["default"]},{"../../conf":242,"../utils/Timers":302,"./status":286,"./structures/SegmentHandler":288,"babel-runtime/core-js/get-iterator":310,"babel-runtime/core-js/map":312,"babel-runtime/helpers/interop-require-default":331,"babel-runtime/helpers/sliced-to-array":332,"babel-runtime/helpers/to-consumable-array":333}],260:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("./UploadQueue"),k=m(l),j=function(B,A,z,y,x){var w=this,v=A,u=z,t=y,s=new k["default"](w),r=function(){B.getEE().on("hasSegment",q),B.getEE().on("peerDestroyed",p)},q=function(g,e,C){if(x.addSegmentInfo(C),v.isSegmentRequested(C.segmentCoord)){var o=u.getSegmentHandler(C.segmentCoord);o&&(o.chunkManager.addSegmentSize(C.size),o.seeders.insertSeeder(g))}},p=function(b){u.removePeer(b),t.removePeerRequests(b)},f=function(){s.dispose()};w.dispose=f,r()};n["default"]=j,h.exports=n["default"]},{"./UploadQueue":274,"babel-runtime/helpers/interop-require-default":331}],261:[function(v,u,t){var s=v("babel-runtime/helpers/get")["default"],r=v("babel-runtime/helpers/inherits")["default"],q=v("babel-runtime/helpers/create-class")["default"],p=v("babel-runtime/helpers/class-call-check")["default"],o=v("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(t,"__esModule",{value:!0});var n=v("./PartialSegmentInterface"),m=o(n),l=function(d){function c(b){p(this,c),s(Object.getPrototypeOf(c.prototype),"constructor",this).call(this),this._segmentCoord=b}return r(c,d),q(c,[{key:"getUpdatedRange",value:function(b){return b}},{key:"getFullSegment",value:function(f,e){e(f,this._segmentCoord)}},{key:"isComplete",value:function(){return !1}},{key:"isLocked",value:function(){return !1}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),c}(m["default"]);t["default"]=l,u.exports=t["default"]},{"./PartialSegmentInterface":262,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/get":329,"babel-runtime/helpers/inherits":330,"babel-runtime/helpers/interop-require-default":331}],262:[function(i,h,n){var m=i("babel-runtime/helpers/create-class")["default"],l=i("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(n,"__esModule",{value:!0});var k="Method not implemented",j=function(){function b(){l(this,b)}return m(b,[{key:"getUpdatedRange",value:function(c){throw new Error(k)}},{key:"getFullSegment",value:function(e,d,f){throw new Error(k)}},{key:"isComplete",value:function(){throw new Error(k)}},{key:"isLocked",value:function(){throw new Error(k)}},{key:"p2pSpeed",get:function(){throw new Error(k)}},{key:"p2pAmount",get:function(){throw new Error(k)}}]),b}();n["default"]=j,h.exports=n["default"]},{"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],263:[function(L,K,J){var I=L("babel-runtime/helpers/get")["default"],H=L("babel-runtime/helpers/inherits")["default"],G=L("babel-runtime/helpers/create-class")["default"],F=L("babel-runtime/helpers/class-call-check")["default"],E=L("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(J,"__esModule",{value:!0});var D=L("./PartialSegmentInterface"),C=E(D),B=L("../status"),A=E(B),z=L("../../security/callHashWorker"),y=E(z),x=L("../GlobalEventBus"),w=E(x),v=L("../structures/SegmentInfo"),u=E(v),t=function(d){function c(b,m,l,k){function j(f,e){function h(p,o){f.response=p;var n=m.getSegmentTime(g),i=new u["default"](g,p.byteLength,o,n);k.addSegmentInfo(i),l.fillSegment(g,f.response),w["default"].emit("piece_downloaded_prtl",g),e(f,g)}(0,y["default"])(f.response,h)}F(this,c),I(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var g=b;this.getFullSegment=function(f,e){w["default"].emit("CDNSegmentDownloaded",g);var h=f.response;A["default"].setCDNDownloaded(A["default"].getCDNDownloaded()+h.byteLength),j(f,e)}}return H(c,d),G(c,[{key:"isComplete",value:function(){return !1}},{key:"isLocked",value:function(){return !1}},{key:"getUpdatedRange",value:function(b){return b}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),c}(C["default"]);J["default"]=t,K.exports=J["default"]},{"../../security/callHashWorker":292,"../GlobalEventBus":255,"../status":286,"../structures/SegmentInfo":289,"./PartialSegmentInterface":262,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/get":329,"babel-runtime/helpers/inherits":330,"babel-runtime/helpers/interop-require-default":331}],264:[function(L,K,J){var I=L("babel-runtime/helpers/get")["default"],H=L("babel-runtime/helpers/inherits")["default"],G=L("babel-runtime/helpers/class-call-check")["default"],F=L("babel-runtime/core-js/object/define-properties")["default"],E=L("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(J,"__esModule",{value:!0});var D=L("../../../conf"),C=E(D),B=L("../status"),A=E(B),z=L("./PartialSegmentInterface"),y=E(z),x=L("../../security/callHashWorker"),w=E(x),v=L("../GlobalEventBus"),u=E(v),t=function(d){function c(af,ae,ad,ac,ab,aa,Z,Y){function X(i,h,n,m){function k(o,e){h.hash===e?(A["default"].setNbRightHashDLM(A["default"].getNbRightHashDLM()+1),i.response=o,V(i),n(i,r)):(A["default"].setNbWrongHashDLM(A["default"].getNbWrongHashDLM()+1),A["default"].setCdnDataDiscarded(A["default"].getCdnDataDiscarded()+g),ae.removeSegmentHandler(r),A["default"].correctP2PDownloaded(W,"HD"),m(i,r))}(0,w["default"])(i.response,k)}function V(e){P=e.response,ae.fillSegment(r,e.response),u["default"].emit("piece_downloaded_prtl",r),R=!1,aa.unlockSegmentData(),aa.removePartialSegment()}function S(){W=0;for(var e=0;e<N.length;e++){"downloaded"===N[e]&&(W+=e<N.length-1?C["default"].CHUNK_SIZE:ab-(N.length-1)*C["default"].CHUNK_SIZE)}}function Q(){for(var e=0;e<N.length;e++){if("downloaded"!==N[e]&&"CDNdownloaded"!==N[e]){return e}}}function O(){for(var e=N.length-1;e>=0;e--){if("downloaded"!==N[e]&&"CDNdownloaded"!==N[e]){return e+1}}}function M(i){if(!C["default"].RANGE_REQUEST_ALLOWED){return i}var h,n,m=Q(),k=O();return void 0!==m&&void 0!==k?(h=i?i.start+m*C["default"].CHUNK_SIZE:m*C["default"].CHUNK_SIZE,k===N.length&&i?n=i.end:k<N.length&&(n=i?i.start+k*C["default"].CHUNK_SIZE-1:k*C["default"].CHUNK_SIZE-1),b={start:m,end:k},{start:h,end:n}):i?i:void 0}function p(){P=ad.buffer.slice(),N=ac.slice(),S(),U=A["default"].getMeanInstantSpeed(),T=Z}function j(h){var e;if(void 0!==b&&void 0!==P){e=new Uint8Array(P);try{e.set(new Uint8Array(h),b.start*C["default"].CHUNK_SIZE)}catch(i){throw new Error("Invalid configuration: The current stream has no range request enabled and the p2p configuration has range request set to true.")}}else{e=new Uint8Array(h)}return e.buffer}function f(e){A["default"].setCDNDownloaded(A["default"].getCDNDownloaded()+e.byteLength)}G(this,c),I(Object.getPrototypeOf(c.prototype),"constructor",this).call(this);var b,W,U,T,R,P,N,r=af,l=Y,g=0;this.getFullSegment=function(i,h,n){if(i.p2pMeanThroughput=A["default"].computeP2PThroughput(),this.isComplete()){i.response=P,aa.removePartialSegment(),h(i,null)}else{u["default"].emit("CDNSegmentDownloaded",r);var m=i.response;if(f(m),g=m.byteLength,i.response=j(m),0!==W){R=!0,aa.lockSegmentData();var k=l.getSegmentInfo(r);X(i,k,h,n)}else{V(i),h(i,r)}}},this.getUpdatedRange=M,this.getCDNIndexRange=function(){return b},this.isComplete=function(){return T},this.isLocked=function(){return aa.dataLocked},p(),F(this,{p2pSpeed:{get:function(){return U},set:void 0},p2pAmount:{get:function(){return W},set:void 0}})}return H(c,d),c}(y["default"]);J["default"]=t,K.exports=J["default"]},{"../../../conf":242,"../../security/callHashWorker":292,"../GlobalEventBus":255,"../status":286,"./PartialSegmentInterface":262,"babel-runtime/core-js/object/define-properties":315,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/get":329,"babel-runtime/helpers/inherits":330,"babel-runtime/helpers/interop-require-default":331}],265:[function(e,d,f){(function(a3){function a2(){var g=window.RTCPeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection;return !(!g||aG.isMobile())}var a1=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(f,"__esModule",{value:!0});var a0=e("./P2PDownloader"),aZ=a1(a0),aY=e("./ChunkDownloader"),aX=a1(aY),aW=e("./ExternalEventManager"),aV=a1(aW),aU=e("./PartialSegment/PartialSegmentNoP2P"),aT=a1(aU),aS=e("./PartialSegment/PartialSegmentDisableP2P"),aR=a1(aS),aQ=e("./display/DisplayInterface"),aP=a1(aQ),aO=e("../analytics/VideoAnalytics"),aN=a1(aO),aM=e("./TrackerManager"),aL=a1(aM),aK=e("./peerPool"),aJ=a1(aK),aI=e("./P2PCache"),aH=a1(aI),aA=e("./SegmentUploader"),az=a1(aA),ay=e("./SegmentRequestQueue"),ax=a1(ay),aw=e("./ChunkUploader"),av=a1(aw),au=e("./ChunkReceivedObserver"),at=a1(au),ar=e("./Scheduler"),aq=a1(ar),ap=e("./SegmentInfoMap"),ao=a1(ap),an=e("./status"),am=a1(an),al=e("./moduleState"),ak=a1(al),aj=e("../../conf"),ai=a1(aj),ah=e("../utils/Timers"),ag=a1(ah),af=e("../utils/confHelper"),ae=a1(af),ad=e("./SRModuleInterface"),ac=a1(ad),ab=e("../../../graphs/private/BufferDisplay"),c=(a1(ab),e("../../../graphs/private/chunkDisplay")),aE=(a1(c),e("./expectedInterfaces/SegmentCoordInterface")),a5=a1(aE),aB=e("./expectedInterfaces/MapInterface"),a4=a1(aB),aF=e("./expectedInterfaces/TrackCoordInterface"),aC=a1(aF),b=e("../utils/Interface"),aG=e("../utils/uaHelper"),aD=function(bf,be,bd,bc,bb){(0,b.checkInterface)(a4["default"],bd),(0,b.checkInterface)(a5["default"],bb.prototype);var ba,a9,a8,a7,X,R,N,J,F,B,T,P,L,H,D,z=bc,x=new ag["default"],v=!1,t=function(g){var k=g.audio,i=g.video;k&&(0,b.checkInterface)(aC["default"],k),i&&(0,b.checkInterface)(aC["default"],i),ak["default"].content=be,am["default"].incrementTrackSwitchCount(),D.updateCurrentTracks({audio:k,video:i}),ak["default"].updateCurrentTracks({video:i})},r=function(g){am["default"].setCdnCancelled(am["default"].getCdnCancelled()+g)},n=function(){B&&(H.addMediaEventListener("cdnCancelled",r),H.addMediaEventListener("onTrackChange",t),T=new ao["default"],a9=new aL["default"](ai["default"].TRACKER_URL,bf),a8=new aJ["default"](a9,bb),R=new ax["default"](T),X=new aH["default"](R,bf.isLive.bind(bf),a8,T),N=new at["default"](X,a8),J=new az["default"](a8,R,T,X),F=new av["default"](X,a8),D=new aq["default"](bd,X),ba=new aX["default"](X,D),a7=new aZ["default"](a8,D,X,R,T),l(),H.triggerCachedEvent("onTrackChange",t),H.triggerCachedEvent("cdnCancelled",r),j()),v=!0},l=function(){L=new aN["default"](bf,H,be,X,a8,a7)},j=function a6(){!bf.areBuffersInitialized||bf.areBuffersInitialized()?ai["default"].DEBUG&&(P=new aP["default"](a8,bf.isLive.bind(bf))):x.setTimeout(a6,300)},h=function(){(0,ae["default"])(ai["default"],z),B=a2()&&ai["default"].ALLOW_P2P,B&&(am["default"].reset(),H=new aV["default"](bf),H.cacheMediaEvent("onMapUpdate"),H.cacheMediaEvent("cdnCancelled"),H.cacheMediaEvent("onTrackChange"))},p=function(i){if(!B){throw new Error("P2P is not activated, getP2PData can't be called")}var g;return v?g=B?X.getPartialSegment(i)||new aT["default"](i,bd,X,T):new aR["default"](i):(n(),g=new aR["default"](i)),D.updateTrackEdge(i),g},bg=function(i,g,k){return null!==k&&(0,b.checkInterface)(a5["default"],k),ac["default"].getSegment(this,i,g,k)},V=function(){B&&(v&&(H.removeAllExternalEventListener(),L.dispose(),ba.dispose(),X.dispose(),x.clearAll(),a8.dispose(),a7.dispose(),P&&P.dispose()),am["default"].dispose())};h(),this.getSegment=bg,this.getP2PData=p,this.dispose=V};f["default"]=aD,a3.Streamroot=a3.Streamroot||{},a3.Streamroot.uaHelper=aG,Object.defineProperty(a3.Streamroot,"p2pAvailable",{get:function(){return a2()}}),d.exports=f["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../graphs/private/BufferDisplay":306,"../../../graphs/private/chunkDisplay":308,"../../conf":242,"../analytics/VideoAnalytics":246,"../utils/Interface":298,"../utils/Timers":302,"../utils/confHelper":304,"../utils/uaHelper":305,"./ChunkDownloader":249,"./ChunkReceivedObserver":251,"./ChunkUploader":252,"./ExternalEventManager":254,"./P2PCache":259,"./P2PDownloader":260,"./PartialSegment/PartialSegmentDisableP2P":261,"./PartialSegment/PartialSegmentNoP2P":263,"./SRModuleInterface":266,"./Scheduler":267,"./SegmentInfoMap":269,"./SegmentRequestQueue":270,"./SegmentUploader":271,"./TrackerManager":273,"./display/DisplayInterface":279,"./expectedInterfaces/MapInterface":280,"./expectedInterfaces/SegmentCoordInterface":281,"./expectedInterfaces/TrackCoordInterface":282,"./moduleState":283,"./peerPool":285,"./status":286,"babel-runtime/helpers/interop-require-default":331}],266:[function(r,q,p){var o=r("babel-runtime/helpers/create-class")["default"],n=r("babel-runtime/helpers/class-call-check")["default"],m=r("underscore"),l=r("../../conf"),k=function(){},j=function(){function b(D,C,B,A){var z=C.url,y=C.headers,x=void 0===y?[]:y,w=C.withCredentials,v=this,u=B.onProgress,t=void 0===u?k:u,h=B.onError,g=void 0===h?k:h,e=B.onSuccess,E=void 0===e?k:e;n(this,b),this._request={url:z,headers:x,withCredentials:w},this._handlers={onProgress:t,onError:g,onSuccess:E},l.RETURN_COPY_SEGMENT&&!function(){var c=v._handlers.onSuccess;v._handlers.onSuccess=function(f,F,s){var i=f.slice(0);c(i,F,s)}}(),this._stats={cdnDownloaded:0,cdnDuration:0},this._srModule=D,this._segmentCoord=A}return o(b,[{key:"getSegment",value:function(){try{null===this._segmentCoord?this._getFullSegmentFromCDN():(this._partialSegment=this._srModule.getP2PData(this._segmentCoord),this._setP2PStats(),this._handlers.onProgress(this._stats,this._request),this._partialSegment.isComplete()?this._getFullP2PSegment():this._getRemainingRangeFromCDN())}catch(c){this._getFullSegmentFromCDN()}return this._abort.bind(this)}},{key:"_abort",value:function(){this._xhr&&this._xhr.abort(),this._handlers.onSuccess=k}},{key:"_getFullP2PSegment",value:function(){var c=this;this._waitSegmentUnlocked(function(d){d?c._fillSegment(void 0):c._getFullSegmentFromCDN()})}},{key:"_getRemainingRangeFromCDN",value:function(){var d=this,c=this._getRangeFromRequest();this._fallbackRange=c,this._rangeToDownload=this._partialSegment.getUpdatedRange(c),this._downloadFromCDN(this._rangeToDownload,function(e,f){return e?void d._handlers.onError(e,d._request):void d._fillSegment(f)})}},{key:"_downloadFromCDN",value:function(d,c){this._xhr=new XMLHttpRequest,this._xhr.open("GET",this._request.url,!0),this._xhr.responseType="arraybuffer",this._setXhrHandlers(c),this._setXhrHeaders(),this._setXhrUpdatedRange(d),this._xhr.withCredentials=!!this._request.withCredentials,this._xhr.send(),this._startDownloadCdn=new Date}},{key:"_setXhrHandlers",value:function(d){var c=this;this._xhr.onloadend=function(e){return c._xhr.status<200||c._xhr.status>206?void d(e):(c._stats.cdnDownloaded=c._xhr.response.byteLength||0,c._stats.cdnDuration=new Date-c._startDownloadCdn,void d(null,c._xhr.response))},this._xhr.onerror=d,this._xhr.onprogress=function(e){c._stats.cdnDownloaded=e.loaded,c._stats.cdnDuration=new Date-c._startDownloadCdn,c._handlers.onProgress(c._stats,c._request)}}},{key:"_setXhrHeaders",value:function(){var c=this;this._request.headers.forEach(function(d){"Range"===d[0]&&c._rangeToDownload||c._xhr.setRequestHeader(d[0],d[1])})}},{key:"_setXhrUpdatedRange",value:function(f){if(f){var e=f.start,h=f.end||"",g="bytes="+e+"-"+h;this._xhr.setRequestHeader("Range",g)}}},{key:"_fillSegment",value:function(g){var f=this,s=!1,i=function(c){return function(u,t){s||(s=!0,c.call(f,u,t))}};try{this._partialSegment.getFullSegment({response:g},i(this._onSuccessAsynchronous),i(this._getFullSegmentFromCDN))}catch(h){return void this._getFullSegmentFromCDN()}setTimeout(function(){s||(s=!0,f._getFullSegmentFromCDN())},l.TIMEOUT_GET_FULL_SEGMENT)}},{key:"_waitSegmentUnlocked",value:function(f){var e=this;if(!this._partialSegment.isLocked()){return void f(!0)}var h=0,g=setInterval(function(){return e._partialSegment=e._srModule.getP2PData(e._segmentCoord),e._partialSegment.isLocked()?(h+=l.LOCKED_RETRY_INTERVAL,void (h>l.LOCKED_RETRY_TIMEOUT&&(clearInterval(g),f(!1)))):(clearInterval(g),void f(!0))},l.LOCKED_RETRY_INTERVAL)}},{key:"_getRangeFromRequest",value:function(){var e=m.find(this._request.headers,function(c){return"Range"===c[0]});if(e){var d=e[1].split("="),f=d[1].split("-");return{start:parseInt(f[0],10),end:parseInt(f[1],10)}}}},{key:"_getFullSegmentFromCDN",value:function(){var c=this;this._stats={p2pDownloaded:0,p2pDuration:0},this._downloadFromCDN(this._fallbackRange,function(d,e){return d?void c._handlers.onError(d,c._request):void c._handlers.onSuccess(e,c._stats,c._request)})}},{key:"_setP2PStats",value:function(){this._stats.p2pDownloaded=this._partialSegment.p2pAmount,this._stats.p2pDuration=0===this._partialSegment.p2pSpeed?0:Math.round(this._partialSegment.p2pAmount/this._partialSegment.p2pSpeed*1000)}},{key:"_onSuccessAsynchronous",value:function(d){var c=this;setTimeout(function(){c._handlers.onSuccess(d.response,c._stats,c._request)},0)}}]),b}();q.exports={getSegment:function(g,f,s,i){var h=new j(g,f,s,i);return h.getSegment()}}},{"../../conf":242,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,underscore:338}],267:[function(N,M,L){var K=N("babel-runtime/helpers/create-class")["default"],J=N("babel-runtime/helpers/class-call-check")["default"],I=N("babel-runtime/helpers/define-property")["default"],H=N("babel-runtime/helpers/to-consumable-array")["default"],G=N("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(L,"__esModule",{value:!0});var F=N("underscore"),E=G(F),D=N("../../conf"),C=G(D),B=N("./structures/CurrentTracksStruct"),A=G(B),z=N("../utils/Delta"),y=N("./structures/TrackEdges"),x=G(y),w=N("./MediaMapCache"),v=G(w),u=function(){function b(d,e){J(this,b),this._p2pCache=e,this.currentTracks=new A["default"],this._edges=new x["default"],this._mediaMapCache=new v["default"](d)}return K(b,[{key:"getSegmentListToDownload",value:function(){var d=this,c=[];return[].concat(H(this.currentTracks)).forEach(function(l){var k=d._edges[l.type];if((0,z.isNumeric)(k)){var j=d._mediaMapCache.getSegmentList(l.coord,k,C["default"].MAX_BUFFER_DURATION),i=d._p2pCache.listSegmentsToSkipForTrack(l.coord),h=d._getDifference(j,i);c=c.concat(h)}}),c.sort(function(f,i){var h=d._mediaMapCache.getSegmentTime(f),g=d._mediaMapCache.getSegmentTime(i);return h-g})}},{key:"updateTrackEdge",value:function(f){var e=E["default"].find([].concat(H(this.currentTracks)),function(c){return f.isInTrack(c.coord)});if(void 0!==e){var h=e.type,g=this._mediaMapCache.getSegmentTime(f);this._edges.update(I({},h,g))}}},{key:"updateCurrentTracks",value:function(c){this.currentTracks.update(c)}},{key:"_getDifference",value:function(d,c){return E["default"].reject(d,function(e){return void 0!==E["default"].find(c,function(f){return e.isEqual(f)})})}},{key:"isSegmentRequested",value:function(c){return this.getSegmentListToDownload().reduce(function(d,e){return d||e.isEqual(c)},!1)}}]),b}();L["default"]=u,M.exports=L["default"]},{"../../conf":242,"../utils/Delta":297,"./MediaMapCache":258,"./structures/CurrentTracksStruct":287,"./structures/TrackEdges":290,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/define-property":328,"babel-runtime/helpers/interop-require-default":331,"babel-runtime/helpers/to-consumable-array":333,underscore:338}],268:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("underscore"),k=m(l),j=function(){var o=[],f=0,t=function(d){for(var e=0;e<o.length;){if(o[e].getHeuristic().getHeuristicScore()<=d.getHeuristic().getHeuristicScore()){return void o.splice(e,0,d)}e++}o.push(d)},s=function(c){o=k["default"].reject(o,function(b){return b===c})},r=function(){for(var d=0,e=0;e<o.length;e++){d+=o[e].getHeuristic().getHeuristicScore()}return d},q=function(v){var u,e=Math.floor(Math.random()*o.length);switch(f){case 0:if(0!==o.length){u=o[e];for(var b=0;b<o.length;b++){if(o[b].getHeuristic().getNbChunkRequested()/o[b].getHeuristic().getHeuristicScore()<=o[o.length-1].getHeuristic().getNbChunkRequested()/o[o.length-1].getHeuristic().getHeuristicScore()&&o[b].canBeAskedChunk()){u=o[b];break}}}break;case 1:if(0!==o.length){u=o[e];for(var b=0;b<o.length;b++){if(Math.random()<=o[b].getHeuristic().getHeuristicScore()&&o[b].canBeAskedChunk()){u=o[b];break}}}break;case 2:if(0!==o.length){u=o[e];for(var b=0;b<o.length;b++){if(o[b].getHeuristic().getNbChunkRequested()<=Math.floor(o[b].getHeuristic().getHeuristicScore()/r()*v+1)&&o[b].canBeAskedChunk()){u=o[b];break}}}break;case 3:if(0!==o.length){u=o[e];for(var b=0;b<o.length;b++){if(o[b].getHeuristic().getNbChunkRequested()/o[b].getHeuristic().getHeuristicScore()<=o[b+1].getHeuristic().getNbChunkRequested()/o[b+1].getHeuristic().getHeuristicScore()&&o[b].canBeAskedChunk()){u=o[b];break}}}break;default:u=!1}return u},p=function(){o=[]};this.getNextSeeder=function(b){return q(b)},this.insertSeeder=function(b){t(b)},this.removeSeeder=function(b){s(b)},this.cleanAfterDownloaded=function(){p()},this.getLength=function(){return o.length}};n["default"]=j,h.exports=n["default"]},{"babel-runtime/helpers/interop-require-default":331,underscore:338}],269:[function(i,h,n){var m=i("babel-runtime/helpers/create-class")["default"],l=i("babel-runtime/helpers/class-call-check")["default"],k=i("babel-runtime/core-js/map")["default"];Object.defineProperty(n,"__esModule",{value:!0});var j=function(){function b(){l(this,b),this._map=new k}return m(b,[{key:"addSegmentInfo",value:function(d){var c=d.segmentCoord.viewToString();this._map.set(c,d)}},{key:"getSegmentInfo",value:function(e){var d=e.viewToString(),f=this._map.get(d);if(!f){throw new Error("segmentInfo not found in the map")}return f}},{key:"removeSegmentInfo",value:function(d){var c=d.viewToString();this._map["delete"](c)}}]),b}();n["default"]=j,h.exports=n["default"]},{"babel-runtime/core-js/map":312,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],270:[function(g,f,j){Object.defineProperty(j,"__esModule",{value:!0});var i=g("underscore"),h=function(b){this._segmentInfoMap=b,this.segmentRequests=[],this.peerTimeouts={}};h.prototype.queue=function(d,c){this.segmentRequests.push({segmentCoord:c,peer:d})},h.prototype.answerRequests=function(k,d){var n,m=i.filter(this.segmentRequests,function(c){return k.isEqual(c.segmentCoord)},this),l=this._segmentInfoMap.getSegmentInfo(k);for(n=0;n<m.length;n++){m[n].peer.answerHasSegment(l,d)}this.segmentRequests=i.reject(this.segmentRequests,function(c){return k.isEqual(c.segmentCoord)},this)},h.prototype.removePeerRequests=function(b){this.segmentRequests=i.reject(this.segmentRequests,function(c){return c.peer===b},this)},j["default"]=h,f.exports=j["default"]},{underscore:338}],271:[function(f,e,h){Object.defineProperty(h,"__esModule",{value:!0});var g=function(r,q,p,o){function n(s,i){var v=k.getSegmentHandler(i).chunkManager;if(v){var u=v.getIndexLastChunkInARow();if(u>-1){var t=m.getSegmentInfo(i);return void s.answerHasSegment(t,u)}}j.queue(s,i)}var m=p,l=r,k=o,j=q;l.getEE().on("segmentRequested",n)};h["default"]=g,e.exports=h["default"]},{}],272:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("../../conf"),k=m(l),j=function(){this.transferedChunks=[]};j.prototype.calculateSpeed=function(){var b=this.getIndexTransferOneSecondAgo();return b===!1?this.transferedChunks=[]:b>0&&this.transferedChunks.splice(0,b),this.transferedChunks.length*k["default"].CHUNK_SIZE/1024},j.prototype.getIndexTransferOneSecondAgo=function(){for(var d=Date.now(),c=0;c<this.transferedChunks.length;c++){if(d-this.transferedChunks[c]<=1000){return c}}return !1},j.prototype.addChunkTransfer=function(){var b=Date.now();this.transferedChunks.push(b)},n["default"]=j,h.exports=n["default"]},{"../../conf":242,"babel-runtime/helpers/interop-require-default":331}],273:[function(N,M,L){var K=N("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(L,"__esModule",{value:!0});var J=N("../../conf"),I=K(J),H=N("socket.io-client"),G=K(H),F=N("./status"),E=K(F),D=N("eventemitter3"),C=K(D),B=N("./Location"),A=K(B),z=N("./moduleState"),y=K(z),x=N("../utils/Timers"),w=K(x),v=function(e,d){var f=new C["default"];this.p2pProtocolVersion="2.0.0",this.client2ClientProtocolVersion="2.0.0",this._playerInterface=d,this.trackerURL=e,this.connect(),this._timers=new w["default"],this.instantiatedTime=Date.now(),this.getEE=function(){return f}};v.prototype.connect=function(){this.socket||(this.socket=G["default"].connect(this.trackerURL,{"force new connection":!0,query:{protocol_version:I["default"].CLIENT_TRACKER_PROTOCOL_VERSION,client_id:I["default"].ID_CLIENT},reconnectionDelay:2000,reconnectionDelayMax:300000}),this.socket.on("connect",this.onTrackerConnected.bind(this)),this.socket.on("reconnecting",this.onTrackerReconnecting.bind(this)),this.socket.on("disconnect",this.onTrackerDisconnected.bind(this)),this.socket.on("reconnect",this.onTrackerReconnect.bind(this)),this.socket.on("get_current_tracks",this.onGetCurrentTracks.bind(this)))};var u=function(b){switch(b){case"offer":case"answer":case"icecandidate":E["default"].setTrackerSgnCount(E["default"].getTrackerSgnCount()+1);break;default:E["default"].setTrackerMsgCount(E["default"].getTrackerMsgCount()+1)}};v.prototype.sockEmit=function(e,d,f){(E["default"].getConnected()||"init"===e)&&(void 0===d?this.socket.emit(e,f):this.socket.emit(e,d,f),u(e))},v.prototype.onTrackerConnected=function(){var b={manifest_url:y["default"].content,p2p_protocol:this.client2ClientProtocolVersion,client_id:I["default"].ID_CLIENT};this._playerInterface.isLive()&&(b.buffer_level_max=this._playerInterface.getBufferLevelMax()),this.sockEmit("init",b,this.onTrackerReady.bind(this)),E["default"].incrementTrackerConnectionCount(),this._timers.setTimeout(this._inspectUsedTransport.bind(this),15000)},v.prototype._inspectUsedTransport=function(){"websocket"==this.socket.io.engine.transport.name&&E["default"].setUpgraded()},v.prototype.onTrackerReady=function(e,d){if(!e){var f=Date.now()-this.instantiatedTime;E["default"].setTrackerConnectionTime(f),E["default"].setConnected(!0),this._playerInterface.isLive()&&(E["default"].setBufferLevel(d.buffer_level),this._playerInterface.setBufferMarginLive(d.buffer_level)),E["default"].setMyPeerId(d.peer_id),this.askGeolocation(I["default"].GEOLOCATION_REQUEST_MAX_RETRY),this.getEE().emit("tracker_ready")}},v.prototype.askGeolocation=function(d){var c=this;this._timers.setTimeout(function(){c.sockEmit("geolocation",void 0,c.makeGeolocationAnswerHandler(d))},I["default"].GEOLOCATION_REQUEST_TIMEOUT)},v.prototype.makeGeolocationAnswerHandler=function(d){var c=this;return function(g,f){if(g){0!==d&&(d--,c.askGeolocation(d))}else{var b=new A["default"](f.city,f.country,f.latitude,f.longitude);E["default"].setMyLocation(b)}}},v.prototype.onTrackerReconnecting=function(){E["default"].setConnected(!1)},v.prototype.onTrackerDisconnected=function(){!this.socketClosed,E["default"].setConnected(!1),E["default"].incrementTrackerDeconnectionCount(),this.getEE().emit("tracker_disconnected")},v.prototype.onTrackerReconnect=function(){E["default"].incrementTrackerReconnectionCount()},v.prototype.onGetCurrentTracks=function(d){var c={tracks:[{track_hash:y["default"].getVideoTrackHash()}]};this._playerInterface.isLive()||(c.time_position=y["default"].videoCurrentTime),d(null,c)},v.prototype.askPeers=function(e,d){var f={tracks:[{track_hash:y["default"].getVideoTrackHash()}],exclusions:e,peer_number:I["default"].MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE};this._playerInterface.isLive()?f.buffer_level=E["default"].getBufferLevel():f.time_position=y["default"].videoCurrentTime,this.sockEmit("get_peers",f,d)},v.prototype.dispose=function(){this.socketClosed=!0,this._timers.clearAll(),this.socket.close()},L["default"]=v,M.exports=L["default"]},{"../../conf":242,"../utils/Timers":302,"./Location":257,"./moduleState":283,"./status":286,"babel-runtime/helpers/interop-require-default":331,eventemitter3:162,"socket.io-client":209}],274:[function(F,E,D){var C=F("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(D,"__esModule",{value:!0});var B=F("../../conf"),A=C(B),z=F("underscore"),y=C(z),x=F("./SpeedCalculator"),w=C(x),v=F("../utils/Timers"),u=C(v),t=F("./GlobalEventBus"),s=C(t),r=F("../utils/Delta"),q=function(){this.queue=[],this.peerTimeouts={},this.saturated=!1,this.uploadSpeedCalculator=new w["default"],this.uploadLimitation=A["default"].MAX_UP_SPEED,this._timers=new u["default"]};q.prototype.add=function(g,f,j,i,h){this.queue.push({peer:g,segmentCoord:f,id_chunk:j,chunk:i,timeStamp:h}),this.resetPeerTimeout(g),this.sendChunk()},q.prototype.removeFirstChunk=function(){this.queue.splice(0,1)},q.prototype.getChunkToSend=function(){for(var b=Date.now();this.queue.length>0;){if(b-this.queue[0].timeStamp<A["default"].CHUNK_UP_TIMEOUT){return this.queue[0]}this.removeFirstChunk(),s["default"].emit("uploadSaturated")}},q.prototype.sendChunk=function(g){var f=this.uploadSpeedCalculator.calculateSpeed();if(f<this.uploadLimitation&&(!this.saturated||g)){var j=this.getChunkToSend();if(!j){return void this.unsetSaturated()}var i=j.peer.getBufferedAmount();if((0,r.isNumeric)(i)&&i<A["default"].UP_MAX_BUFFERED_AMOUNT){this.uploadSpeedCalculator.addChunkTransfer();try{return j.peer.sendChunk(j.segmentCoord,j.id_chunk,j.chunk),this.removeFirstChunk(),this.resetPeerTimeout(j.peer),this.unsetSaturated(),void (this.uploadLimitation+=5)}catch(h){this.uploadLimitation>A["default"].MAX_UP_SPEED&&(this.uploadLimitation=A["default"].MAX_UP_SPEED),this.uploadLimitation>400?this.uploadLimitation-=200:this.uploadLimitation>100?this.uploadLimitation-=50:this.uploadLimitation=Math.ceil(this.uploadLimitation/2),this.setSaturated()}this.checkPeerTimeout(j.peer)}else{this.uploadLimitation>30&&(this.uploadLimitation-=20,this.setSaturated())}}this.setSaturated()},q.prototype.checkPeerTimeout=function(d){var c=Date.now();this.peerTimeouts[d.getId()]?c-this.peerTimeouts[d.getId()]>A["default"].PEER_UP_TIMEOUT&&this.clearChunksForPeer(d.getId()):this.peerTimeouts[d.getId()]=c},q.prototype.resetPeerTimeout=function(b){delete this.peerTimeouts[b.getId()]},q.prototype.clearChunksForPeer=function(b){this.queue=y["default"].reject(this.queue,function(c){return c.peer.getId()===b})},q.prototype.setSaturated=function(){if(!this.saturated){this.saturated=!0;var b=A["default"].CHUNK_SIZE/1024/(A["default"].MAX_UP_SPEED/1000);void 0===this.sendInterval&&(this.sendInterval=this._timers.setInterval(function(){this.sendChunk(!0)}.bind(this),b))}},q.prototype.unsetSaturated=function(){this.saturated===!0,this.saturated=!1,this.queue.length||(this._timers.clearInterval(this.sendInterval),this.sendInterval=void 0)},q.prototype.dispose=function(){this._timers.clearAll()},D["default"]=q,E.exports=D["default"]},{"../../conf":242,"../utils/Delta":297,"../utils/Timers":302,"./GlobalEventBus":255,"./SpeedCalculator":272,"babel-runtime/helpers/interop-require-default":331,underscore:338}],275:[function(h,g,l){var k=h("babel-runtime/helpers/create-class")["default"],j=h("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(l,"__esModule",{value:!0});var i=function(){function b(){j(this,b)}return k(b,[{key:"sendMessage",value:function(){throw new Error("One should not call sendMessage on a PeerConnection that has already been destroyed")}},{key:"sendBinaryData",value:function(){throw new Error("One should not call sendBinaryData on a PeerConnection that has already been destroyed")}},{key:"getRtt",value:function(){throw new Error("One should not call getRtt on a PeerConnection that has already been destroyed")}},{key:"getBufferedAmount",value:function(){throw new Error("One should not call getBufferedAmount on a PeerConnection that has already been destroyed")}},{key:"destroy",value:function(){throw new Error("One should not call destroy on a PeerConnection that has already been destroyed")}},{key:"close",value:function(){throw new Error("One should not call close on a PeerConnection that has already been destroyed")}},{key:"on",value:function(){throw new Error("One should not call on on a PeerConnection that has already been destroyed")}}]),b}();l["default"]=i,g.exports=l["default"]},{"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],276:[function(F,E,D){function C(R,Q){function P(){Q.onclose=function(){j.emit("disconnected")},Q.onerror=function(b){j.emit("disconnected")},Q.onmessage=p,n(),e.setInterval(L,u["default"].PEER_COMPUTE_RTT_INTERVAL)}function O(b,g){if("open"===Q.readyState){var f=JSON.stringify({type:b,args:g});s["default"].setRawDataUploaded(s["default"].getRawDataUploaded()+f.length),Q.send(f)}else{j.emit("disconnected")}}function N(b){return"open"===Q.readyState?(Q.send(b),!0):(j.emit("disconnected"),!1)}function M(){return h}function L(){var c;R&&(navigator.mozGetUserMedia?R.getStats(null,function(f){for(var d in f){var g=f[d];if(void 0!==g.mozRtt){h=g.mozRtt;break}}},function(){}):R.getStats(function(b){var i,g,f=b.result();for(g=0;g<f.length;g++){if(i=f[g],""!==i.stat("googRtt")){c=i.stat("googRtt"),h=parseFloat(c);break}}}))}function K(){return Q.bufferedAmount}function J(){Q.close(),R.close(),this.destroy()}function I(){e.clearAll(),B(this,new q["default"])}function H(d,c){j.on(d,c)}function G(d,c){j.once(d,c)}function p(d){if(s["default"].setRawDataDownloaded(s["default"].getRawDataDownloaded()+d.data.length),l=!0,"string"==typeof d.data){var c=JSON.parse(d.data);switch(c.type){case"heartbeat":break;default:j.emit("message_received",c.type,c.args)}}else{j.emit("binarydata_received",d.data)}}function n(){e.setInterval(function(){l===!0?l=!1:(j.emit("disconnected"),"open"===Q.readyState&&(Q.close(),R.close()))},u["default"].CHECK_HEARTBEAT_INTERVAL),e.setInterval(function(){return O("heartbeat")},u["default"].SEND_HEARTBEAT_INTERVAL)}this.sendMessage=O,this.sendBinaryData=N,this.getRtt=M,this.getBufferedAmount=K,this.destroy=I,this.close=J,this.on=H,this.once=G;var l=!0,j=new y["default"],h=-1,e=new w["default"];P()}var B=F("babel-runtime/core-js/object/assign")["default"],A=F("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(D,"__esModule",{value:!0});var z=F("eventemitter3"),y=A(z),x=F("../../utils/Timers"),w=A(x),v=F("../../../conf"),u=A(v),t=F("../status"),s=A(t),r=F("./DestroyedPeerConnection"),q=A(r);D["default"]=C,E.exports=D["default"]},{"../../../conf":242,"../../utils/Timers":302,"../status":286,"./DestroyedPeerConnection":275,"babel-runtime/core-js/object/assign":313,"babel-runtime/helpers/interop-require-default":331,eventemitter3:162}],277:[function(V,U,T){function S(b){}var R=V("babel-runtime/helpers/create-class")["default"],Q=V("babel-runtime/helpers/class-call-check")["default"],P=V("babel-runtime/core-js/object/keys")["default"],O=V("babel-runtime/core-js/get-iterator")["default"],N=V("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(T,"__esModule",{value:!0});var M=V("./SignalingClient"),L=N(M),K=V("./PeerConnection"),J=N(K),I=V("../../../conf"),H=N(I),G=V("../../utils/WebRTC"),F=N(G),E=V("../status"),D=N(E),C=V("../../utils/Bucket"),B=N(C),A=V("../../utils/Timers"),z=N(A),y=function(){function b(d,e){Q(this,b),this._signalingClient=new L["default"],this._myPeerId=d,this._peerPool=e,this._signalingClient.connect(H["default"].SIGNALING_URL,d),this._signalingClient.on("webrtc_offer",this._onOffer.bind(this)),this._signalingClient.on("webrtc_answer",this._onAnswer.bind(this)),this._signalingClient.on("webrtc_icecandidate",this._onIceCandidate.bind(this)),this._peerConnectionCollection={},this._timers=new z["default"]}return R(b,[{key:"createPeerConnection",value:function(i){var d=this,n=Math.random().toString().substr(2),m=F["default"].createPeerConnection(),l=m.createDataChannel("comm",{ordered:!1,maxPacketLifeTime:1000});l.binaryType="arraybuffer";var k=this._timers.setTimeout(function(){d._onConnexionTimeout(i,n)},H["default"].PEER_CONNECTION_TIMEOUT),j=this._createOpenDataChannelHandler(m,l,k,i,n);l.onopen=j,this._peerConnectionCollection[n]={pc:m,connectionTimeout:k,dataChannel:l},m.createOffer(function(c){m.setLocalDescription(c,function(){var g=F["default"].transformOutgoingSdp(c.sdp),f={type:"webrtc_offer",connexion_id:n,sender_id:d._myPeerId,receiver_id:i,sdp:g};d._signalingClient.send(f)},S)},S),this._manageIceCandidate(m,i,n)}},{key:"_manageIceCandidate",value:function(f,e,h){var g=this._createIceCandidateBucket(this._myPeerId,e,h);f.onicecandidate=function(c){c.candidate&&g.addElement(c.candidate)}}},{key:"_onConnexionRefused",value:function(e,d){var f=this._peerConnectionCollection[d].pc;f.close(),delete this._peerConnectionCollection[d],this._peerPool.offerDeclined(e)}},{key:"_onConnexionTimeout",value:function(e,d){var f=this._peerConnectionCollection[d].pc;f.close(),delete this._peerConnectionCollection[d],this._peerPool.connectionAttemptTimeout(e)}},{key:"_onOffer",value:function(r){var q=this,p=r.sender_id,o=r.connexion_id;if(this._peerPool.isFull()){var n={type:"webrtc_answer",connexion_id:o,sender_id:this._myPeerId,receiver_id:p,accepted:!1};return void this._signalingClient.send(n)}var m=F["default"].createPeerConnection();this._peerConnectionCollection[o]={pc:m},this._manageIceCandidate(m,p,o);var l={sdp:r.sdp,type:"offer"},k=new F["default"].SessionDescription(l);m.setRemoteDescription(k,function(){m.createAnswer(function(c){m.setLocalDescription(c,function(){c.sdp=F["default"].transformOutgoingSdp(c.sdp);var e={type:"webrtc_answer",connexion_id:o,sender_id:q._myPeerId,receiver_id:p,accepted:!0,sdp:c.sdp};q._signalingClient.send(e)},S)},S)},S);var d=this._timers.setTimeout(function(){q._onConnexionTimeout(p,o)},H["default"].PEER_CONNECTION_TIMEOUT);m.ondatachannel=function(c){var g=c.channel||c;g.binaryType="arraybuffer",g=g;var e=q._createOpenDataChannelHandler(m,g,d,p,o);"connecting"==g.readyState?g.onopen=e:e(),g.onerror=S}}},{key:"_createOpenDataChannelHandler",value:function(h,g,l,k,j){var i=this;return function(){if(i._peerConnectionCollection[j]){delete i._peerConnectionCollection[j],i._timers.clearTimeout(l);var c=new J["default"](h,g);i._peerPool.addPeerConnection(k,c)}}}},{key:"_onAnswer",value:function(j){var d=j.sender_id,p=j.connexion_id;if(this._peerConnectionCollection[p]){var o=this._peerConnectionCollection[p],n=o.pc,m=o.connectionTimeout;if(n){if(j.accepted){var l={sdp:j.sdp,type:"answer"},k=new F["default"].SessionDescription(l);n.setRemoteDescription(k,function(){},S)}else{this._timers.clearTimeout(m),this._onConnexionRefused(d,p)}}}}},{key:"_onIceCandidate",value:function(f){var e=this,h=f.connexion_id;if(this._peerConnectionCollection[h]){var g=this._peerConnectionCollection[h].pc;f.icecandidate_array.forEach(function(c){e._addIceCandidate(g,c)})}}},{key:"_addIceCandidate",value:function(e,d){try{e.addIceCandidate(new F["default"].IceCandidate(d))}catch(f){}}},{key:"_createIceCandidateBucket",value:function(h,g,l){var k=this,j=function(d){var c={type:"webrtc_icecandidate",connexion_id:l,sender_id:h,receiver_id:g,icecandidate_array:d};k._signalingClient.send(c)},i=new B["default"](j,D["default"].incrementMissedIceCandidateCount,H["default"].ICECANDIDATES_TIMEOUT);return i}},{key:"dispose",value:function(){this._signalingClient.close(),this._timers.clearAll();var r=P(this._peerConnectionCollection),q=!0,p=!1,o=void 0;try{for(var n,m=O(r);!(q=(n=m.next()).done);q=!0){var l=n.value,h=this._peerConnectionCollection[l].pc;h.close()}}catch(g){p=!0,o=g}finally{try{!q&&m["return"]&&m["return"]()}finally{if(p){throw o}}}}}]),b}();T["default"]=y,U.exports=T["default"]},{"../../../conf":242,"../../utils/Bucket":293,"../../utils/Timers":302,"../../utils/WebRTC":303,"../status":286,"./PeerConnection":276,"./SignalingClient":278,"babel-runtime/core-js/get-iterator":310,"babel-runtime/core-js/object/keys":320,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],278:[function(z,y,x){var w=z("babel-runtime/helpers/create-class")["default"],v=z("babel-runtime/helpers/class-call-check")["default"],u=z("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(x,"__esModule",{value:!0});var t=z("../../../conf"),s=u(t),r=z("underscore"),q=u(r),p=z("../status"),o=u(p),n=function(){function b(){v(this,b),this._init()}return w(b,[{key:"connect",value:function(d,c){this._url=d,this._id=c,this._createConnection()}},{key:"send",value:function(d){if(this._connection&&this._connection.readyState===WebSocket.OPEN){var c=d.receiver_id+","+JSON.stringify(q["default"].omit(d,"receiver_id"));this._connection.send(c)}else{this._msgBuffer.push(d)}}},{key:"on",value:function(d,c){this._handlers[d]=c}},{key:"close",value:function(){this._disposing=!0,o["default"].setDisconnectedToSignalingServer(),this._stopReconnectionLoop(),this._connection&&this._connection.close(),void 0!==this._connectionTimeout&&(clearTimeout(this._connectionTimeout),delete this._connectionTimeout),void 0!==this._nextReconnectAttempt&&(clearTimeout(this._nextReconnectAttempt),delete this._nextReconnectAttempt),this._init()}},{key:"_createConnection",value:function(){!this._connection||this._connection.readyState!=WebSocket.CONNECTING&&this._connection.readyState!=WebSocket.OPEN||this.close();var d="3.0.13";this._connection=new WebSocket(this._url+"?id="+this._id+"&p2pVersion="+d+"&client_id="+s["default"].ID_CLIENT);var c=this._connection;this._connectionTimeout=setTimeout(function(){c.close()},10000),this._handleConnectionSuccess(),this._handleErrorAndClose(),this._handleMessages()}},{key:"_handleErrorAndClose",value:function(){var e=this,d=this._connection,f=function(){d===e._connection&&(o["default"].setDisconnectedToSignalingServer(),e._tryReconnect())};this._connection.onerror=f,this._connection.onclose=f}},{key:"_tryReconnect",value:function(){var d=this,c=function(){delete d._nextReconnectAttempt,d._createConnection(),d._updateDelay()};void 0!==this._nextReconnectAttempt||this._disposing||(this._nextReconnectAttempt=setTimeout(c,this._delayReconnection))}},{key:"_updateDelay",value:function(){this._delayReconnection=Math.min(this._delayReconnection+s["default"].SIGNALING_DELAY_STEP,s["default"].SIGNALING_DELAY_MAX)}},{key:"_handleConnectionSuccess",value:function(){var c=this;this._connection.onopen=function(){o["default"].setConnectedToSignalingServer(),clearTimeout(c._connectionTimeout),delete c._connectionTimeout,c._stopReconnectionLoop(),c._sendMessagesInBuffer()}}},{key:"_handleMessages",value:function(){var c=this;this._connection.onmessage=function(e){var g=JSON.parse(e.data);if(c._handlers[g.type]){var f=q["default"].omit(g,"type");c._handlers[g.type](f)}}}},{key:"_init",value:function(){this._handlers={},this._delayReconnection=0,this._msgBuffer=[]}},{key:"_stopReconnectionLoop",value:function(){this._delayReconnection=0}},{key:"_sendMessagesInBuffer",value:function(){this._msgBuffer.forEach(this.send.bind(this)),this._msgBuffer=[]}}]),b}();x["default"]=n,y.exports=x["default"]},{"../../../conf":242,"../status":286,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331,underscore:338}],279:[function(e,d,f){(function(k){var j=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(f,"__esModule",{value:!0});var i=e("../status"),c=j(i),b=function(h,g){var m=function(){var q,p={download:{p2pDownloaded:c["default"].getP2PDownloaded(),p2pDownloadedNewAnalytics:c["default"].getp2pDownloadedNewAnalytics(),p2pUploaded:c["default"].getP2PUploaded(),cdnDownloaded:c["default"].getCDNDownloaded(),dlSpeed:c["default"].getDlSpeed(),upSpeed:c["default"].getUpSpeed()},peers:{count:0},bufferLevel:c["default"].getBufferLevel(),tracker:{connected:c["default"].getConnected()},trackerConnected:c["default"].getConnected(),sigConnected:c["default"].getConnectedToSignalingServer(),isLive:g()},o=[];for(q=0;q<h.getPeerArray().length;q++){var n=h.getPeerArray()[q];n.getId()&&p.peers.count++,o.push(n.getDebugInfos())}return p.peerList=o,p},l=function(){k.SR_DISPLAY_INTERFACE={getStats:m}};l(),this.dispose=function(){delete window.SR_DISPLAY_INTERFACE}};f["default"]=b,d.exports=f["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../status":286,"babel-runtime/helpers/interop-require-default":331}],280:[function(h,g,l){var k=h("babel-runtime/helpers/create-class")["default"],j=h("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(l,"__esModule",{value:!0});var i=function(){function b(){j(this,b)}return k(b,[{key:"getSegmentTime",value:function(c){}},{key:"getSegmentList",value:function(e,d,f){}}]),b}();l["default"]=i,g.exports=l["default"]},{"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],281:[function(h,g,l){var k=h("babel-runtime/helpers/create-class")["default"],j=h("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(l,"__esModule",{value:!0});var i=function(){function b(){j(this,b)}return k(b,[{key:"isEqual",value:function(c){}},{key:"viewToString",value:function(){}},{key:"toArrayBuffer",value:function(){}},{key:"isInTrack",value:function(c){}}]),b}();i.fromArrayBuffer=function(b){},l["default"]=i,g.exports=l["default"]},{"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],282:[function(h,g,l){var k=h("babel-runtime/helpers/create-class")["default"],j=h("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(l,"__esModule",{value:!0});var i=function(){function b(){j(this,b)}return k(b,[{key:"viewToString",value:function(){}},{key:"isEqual",value:function(c){}}]),b}();l["default"]=i,g.exports=l["default"]},{"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],283:[function(h,g,l){var k=h("babel-runtime/core-js/object/define-properties")["default"];Object.defineProperty(l,"__esModule",{value:!0});var j=h("../utils/Delta"),i=k({updateCurrentTracks:function(d){var c=d.video;c&&(this._currentVideoTrack=c)},getVideoTrackHash:function(){return this._currentVideoTrack?this._currentVideoTrack.viewToString():"defaultTrackHash"}},{videoCurrentTime:{set:function(b){this._videoCurrentTime=b},get:function(){if((0,j.isNumeric)(this._videoCurrentTime)){return this._videoCurrentTime}throw new Error("Attempt to use a track video currentTime before setting it")},configurable:!0,enumerable:!0},content:{set:function(b){this._content=b},get:function(){if(this._content){return this._content}throw new Error("Attempt to use the content identifier before setting it")},configurable:!0,enumerable:!0}});l["default"]=i,g.exports=l["default"]},{"../utils/Delta":297,"babel-runtime/core-js/object/define-properties":315}],284:[function(N,M,L){var K=N("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(L,"__esModule",{value:!0});var J=N("./status"),I=K(J),H=N("../../conf"),G=K(H),F=N("./Heuristic"),E=K(F),D=N("../utils/Timers"),C=K(D),B=N("../utils/Cartography"),A=K(B),z=N("../utils/ChunkMetadata"),y=N("../metrics/MovingAverage"),x=K(y),w=N("./structures/SegmentInfo"),v=K(w),u=function(aI,aH,aG,aF){var aE,aD,aC,aB,aA,az=0,ay=0,ax=0,aw=0,av=Date.now(),au=0,at=0,ar=Date.now(),aq=aH,ap=aI,ao=0,an=0,am=new E["default"],al=this,ak=new C["default"],aj=0,ai=new x["default"](G["default"].PEER_INSTANT_SPEED_CALCULATION_WINDOW),ah=function(){return A["default"].getDistanceFromLatitudeLongitude(aC,I["default"].getMyLocation().latitude,aB,I["default"].getMyLocation().longitude)},ag=function(){var d=Date.now(),c=d-av;ao=ax/1024/(c/1000),an=aw/1024/(c/1000),ax=0,aw=0,av=d},af=function(){ai.addPoint(az-aj),aj=az},ae=function(){return ai.compute()/(G["default"].PEER_INSTANT_SPEED_CALCULATION_INTERVAL/1000)},ad=function(){var b=Date.now(),g=(b-ar)/1000,e=az+ay-(au+at);e<G["default"].MIN_USEFUL_SPEED*g&&(aH.emit("remove_peer",al,!1),q()),au=az,at=ay,ar=b},ac=function f(){I["default"].getMyLocation().city?aF.sendMessage("info",{bufferLevel:I["default"].getBufferLevel(),city:I["default"].getMyLocation().city,country:I["default"].getMyLocation().country,latitude:I["default"].getMyLocation().latitude,longitude:I["default"].getMyLocation().longitude}):I["default"].getEE().once("location_updated",f)},ab=function(b){aF.sendMessage("requestHasSegment",b)},aa=function(d,c){aF.sendMessage("hasSegment",{segmentInfo:d,progress:c})},Z=function(d,c){aF.sendMessage("requestChunk",{segmentCoord:d,id_chunk:c}),am.incrementNbChunkRequested()},s=function(){return am.getNbChunkRequested()<G["default"].MAX_CHUNK_BY_SEEDER},q=function(){ak.clearAll(),am.dispose(),aF.close()},o=function(){ak.clearAll(),am.dispose(),aF.destroy()},n=function(){ak.setInterval(ag,1000),ak.setInterval(ad,G["default"].CHECK_USELESS_INTERVAL),ak.setInterval(af,G["default"].PEER_INSTANT_SPEED_CALCULATION_INTERVAL),ac(),I["default"].incrementNewPeerConnectionCount(),aF.once("disconnected",function(){aH.emit("remove_peer",al,!1),o()}),aF.on("binarydata_received",j),aF.on("message_received",l)},l=function(e,c){switch(e){case"info":aE=c.city,aD=c.country,aC=c.latitude,aB=c.longitude,aA=c.bufferLevel;break;case"requestHasSegment":aq.emit("segmentRequested",al,new aG(c));break;case"hasSegment":var i=new aG(c.segmentInfo.segmentCoord),g=new v["default"](i,c.segmentInfo.size,c.segmentInfo.hash,c.segmentInfo.time);aq.emit("hasSegment",al,c.progress,g);break;case"requestChunk":aq.emit("chunkRequested",al,new aG(c.segmentCoord),c.id_chunk);break;default:throw new Error("wrong message sent by peerConnection")}},j=function(b){var c=(0,z.parseMetaData)(b,aG.fromArrayBuffer);ax+=c.data.byteLength,az+=c.data.byteLength,I["default"].setP2PDownloadedUncorrected(I["default"].getP2PDownloadedUncorrected()+c.data.byteLength),I["default"].setP2PDownloaded(I["default"].getP2PDownloaded()+c.data.byteLength),aH.emit("chunkReceived",al,c.segmentCoord,c.id_chunk,c.data)},h=function(i,d,r){var p=r.byteLength,m=(0,z.encodeMetaData)(i,d,r),k=aF.sendBinaryData(m);return k?(aw+=p,ay+=p,void I["default"].setP2PUploaded(I["default"].getP2PUploaded()+p)):!1};al.getRtt=aF.getRtt.bind(aF),al.getDistance=ah,al.requestHasSegment=ab,al.answerHasSegment=aa,al.requestChunk=Z,al.sendChunk=h,al.canBeAskedChunk=s,al.close=q,al.getDataDownloaded=function(){return az},al.getDataUploaded=function(){return ay},al.getBufferLevel=function(){return aA},al.getId=function(){return ap},al.getDlSpeed=function(){return ao},al.getUpSpeed=function(){return an},al.getBufferedAmount=aF.getBufferedAmount.bind(aF),al.getHeuristic=function(){return am},al.getDebugInfos=function(){return{country:aD,city:aE,bufferLevel:aA,dlSpeed:ao,upSpeed:an,dataDownloaded:az,dataUploaded:ay,rtt:aF.getRtt(),distance:ah()}},this.getMeanInstantSpeed=ae,n()};L["default"]=u,M.exports=L["default"]},{"../../conf":242,"../metrics/MovingAverage":247,"../utils/Cartography":295,"../utils/ChunkMetadata":296,"../utils/Timers":302,"./Heuristic":256,"./status":286,"./structures/SegmentInfo":289,"babel-runtime/helpers/interop-require-default":331}],285:[function(P,O,N){var M=P("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(N,"__esModule",{value:!0});var L=P("../../conf"),K=M(L),J=P("underscore"),I=M(J),H=P("./status"),G=M(H),F=P("eventemitter3"),E=M(F),D=P("../utils/Timers"),C=M(D),B=P("./peer"),A=M(B),z=P("./communication/PeerConnector"),y=M(z),x=P("./ExclusionCollection"),w=M(x),v=function(ak,aj){var ai,ah,ag=ak,af=!1,ae=[],ad=this,ac=new E["default"],ab=new w["default"](K["default"].OFFER_DECLINED_TIMEOUT),Z=new w["default"](K["default"].PEER_REMOVED_TIMEOUT),W=new w["default"](K["default"].PEER_CONNEXION_ATTEMPT_TIMEOUT),T=new C["default"],R=function(){T.setInterval(t,K["default"].SPEED_MONITOR_INTERVAL),ac.on("remove_peer",Y),T.setInterval(l,K["default"].MEAN_SPEED_CALCULATION_INTERVAL),ag.getEE().on("tracker_ready",h,ad),ag.getEE().on("tracker_disconnected",aa,ad)},t=function(){var d=0,c=0;I["default"].forEach(ae,function(b){d+=b.getDlSpeed(),c+=b.getUpSpeed()}),G["default"].setDlSpeed(d),G["default"].setUpSpeed(c),G["default"].computeMaxAndAvgSpeed()},p=function(){var e=0;I["default"].forEach(ae,function(c){e+=c.getMeanInstantSpeed()});var d=Math.max(0,G["default"].getp2pDownloadedNewAnalytics()),g=G["default"].getP2PDownloadedUncorrected();return g&&(e*=d/g),e},l=function(){var b=p();G["default"].setMeanInstantSpeed(b)},h=function(){ah=new y["default"](G["default"].getMyPeerId(),this),ai||(ai=T.setInterval(X,K["default"].ASK_PEERS_INTERVAL)),af||X(),af=!0},aa=function(){ai&&(T.clearInterval(ai),ai=void 0)},Y=function(b){Z.add(b.getId()),ac.emit("peerDestroyed",b),ae=I["default"].without(ae,b)},X=function(){if(ae.length<K["default"].MIN_NUMBER_OF_PEERS){var d=V();G["default"].onPeerUpdateRequest();var c=Date.now();ag.askPeers(d,function(b,m){var k=Date.now()-c;G["default"].onPeerUpdateResponse(k);var i=0;m.forEach(function(e){e.peers.forEach(function(g){ae.length+i<K["default"].MIN_NUMBER_OF_PEERS&&(ah.createPeerConnection(g),i++)})})})}},V=function(){var d,c=[];for(d=0;d<ae.length;d++){c.push(ae[d].getId())}return c=c.concat(Z.getExclusionList(),ab.getExclusionList(),W.getExclusionList())},U=function(){return ae.length>=K["default"].MAX_NUMBER_OF_PEERS},S=function(b){ae.forEach(function(c){c.requestHasSegment(b)})},Q=function(){ae.forEach(function(b){b.close(),ac.emit("peerDestroyed",b)}),ae=[]},r=function(b,g){if(U()){g.destroy()}else{var e=new A["default"](b,ac,aj,g);ae.push(e)}},n=function(b){ab.add(b)},j=function(b){W.add(b)},f=function(){ag.dispose(),T.clearAll(),Q(),ab.dispose(),Z.dispose(),W.dispose()};ad.getPeerArray=function(){return ae},ad.requestHasSegment=S,ad.getEE=function(){return ac},ad.isFull=U,ad.addPeerConnection=r,this.offerDeclined=n,this.connectionAttemptTimeout=j,ad.dispose=f,R()};N["default"]=v,O.exports=N["default"]},{"../../conf":242,"../utils/Timers":302,"./ExclusionCollection":253,"./communication/PeerConnector":277,"./peer":284,"./status":286,"babel-runtime/helpers/interop-require-default":331,eventemitter3:162,underscore:338}],286:[function(v,u,t){var s=v("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=v("eventemitter3"),q=s(r),p=v("../utils/Timers"),o=s(p),n=v("../../conf"),m=function(){var a9,a8,a7,a6,a5,a4,a3,a2,a1,a0,aZ,aY,aX,aW,aV,aU,aT,aS,aR,aQ,aP,aN,aM,aC,aB,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ad,ac,i,aI,bc,aD,bb,aJ=this,aE=function(){a9=!1,a7={city:null,country:null,latitude:null,longitude:null},a6=void 0,a5=0,a4=0,a3=0,a2=0,a1=0,a0=0,aZ=0,aY=0,aX=0,aW=0,aV=0,aU=0,aT=0,aS=0,aR=0,aQ=[],aP=0,aN=0,aM=0,aC=0,aB=0,aA=0,az=0,ay=0,ax=0,aw=0,av=0,au=0,at=0,ar=0,aq=0,ap=0,ao=0,an=0,am=0,al=0,ak=0,aj=0,ai=0,ah=[],ag=-1,af=0,ad=0,aJ=this,ac=void 0,i=void 0,aI=void 0,bc=new q["default"],aD=void 0,bb=new o["default"],bb.setInterval(aK.bind(aJ),1000)},f=function(){var g,e,k,j;a5&&(a5>a3&&(a3=a5),g=a4?(a4*i+a5)/(i+1):a5,e=i?i+1:1,i=e,a4=g),a2&&(a2>a0&&(a0=a2),k=a1?(a1*aI+a2)/(aI+1):a2,j=aI?aI+1:1,aI=j,a1=k)},aK=function(){var e,d=aQ,g=Date.now();for(d.push({p2pDownloaded:aY,timeStamp:g}),e=d.length-1;e>=0;e--){g-d[e].timeStamp>1000*n.ABR_DEL_T&&d.splice(e,1)}},aF=function(){var j,g,x,w,k=aQ;return k.length?(j=k[0],g=k[k.length-1],x=g.p2pDownloaded-j.p2pDownloaded,w=(g.timeStamp-j.timeStamp)/1000,w>0&&x>0?x/w:0):0},h=function(){ag++},aL=function(){aj++},aG=function(){return aj},ab=function(b){ai++,ah.push(b)},aO=function(){return ai},aH=function(){var e=0,d=0;if(ah.length>0){for(var g=0;g<ah.length;g++){e+=ah[g]}d=e/ah.length}return ah=[],d},ae=function(){bb.clearAll()};aJ.getMyPeerId=function(){return a6},aJ.setMyPeerId=function(b){a6!==b&&(a6=b)},aJ.getMyLocation=function(){return a7},aJ.setMyLocation=function(b){a7=b,bc.emit("location_updated",b)},aJ.getDataDownloadedTwice=function(){return ac},aJ.correctP2PDownloaded=function(d,c){isNaN(d)||("PP"===c?(aP+=d,aY-=d):"PC"===c?(aN+=d,aY-=d,aY=aX-d):"CP"===c?(aM+=d,aY-=d):"CC"===c?aC+=d:"HP"===c?(aB+=d,aY-=d):"HD"===c?(aA+=d,aY-=d):"M"===c&&(az+=d,aY-=d))},aJ.getDlSpeed=function(){return a5},aJ.setDlSpeed=function(b){a5=b},aJ.getAvgDlSpeed=function(){return a4},aJ.getMaxDlSpeed=function(){return a3},aJ.getUpSpeed=function(){return a2},aJ.setUpSpeed=function(b){a2=b},aJ.getAvgUpSpeed=function(){return a1},aJ.getMaxUpSpeed=function(){return a0},aJ.getP2PDownloaded=function(){return aY},aJ.setP2PDownloaded=function(b){"number"!=typeof b||isNaN(b)||(aY=b)},aJ.getp2pDownloadedNewAnalytics=function(){return aX},aJ.setp2pDownloadedNewAnalytics=function(b){"number"!=typeof b||isNaN(b)||(aX=b)},aJ.getP2PDownloadedUncorrected=function(){return aW},aJ.setP2PDownloadedUncorrected=function(b){aW=b},aJ.getP2PUploaded=function(){return aV},aJ.setP2PUploaded=function(b){aV=b},aJ.getRawDataDownloaded=function(){return aU},aJ.setRawDataDownloaded=function(b){aU=b},aJ.getRawDataUploaded=function(){return aT},aJ.setRawDataUploaded=function(b){aT=b},aJ.getCDNDownloaded=function(){return aS},aJ.setCDNDownloaded=function(b){aS=b},aJ.getCdnCancelled=function(){return aR},aJ.setCdnCancelled=function(b){aR=b},aJ.getDataDownloadedTwice_PP=function(){return aP},aJ.setDataDownloadedTwice_PP=function(b){aP=b},aJ.getDataDownloadedTwice_PC=function(){return aN},aJ.setDataDownloadedTwice_PC=function(b){aN=b},aJ.getDataDownloadedTwice_CP=function(){return aM},aJ.setDataDownloadedTwice_CP=function(b){aM=b},aJ.getDataDownloadedTwice_CC=function(){return aC},aJ.setDataDownloadedTwice_CC=function(b){aC=b},aJ.getDataDownloadedTwice_HP=function(){return aB},aJ.setDataDownloadedTwice_HP=function(b){aB=b},aJ.getDataDownloadedTwice_HD=function(){return aA},aJ.setDataDownloadedTwice_HD=function(b){aA=b},aJ.getDataDownloadedTwice_M=function(){return az},aJ.setDataDownloadedTwice_M=function(b){az=b},aJ.getCdnDataDiscarded=function(){return ay},aJ.setCdnDataDiscarded=function(b){ay=b},aJ.getP2PDoubleCheck=function(){return ax},aJ.setP2PDoubleCheck=function(b){ax=b},aJ.getCDNDoubleCheck=function(){return aw},aJ.setCDNDoubleCheck=function(b){aw=b},aJ.getNbRightHashP2P=function(){return av},aJ.setNbRightHashP2P=function(b){av=b},aJ.getNbWrongHashP2P=function(){return au},aJ.setNbWrongHashP2P=function(b){au=b},aJ.getNbRightHashDLM=function(){return at},aJ.setNbRightHashDLM=function(b){at=b},aJ.getNbWrongHashDLM=function(){return ar},aJ.setNbWrongHashDLM=function(b){ar=b},aJ.getTrackerMsgCount=function(){return aq},aJ.setTrackerMsgCount=function(b){aq=b},aJ.getTrackerSgnCount=function(){return ap},aJ.setTrackerSgnCount=function(b){ap=b},aJ.getTrackerConnectionCount=function(){return ao},aJ.incrementTrackerConnectionCount=function(){ao++},aJ.getTrackerReconnectionCount=function(){return am},aJ.incrementTrackerReconnectionCount=function(){am++},aJ.getTrackerDeconnectionCount=function(){return an},aJ.incrementTrackerDeconnectionCount=function(){an++},aJ.incrementNewPeerConnectionCount=function(){ad++},aJ.getNewPeerConnectionCount=function(){return ad},aJ.getConnected=function(){return a9},aJ.getUpgraded=function(){return a8},aJ.setTrackerConnectionTime=function(b){al=b},aJ.getTrackerConnectionTime=function(){return al},aJ.incrementMissedIceCandidateCount=function(){af++},aJ.getMissedIceCandidateCount=function(){return af},aJ.setConnected=function(c){c!==a9&&(a9=c,bc.emit("change:connected"),c===!0&&bc.emit("tracker_ready"))},aJ.setUpgraded=function(){a8=!0},aJ.getEE=function(){return bc},aJ.setConnectedToSignalingServer=function(){ak=1},aJ.setDisconnectedToSignalingServer=function(){ak=0},aJ.getConnectedToSignalingServer=function(){return ak},aJ.computeMaxAndAvgSpeed=f,aJ.computeP2PThroughput=aF,aJ.setMeanInstantSpeed=function(b){aZ=b},aJ.getMeanInstantSpeed=function(){return aZ},aJ.setBufferLevel=function(b){aD=b},aJ.getBufferLevel=function(){return aD},aJ.incrementTrackSwitchCount=h,aJ.getTrackSwitchCount=function(){return ag},aJ.onPeerUpdateRequest=aL,aJ.getPeerUpdateRequestCount=aG,aJ.onPeerUpdateResponse=ab,aJ.getPeerUpdateResponseCount=aO,aJ.getPeerUpdateAvgResponseTime=aH,aJ.dispose=ae,aJ.reset=aE},l=new m;t["default"]=l,u.exports=t["default"]},{"../../conf":242,"../utils/Timers":302,"babel-runtime/helpers/interop-require-default":331,eventemitter3:162}],287:[function(r,q,p){var o=r("babel-runtime/helpers/create-class")["default"],n=r("babel-runtime/helpers/class-call-check")["default"],m=r("babel-runtime/core-js/object/seal")["default"],l=r("babel-runtime/core-js/symbol/iterator")["default"],k=r("babel-runtime/regenerator")["default"];Object.defineProperty(p,"__esModule",{value:!0});var j=function(){function d(){n(this,d),this.audio=void 0,this.video=void 0,m(this)}return o(d,[{key:"update",value:function(f){var e=f.audio,g=f.video;if(!e&&!g){throw new Error("There must be at least one updated track")}this.audio=e||this.audio,this.video=g||this.video}},{key:l,value:k.mark(function c(){return k.wrap(function(b){for(;;){switch(b.prev=b.next){case 0:if(!this.video){b.next=3;break}return b.next=3,{coord:this.video,type:"video"};case 3:if(!this.audio){b.next=6;break}return b.next=6,{coord:this.audio,type:"audio"};case 6:case"end":return b.stop()}}},c,this)})}]),d}();p["default"]=j,q.exports=p["default"]},{"babel-runtime/core-js/object/seal":321,"babel-runtime/core-js/symbol/iterator":325,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/regenerator":334}],288:[function(D,C,B){var A=D("babel-runtime/helpers/class-call-check")["default"],z=D("babel-runtime/core-js/object/freeze")["default"],y=D("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(B,"__esModule",{value:!0});var x=D("../ChunkManager"),w=y(x),v=D("../Seeders"),u=y(v),t=D("../expectedInterfaces/SegmentCoordInterface"),s=y(t),r=D("../../utils/Interface"),q=function p(e,d,h,g){A(this,p),(0,r.checkInterface)(s["default"],e),this.segmentCoord=e,this.chunkManager=new w["default"](e,d,h,g),this.seeders=new u["default"],z(this)};B["default"]=q,C.exports=B["default"]},{"../../utils/Interface":298,"../ChunkManager":250,"../Seeders":268,"../expectedInterfaces/SegmentCoordInterface":281,"babel-runtime/core-js/object/freeze":317,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/interop-require-default":331}],289:[function(x,w,v){var u=x("babel-runtime/helpers/class-call-check")["default"],t=x("babel-runtime/core-js/object/freeze")["default"],s=x("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(v,"__esModule",{value:!0});var r=x("../../utils/Delta"),q=x("../expectedInterfaces/SegmentCoordInterface"),p=s(q),o=x("../../utils/Interface"),n=function m(e,d,h,g){if(u(this,m),(0,o.checkInterface)(p["default"],e),!(0,r.isNumeric)(g)){throw new Error("Invalid value for time")}if(!(0,r.isNumeric)(d)){throw new Error("Invalid value for size")}if(!h){throw new Error("No hash")}this.segmentCoord=e,this.time=g,this.size=d,this.hash=h,t(this)};v["default"]=n,w.exports=v["default"]},{"../../utils/Delta":297,"../../utils/Interface":298,"../expectedInterfaces/SegmentCoordInterface":281,"babel-runtime/core-js/object/freeze":317,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/interop-require-default":331}],290:[function(v,u,t){var s=v("babel-runtime/helpers/create-class")["default"],r=v("babel-runtime/helpers/class-call-check")["default"],q=v("babel-runtime/core-js/object/seal")["default"],p=v("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=v("../../utils/Delta"),n=v("../moduleState"),m=p(n),l=function(){function b(){r(this,b),this._audio=void 0,this._video=void 0,q(this)}return s(b,[{key:"update",value:function(e){var d=e.audio,f=e.video;if(!(0,o.isNumeric)(d)&&!(0,o.isNumeric)(f)){throw new Error("There must be at least one updated track edge")}(0,o.isNumeric)(d)&&(this._audio=d),(0,o.isNumeric)(f)&&(this._video=f,m["default"].videoCurrentTime=f)}},{key:"audio",get:function(){return this._audio}},{key:"video",get:function(){return this._video}}]),b}();t["default"]=l,u.exports=t["default"]},{"../../utils/Delta":297,"../moduleState":283,"babel-runtime/core-js/object/seal":321,"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327,"babel-runtime/helpers/interop-require-default":331}],291:[function(f,e,h){function g(){var b={mul32:function(j,i){var l=65535&i,k=i-l;return(k*j|0)+(l*j|0)|0},hashBytes:function(r,q,p){for(var o=3432918353,n=461845907,m=p,l=-4&q,k=0;l>k;k+=4){var j=255&r[k]|(255&r[k+1])<<8|(255&r[k+2])<<16|(255&r[k+3])<<24;j=this.mul32(j,o),j=(131071&j)<<15|j>>>17,j=this.mul32(j,n),m^=j,m=(524287&m)<<13|m>>>19,m=5*m+3864292196|0}switch(j=0,q%4){case 3:j=(255&r[l+2])<<16;case 2:j|=(255&r[l+1])<<8;case 1:j|=255&r[l],j=this.mul32(j,o),j=(131071&j)<<15|j>>>17,j=this.mul32(j,n),m^=j}return m^=q,m^=m>>>16,m=this.mul32(m,2246822507),m^=m>>>13,m=this.mul32(m,3266489909),m^=m>>>16}};self.onmessage=function(i){var k=new Uint8Array(i.data.segmentData),j=b.hashBytes(k,k.length,0).toString();self.postMessage({segmentData:i.data.segmentData,jobIndex:i.data.jobIndex,hash:j},[i.data.segmentData])}}Object.defineProperty(h,"__esModule",{value:!0}),h["default"]=g,e.exports=h["default"]},{}],292:[function(v,u,t){function s(){var d=URL.createObjectURL(new Blob(["("+n["default"].toString()+")()"],{type:"application/javascript"})),c=new Worker(d);return URL.revokeObjectURL(d),c}function r(h){var g=h.data,w=g.jobIndex,k=g.segmentData,j=g.hash,i=m[w];delete m[w],i(k,j)}function q(e,d){var f=m.push(d)-1;l.postMessage({segmentData:e,jobIndex:f},[e])}var p=v("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=v("./HashWorker"),n=p(o),m=[],l=s();l.onmessage=r,t["default"]=q,u.exports=t["default"]},{"./HashWorker":291,"babel-runtime/helpers/interop-require-default":331}],293:[function(i,h,n){var m=i("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var l=i("./Timers"),k=m(l),j=function(o,f,u){var t=[],s=!1,r=new k["default"],q=function(b){s?f(b):t.push(b)},p=function(){r.setTimeout(function(){s=!0,o(t),t=[]},u)};p(),this.addElement=q};n["default"]=j,h.exports=n["default"]},{"./Timers":302,"babel-runtime/helpers/interop-require-default":331}],294:[function(g,f,j){Object.defineProperty(j,"__esModule",{value:!0});var i=function(e){var d=Math.floor(e/256),k=e%256;return new Uint8Array([k,d])},h=function(e){var d=i(Math.floor(e/65536)),k=i(e%65536);return new Uint8Array([k[0],k[1],d[0],d[1]])};j.uint16ToUint8Array2=i,j.numToUint8Array4=h},{}],295:[function(f,e,h){var g=function(x,w,v,u){var t=6371,s=(x-w)*Math.PI/180,r=(v-u)*Math.PI/180,q=x*Math.PI/180,p=w*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(q)*Math.cos(p),n=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),m=t*n;return m};e.exports={getDistanceFromLatitudeLongitude:g}},{}],296:[function(h,g,l){function k(m,f,s){var r=m.toArrayBuffer(),q=(0,i.numToUint8Array4)(f),p=s.byteLength,o=(0,i.uint16ToUint8Array2)(p),n=new Uint8Array(q.byteLength+o.byteLength+p+r.byteLength);return n.set(q,0),n.set(o,4),n.set(new Uint8Array(s),6),n.set(new Uint8Array(r),6+p),n.buffer}function j(u,t){var s=u.slice(0,4),r=u.slice(4,6),q=new Uint16Array(r)[0],p=u.slice(6,6+q),o=u.slice(6+q),n=new Uint32Array(s)[0],m=t(o);return{segmentCoord:m,id_chunk:n,data:p}}Object.defineProperty(l,"__esModule",{value:!0});var i=h("./Bytes");l.encodeMetaData=k,l.parseMetaData=j},{"./Bytes":294}],297:[function(g,f,j){Object.defineProperty(j,"__esModule",{value:!0});var i=function(b){return"number"==typeof b&&!isNaN(b)},h=function(){var d=0,c=function(e){if(i(e)){var k=e-d;return d=e,k}throw new TypeError("Delta object expects numerical values")};this.calcDelta=c};j.Delta=h,j.isNumeric=i},{}],298:[function(i,h,n){function m(w,v){var u=w.prototype,t=!0,s=!1,r=void 0;try{for(var q,p=k(l(u));!(t=(q=p.next()).done);t=!0){var o=q.value;if(typeof v[o]!=typeof u[o]){var f=v.constructor.name;throw new Error("The method "+o+" of "+w.name+" is not defined in "+f)}}}catch(e){s=!0,r=e}finally{try{!t&&p["return"]&&p["return"]()}finally{if(s){throw r}}}}function l(e){var d=j(e).filter(function(b){return"constructor"!==b});if(Object.getPrototypeOf(e)===Object.prototype){return d}var f=Object.getPrototypeOf(e);return d.concat(l(f))}var k=i("babel-runtime/core-js/get-iterator")["default"],j=i("babel-runtime/core-js/object/get-own-property-names")["default"];Object.defineProperty(n,"__esModule",{value:!0}),n.checkInterface=m,n._getEveryPropertyNames=l},{"babel-runtime/core-js/get-iterator":310,"babel-runtime/core-js/object/get-own-property-names":319}],299:[function(f,e,h){Object.defineProperty(h,"__esModule",{value:!0});var g=function(i,d){for(var j in i){i.hasOwnProperty(j)&&void 0!==d[j]&&(i[j]=d[j])}return i};h.overrideDefaults=g},{}],300:[function(H,G,F){function E(){var d=URL.createObjectURL(new Blob(["("+u["default"].toString()+")()"],{type:"application/javascript"})),c=new Worker(d);return URL.revokeObjectURL(d),c}function D(g){var f=g.data,j=f.id,i=f.type,h=t[j];"setTimeout"===i&&delete t[j],h&&h()}function C(e,d,f){return r++,t[r]=d,s.postMessage({time:f,id:r,type:e}),r}function B(d,c){delete t[c],s.postMessage({id:c,type:d})}function A(d,c){return C("setTimeout",d,c)}function z(d,c){return C("setInterval",d,c)}function y(b){B("clearTimeout",b)}function x(b){B("clearInterval",b)}var w=H("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(F,"__esModule",{value:!0}),F.reliableSetTimeout=A,F.reliableSetInterval=z,F.reliableClearTimeout=y,F.reliableClearInterval=x;var v=H("./TimerWorker"),u=w(v),t={},s=void 0;s=E(),s.onmessage=D;var r=0},{"./TimerWorker":301,"babel-runtime/helpers/interop-require-default":331}],301:[function(f,e,h){function g(){function b(d,c){return function(){return self.postMessage({id:d,type:c})}}self.onmessage=function(i){var m=i.data,l=m.type,k=m.id;switch(l){case"setTimeout":var j=m.time;setTimeout(b(k,l),j);break;case"setInterval":var j=m.time;setInterval(b(k,l),j);break;case"clearTimeout":clearTimeout(k);break;case"clearInterval":clearInterval(k)}}}Object.defineProperty(h,"__esModule",{value:!0}),h["default"]=g,e.exports=h["default"]},{}],302:[function(h,g,l){var k=h("babel-runtime/core-js/map")["default"],j=h("./TimerAbstraction"),i=function(){var B=this,A=[],z=[],y=new k,x=new k,w=function(b,m){var f=(0,j.reliableSetTimeout)(function(){v(f),b()},m);return A.push(f),f},v=function(b){for(var f in A){if(A[f]===b){(0,j.reliableClearTimeout)(b),A.splice(f,1);break}}},u=function(f,c){var m=(0,j.reliableSetInterval)(f,c);return z.push(m),m},t=function(f){for(var c in z){if(z[c]===f){(0,j.reliableClearInterval)(f),z.splice(c,1);break}}},s=function(m,f,o){if(!y.get(m)){var n=(0,j.reliableSetTimeout)(function(){r(m),f()},o);return y.set(m,n),n}return !1},r=function(f){var c=y.get(f);c&&((0,j.reliableClearTimeout)(c),y["delete"](f))},q=function(m,f,o){if(!x.get(m)){var n=(0,j.reliableSetInterval)(f,o);return x.set(m,n),n}return !1},e=function(f){var c=x.get(f);c&&((0,j.reliableClearInterval)(c),x["delete"](f))},d=function(){A.forEach(function(b){(0,j.reliableClearTimeout)(b)}),A=[],z.forEach(function(b){(0,j.reliableClearInterval)(b)}),z=[],x.forEach(function(b){(0,j.reliableClearInterval)(b)}),x.clear(),y.forEach(function(b){(0,j.reliableClearTimeout)(b)}),y.clear()};B.setTimeout=w,B.clearTimeout=v,B.setInterval=u,B.clearInterval=t,B.clearAll=d,B.setNamedTimeout=s,B.clearNamedTimeout=r,B.setNamedInterval=q,B.clearNamedInterval=e,B._getTimeoutArray=function(){return A},B._getIntervalArray=function(){return z},B._getNamedTimeoutMap=function(){return y},B._getNamedIntervalMap=function(){return x}};g.exports=i},{"./TimerAbstraction":300,"babel-runtime/core-js/map":312}],303:[function(x,w,v){function u(){return new p(m(),{optional:[{DtlsSrtpKeyAgreement:!0}]})}var t=x("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(v,"__esModule",{value:!0});var s=x("../../conf"),r=t(s),q=function(b){return b=b.replace(/b=AS([^\r\n]+\r\n)/g,""),b=b.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:50\r\n"),b=b.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:256\r\n"),b=b.replace(/a=mid:data\r\n/g,"a=mid:data\r\nb=AS:1638400\r\n")},p=window.RTCPeerConnection||window.webkitRTCPeerConnection,o=window.RTCIceCandidate,n=window.RTCSessionDescription,m=function(){return r["default"].ENABLE_TURN?{iceServers:r["default"].TURNSERVERS.concat(r["default"].STUNSERVERS)}:{iceServers:r["default"].STUNSERVERS}};v["default"]={transformOutgoingSdp:q,createPeerConnection:u,IceCandidate:o,SessionDescription:n},w.exports=v["default"]},{"../../conf":242,"babel-runtime/helpers/interop-require-default":331}],304:[function(f,e,h){function g(d,c){if(c.cacheSize&&(d.P2P_CACHE_MAX_SIZE=1024*c.cacheSize*1024,d.LIVE.P2P_CACHE_MAX_SIZE=d.P2P_CACHE_MAX_SIZE),void 0!==c.activateP2P&&(d.ALLOW_P2P=c.activateP2P),void 0!==c.debug&&(d.DEBUG=c.debug),c.signalingUrl&&(d.SIGNALING_URL=c.signalingUrl),c.trackerUrl&&(d.TRACKER_URL=c.trackerUrl),c.analyticsUrl&&(d.ANALYTICS_SERVER_URL=c.analyticsUrl),c.errorsUrl&&(d.ERRORS_URL=c.errorsUrl),void 0!==c.rangeRequestEnabled&&(d.RANGE_REQUEST_ALLOWED=c.rangeRequestEnabled),!c.streamrootKey){throw new Error("There must be a streamrootKey in the option object")}d.ID_CLIENT=c.streamrootKey}Object.defineProperty(h,"__esModule",{value:!0}),h["default"]=g,e.exports=h["default"]},{}],305:[function(h,g,l){var k=h("ua-parser-js"),j=new k;j.setUA(window.navigator.userAgent);var i=j.getResult();g.exports.isMobile=function(){var b="mobile"===i.device.type||"tablet"===i.device.type||"console"===i.device.type||"Android"===i.os.name||"iOS"===i.os.name;return b},g.exports.uaObject=i},{"ua-parser-js":337}],306:[function(X,W,V){function U(j,e,p){var o=document.getElementsByTagName("video");if(1!==o.length){throw new Error("BufferDisplay debug tool requiresa page with a single video")}var n=o[0],m=document.createElement("canvas");m.width=n.clientWidth||C;var l=document.getElementById("bufferDisplay");l||(l=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(l)),l.appendChild(m);var k=T.bind(null,m,n,j,e,p);setInterval(k,30)}function T(g,f,l,k,j){var i=S(l,k);R(g,{video:f,cacheState:i,currentTracks:j})}function S(ak,aj){var ai=aj.getTracksList(),ah=[],ag=!0,af=!1,ae=void 0;try{for(var ad,ac=M(ai);!(ag=(ad=ac.next()).done);ag=!0){var ab=ad.value,aa=new J["default"](aj),Z=ak.listDownloadedSegmentsForTrack(ab),Y=!0,y=!1,x=void 0;try{for(var w,v=M(Z);!(Y=(w=v.next()).done);Y=!0){var o=w.value;aa.addSegmentCoord(o)}}catch(l){y=!0,x=l}finally{try{!Y&&v["return"]&&v["return"]()}finally{if(y){throw x}}}ah.push({vbm:aa,coord:ab})}}catch(l){af=!0,ae=l}finally{try{!ag&&ac["return"]&&ac["return"]()}finally{if(af){throw ae}}}return ah}function R(aq,ap){var ao=ap.video,an=ap.cacheState,am=ap.currentTracks,al=ao.buffered,ak=ao.currentTime,aj=aq.getContext("2d");aq.height=(I+G)*an.length;var ai=1/0,ah=0,aa=!0,Y=!1,t=void 0;try{for(var r,p=M(an);!(aa=(r=p.next()).done);aa=!0){var ag=r.value.vbm;if(ag.length){var af=ag.start(0),ae=ag.end(ag.length-1);ai>af&&(ai=af),ae>ah&&(ah=ae)}}}catch(ad){Y=!0,t=ad}finally{try{!aa&&p["return"]&&p["return"]()}finally{if(Y){throw t}}}if(al.length){var ac=al.start(0),ab=al.end(al.length-1);ai>ac&&(ai=ac),ab>ah&&(ah=ab)}for(var Z={min:ai,max:ah,canvasWidth:aq.width},u=0;u<an.length;u++){var s=an[u],ag=s.vbm,q=s.coord,l=(I+G)*u,k={scale:Z,height:I,yPosition:l,color:F};O(aj,k,ag);var j=l+I/2;if(P(aj,q.viewToString(),j),Q(q,am)){var i={scale:Z,height:H,yPosition:l+(I-H),color:E};O(aj,i,al)}}var h={height:aq.height,color:D,scale:Z};N(aj,h,ak)}function Q(d,c){return d.isEqual(c.video)||d.isEqual(c.audio)}function P(e,d,f){e.fillStyle="green",e.font=A,e.fillText(d,0,f)}function O(v,u,t){for(var s=u.scale,r=u.height,q=u.yPosition,p=u.color,o=0;o<t.length;o++){var n=z(s,t.start(o)),m=z(s,t.end(o)),l=m-n>1?m-n:1;v.fillStyle=p,v.fillRect(n,q,l,r)}}function N(i,h,n){var m=h.color,l=h.scale,k=h.height,j=z(l,n);i.fillStyle=m,i.fillRect(j,0,1,k),i.fillStyle=m,i.font=A,i.fillText(n.toFixed(3),0,k)}var M=X("babel-runtime/core-js/get-iterator")["default"],L=X("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(V,"__esModule",{value:!0});var K=X("./VirtualBufferedManager"),J=L(K),I=30,H=10,G=3,F="#97b9e2",E="#202429",D="#bf0101",C=460,B=60,A="12px Arial",z=function(i,h){var n=i.min,m=i.max,l=i.canvasWidth,k=l-B,j=Math.max(m-n,180);return B+(h-n)*k/j};V["default"]=U,W.exports=V["default"]},{"./VirtualBufferedManager":307,"babel-runtime/core-js/get-iterator":310,"babel-runtime/helpers/interop-require-default":331}],307:[function(h,g,l){var k=h("babel-runtime/helpers/create-class")["default"],j=h("babel-runtime/helpers/class-call-check")["default"],i=function(){function b(c){j(this,b),this._buffered=[],this._mapManager=c}return k(b,null,[{key:"LAST_SEGMENT_DURATION",get:function(){return 3}}]),k(b,[{key:"start",value:function(c){return c in this._buffered?this._buffered[c].start:0}},{key:"end",value:function(c){return c in this._buffered?this._buffered[c].end:0}},{key:"addSegmentCoord",value:function(v){var u=this._mapManager.getNextSegmentView(v),t=void 0,s=void 0;try{t=this._mapManager.getSegmentTime(v),s=u?this._mapManager.getSegmentTime(u):t+b.LAST_SEGMENT_DURATION}catch(r){return}if(!this._buffered.length){return void this._buffered.push({start:t,end:s})}for(var q=void 0,p=void 0,o=0;o<this._buffered.length;o++){var n=this._buffered[o],m=this._buffered[o+1]||{start:1/0,end:1/0};if(n.end===t&&s===m.start){n.end=m.end,q=o+1;break}if(n.end===t&&s!==m.start){n.end=s;break}if(n.end!==t&&s===m.start){m.start=t;break}if(n.end<=t&&s<=m.start){p=o+1;break}}void 0!==q&&this._buffered.splice(q,1),void 0!==p&&this._buffered.splice(p,0,{start:t,end:s})}},{key:"length",get:function(){return this._buffered.length}}]),b}();g.exports=i},{"babel-runtime/helpers/class-call-check":326,"babel-runtime/helpers/create-class":327}],308:[function(V,U,T){function S(i,e){var n=document.getElementsByTagName("video");if(1!==n.length){throw new Error("BufferDisplay debug tool requiresa page with a single video")}var m=n[0],l=document.createElement("canvas"),k=document.getElementById("chunkDisplay");k||(k=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(k)),k.appendChild(l);var j=R.bind(null,l,i,e,m);setInterval(j,30)}function R(ad,ac,ab,aa){for(var Z=ab.getTracksList(),Y=new J,X=0;X<Z.length;X++){var W=Z[X];Y.set(W,[])}for(var x=ac.listSegmentsDownloadStatus(),X=0;X<x.length;X++){for(var w=x[X],v=w.segmentcoord,u=w.downloadStatusList,m=w.seederCount,k=0;k<Z.length;k++){var W=Z[k];if(v.isInTrack(W)){var f=L(u);try{var af=ab.getSegmentTime(v);Y.get(W).push({segmentAreas:f,id:v.viewToString(),time:af,length:u.length,seederCount:m})}catch(ae){}}}}Q(ad,Y,aa.currentTime)}function Q(al,ak,aj){al.height=1000,al.width=y*ak.size;var ai=void 0,ah=al.getContext("2d"),ag=0,af=!0,ae=!1,ad=void 0;try{for(var ac,ab=I(ak);!(af=(ac=ab.next()).done);af=!0){var Y=K(ac.value,2),W=Y[0],v=Y[1];ai=C,P(ah,W,ai,ag);var i=!0,g=!1,aa=void 0;try{for(var Z,X=I(v);!(i=(Z=X.next()).done);i=!0){var x=Z.value,w=x.id,t=x.time,q=x.segmentAreas,n=x.length,l=x.seederCount;t>aj-z&&(ai+=A,N(ah,q,n,ai,ag),O(ah,{id:w,time:t,seederCount:l},ai,ag),ai+=F)}}catch(h){g=!0,aa=h}finally{try{!i&&X["return"]&&X["return"]()}finally{if(g){throw aa}}}ag++}}catch(h){ae=!0,ad=h}finally{try{!af&&ab["return"]&&ab["return"]()}finally{if(ae){throw ad}}}}function P(g,f,j,i){var h=y*i;g.fillStyle=E,g.font=B,g.fillText(f.viewToString(),h,j)}function O(j,i,p,o){var n=i.id,m=i.time,l=i.seederCount,k=y*o;j.fillStyle=D,j.font=B,j.fillText(n+"  --  "+m.toFixed(1)+" -- "+l,k,p+F)}function N(Z,Y,X,W,x){var w=y*x,v=0,u=!0,q=!1,p=void 0;try{for(var o,n=I(Y);!(u=(o=n.next()).done);u=!0){var j=o.value,ab=(j.end-j.start)*G/X;Z.fillStyle=M(j.status),Z.fillRect(w+H+v,W,ab,F),v+=ab}}catch(aa){q=!0,p=aa}finally{try{!u&&n["return"]&&n["return"]()}finally{if(q){throw p}}}Y.length||(Z.fillStyle="#D490D4",Z.fillRect(w+H,W,G,F))}function M(b){switch(b){case"pending":return"gray";case"downloading":return"blue";case"downloaded":return"green";case"CDNdownloaded":return"orange";case"failed":return"red"}}function L(h){for(var g=void 0,l=[],k=0;k<h.length;k++){var j=h[k];if(g===j){l[l.length-1].end++}else{var i={start:k,end:k+1,status:j};g=j,l.push(i)}}return l}var K=V("babel-runtime/helpers/sliced-to-array")["default"],J=V("babel-runtime/core-js/map")["default"],I=V("babel-runtime/core-js/get-iterator")["default"];Object.defineProperty(T,"__esModule",{value:!0});var H=100,G=100,F=15,E="red",D="black",C=15,B=C+"px Arial",A=5,z=10,y=H+G+20;T["default"]=S,U.exports=T["default"]},{"babel-runtime/core-js/get-iterator":310,"babel-runtime/core-js/map":312,"babel-runtime/helpers/sliced-to-array":332}],309:[function(e,d,f){d.exports={"default":e("core-js/library/fn/array/from"),__esModule:!0}},{"core-js/library/fn/array/from":69}],310:[function(e,d,f){d.exports={"default":e("core-js/library/fn/get-iterator"),__esModule:!0}},{"core-js/library/fn/get-iterator":70}],311:[function(e,d,f){d.exports={"default":e("core-js/library/fn/is-iterable"),__esModule:!0}},{"core-js/library/fn/is-iterable":71}],312:[function(e,d,f){d.exports={"default":e("core-js/library/fn/map"),__esModule:!0}},{"core-js/library/fn/map":72}],313:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":73}],314:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":74}],315:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/define-properties"),__esModule:!0}},{"core-js/library/fn/object/define-properties":75}],316:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":76}],317:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/freeze"),__esModule:!0}},{"core-js/library/fn/object/freeze":77}],318:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-descriptor":78}],319:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/get-own-property-names"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-names":79}],320:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":80}],321:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/seal"),__esModule:!0}},{"core-js/library/fn/object/seal":81}],322:[function(e,d,f){d.exports={"default":e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":82}],323:[function(e,d,f){d.exports={"default":e("core-js/library/fn/promise"),__esModule:!0}},{"core-js/library/fn/promise":83}],324:[function(e,d,f){d.exports={"default":e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":84}],325:[function(e,d,f){d.exports={"default":e("core-js/library/fn/symbol/iterator"),__esModule:!0}},{"core-js/library/fn/symbol/iterator":85}],326:[function(e,d,f){f["default"]=function(g,c){if(!(g instanceof c)){throw new TypeError("Cannot call a class as a function")}},f.__esModule=!0},{}],327:[function(f,e,h){var g=f("babel-runtime/core-js/object/define-property")["default"];h["default"]=function(){function b(i,d){for(var k=0;k<d.length;k++){var j=d[k];j.enumerable=j.enumerable||!1,j.configurable=!0,"value" in j&&(j.writable=!0),g(i,j.key,j)}}return function(i,k,j){return k&&b(i.prototype,k),j&&b(i,j),i}}(),h.__esModule=!0},{"babel-runtime/core-js/object/define-property":316}],328:[function(f,e,h){var g=f("babel-runtime/core-js/object/define-property")["default"];h["default"]=function(i,d,j){return d in i?g(i,d,{value:j,enumerable:!0,configurable:!0,writable:!0}):i[d]=j,i},h.__esModule=!0},{"babel-runtime/core-js/object/define-property":316}],329:[function(f,e,h){var g=f("babel-runtime/core-js/object/get-own-property-descriptor")["default"];h["default"]=function(t,s,r){for(var q=!0;q;){var p=t,o=s,n=r;q=!1,null===p&&(p=Function.prototype);var m=g(p,o);if(void 0!==m){if("value" in m){return m.value}var l=m.get;return void 0===l?void 0:l.call(n)}var d=Object.getPrototypeOf(p);if(null===d){return void 0}t=d,s=o,r=n,q=!0,m=d=void 0}},h.__esModule=!0},{"babel-runtime/core-js/object/get-own-property-descriptor":318}],330:[function(g,f,j){var i=g("babel-runtime/core-js/object/create")["default"],h=g("babel-runtime/core-js/object/set-prototype-of")["default"];j["default"]=function(d,c){if("function"!=typeof c&&null!==c){throw new TypeError("Super expression must either be null or a function, not "+typeof c)}d.prototype=i(c&&c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),c&&(h?h(d,c):d.__proto__=c)},j.__esModule=!0},{"babel-runtime/core-js/object/create":314,"babel-runtime/core-js/object/set-prototype-of":322}],331:[function(e,d,f){f["default"]=function(b){return b&&b.__esModule?b:{"default":b}},f.__esModule=!0},{}],332:[function(g,f,j){var i=g("babel-runtime/core-js/get-iterator")["default"],h=g("babel-runtime/core-js/is-iterable")["default"];j["default"]=function(){function b(r,q){var p=[],o=!0,n=!1,m=void 0;try{for(var l,k=i(r);!(o=(l=k.next()).done)&&(p.push(l.value),!q||p.length!==q);o=!0){}}catch(d){n=!0,m=d}finally{try{!o&&k["return"]&&k["return"]()}finally{if(n){throw m}}}return p}return function(d,e){if(Array.isArray(d)){return d}if(h(Object(d))){return b(d,e)}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),j.__esModule=!0},{"babel-runtime/core-js/get-iterator":310,"babel-runtime/core-js/is-iterable":311}],333:[function(f,e,h){var g=f("babel-runtime/core-js/array/from")["default"];h["default"]=function(i){if(Array.isArray(i)){for(var d=0,j=Array(i.length);d<i.length;d++){j[d]=i[d]}return j}return g(i)},h.__esModule=!0},{"babel-runtime/core-js/array/from":309}],334:[function(e,d,f){(function(k){var j="object"==typeof k?k:"object"==typeof window?window:"object"==typeof self?self:this,i=j.regeneratorRuntime&&Object.getOwnPropertyNames(j).indexOf("regeneratorRuntime")>=0,h=i&&j.regeneratorRuntime;if(j.regeneratorRuntime=void 0,d.exports=e("./runtime"),i){j.regeneratorRuntime=h}else{try{delete j.regeneratorRuntime}catch(b){j.regeneratorRuntime=void 0}}d.exports={"default":d.exports,__esModule:!0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./runtime":335}],335:[function(e,d,f){(function(m,l){var k=e("babel-runtime/core-js/symbol")["default"],j=e("babel-runtime/core-js/object/create")["default"],i=e("babel-runtime/core-js/object/set-prototype-of")["default"],b=e("babel-runtime/core-js/promise")["default"];!function(ag){function af(o,n,s,r){var q=j((n||ad).prototype),p=new R(r||[]);return q._invoke=X(o,s,p),q}function ae(o,n,q){try{return{type:"normal",arg:o.call(n,q)}}catch(p){return{type:"throw",arg:p}}}function ad(){}function ac(){}function ab(){}function aa(n){["next","throw","return"].forEach(function(o){n[o]=function(p){return this._invoke(o,p)}})}function Z(n){this.arg=n}function Y(o){function n(x,w,v,u){var t=ae(o[x],o,w);if("throw"!==t.type){var s=t.arg,r=s.value;return r instanceof Z?b.resolve(r.arg).then(function(y){n("next",y,v,u)},function(y){n("throw",y,v,u)}):b.resolve(r).then(function(y){s.value=y,v(s)},u)}u(t.arg)}function q(r,t){function s(){return new b(function(v,u){n(r,t,v,u)})}return p=p?p.then(s,s):s()}"object"==typeof m&&m.domain&&(n=m.domain.bind(n));var p;this._invoke=q}function X(o,n,q){var p=S;return function(w,v){if(p===O){throw new Error("Generator is already running")}if(p===M){if("throw"===w){throw v}return N()}for(;;){var u=q.delegate;if(u){if("return"===w||"throw"===w&&u.iterator[w]===L){q.delegate=null;var t=u.iterator["return"];if(t){var s=ae(t,u.iterator,v);if("throw"===s.type){w="throw",v=s.arg;continue}}if("return"===w){continue}}var s=ae(u.iterator[w],u.iterator,v);if("throw"===s.type){q.delegate=null,w="throw",v=s.arg;continue}w="next",v=L;var r=s.arg;if(!r.done){return p=Q,r}q[u.resultName]=r.value,q.next=u.nextLoc,q.delegate=null}if("next"===w){p===Q?q.sent=v:q.sent=L}else{if("throw"===w){if(p===S){throw p=M,v}q.dispatchException(v)&&(w="next",v=L)}else{"return"===w&&q.abrupt("return",v)}}p=O;var s=ae(o,n,q);if("normal"===s.type){p=q.done?M:Q;var r={value:s.arg,done:q.done};if(s.arg!==K){return r}q.delegate&&"next"===w&&(v=L)}else{"throw"===s.type&&(p=M,w="throw",v=s.arg)}}}}function V(o){var n={tryLoc:o[0]};1 in o&&(n.catchLoc=o[1]),2 in o&&(n.finallyLoc=o[2],n.afterLoc=o[3]),this.tryEntries.push(n)}function T(o){var n=o.completion||{};n.type="normal",delete n.arg,o.completion=n}function R(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(V,this),this.reset(!0)}function P(o){if(o){var n=o[g];if(n){return n.call(o)}if("function"==typeof o.next){return o}if(!isNaN(o.length)){var r=-1,q=function p(){for(;++r<o.length;){if(J.call(o,r)){return p.value=o[r],p.done=!1,p}}return p.value=L,p.done=!0,p};return q.next=q}}return{next:N}}function N(){return{value:L,done:!0}}var L,J=Object.prototype.hasOwnProperty,h="function"==typeof k?k:{},g=h.iterator||"@@iterator",c=h.toStringTag||"@@toStringTag",W="object"==typeof d,U=ag.regeneratorRuntime;if(U){return void (W&&(d.exports=U))}U=ag.regeneratorRuntime=W?d.exports:{},U.wrap=af;var S="suspendedStart",Q="suspendedYield",O="executing",M="completed",K={},I=ab.prototype=ad.prototype;ac.prototype=I.constructor=ab,ab.constructor=ac,ab[c]=ac.displayName="GeneratorFunction",U.isGeneratorFunction=function(o){var n="function"==typeof o&&o.constructor;return n?n===ac||"GeneratorFunction"===(n.displayName||n.name):!1},U.mark=function(n){return i?i(n,ab):(n.__proto__=ab,c in n||(n[c]="GeneratorFunction")),n.prototype=j(I),n},U.awrap=function(n){return new Z(n)},aa(Y.prototype),U.async=function(o,n,r,q){var p=new Y(af(o,n,r,q));return U.isGeneratorFunction(n)?p:p.next().then(function(s){return s.done?s.value:p.next()})},aa(I),I[g]=function(){return this},I[c]="Generator",I.toString=function(){return"[object Generator]"},U.keys=function(o){var n=[];for(var q in o){n.push(q)}return n.reverse(),function p(){for(;n.length;){var r=n.pop();if(r in o){return p.value=r,p.done=!1,p}}return p.done=!0,p}},U.values=P,R.prototype={constructor:R,reset:function(o){if(this.prev=0,this.next=0,this.sent=L,this.done=!1,this.delegate=null,this.tryEntries.forEach(T),!o){for(var n in this){"t"===n.charAt(0)&&J.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=L)}}},stop:function(){this.done=!0;var o=this.tryEntries[0],n=o.completion;if("throw"===n.type){throw n.arg}return this.rval},dispatchException:function(o){function n(v,w){return r.type="throw",r.arg=o,u.next=v,!!w}if(this.done){throw o}for(var u=this,t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t],r=s.completion;if("root"===s.tryLoc){return n("end")}if(s.tryLoc<=this.prev){var q=J.call(s,"catchLoc"),p=J.call(s,"finallyLoc");if(q&&p){if(this.prev<s.catchLoc){return n(s.catchLoc,!0)}if(this.prev<s.finallyLoc){return n(s.finallyLoc)}}else{if(q){if(this.prev<s.catchLoc){return n(s.catchLoc,!0)}}else{if(!p){throw new Error("try statement without catch or finally")}if(this.prev<s.finallyLoc){return n(s.finallyLoc)}}}}}},abrupt:function(o,n){for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s];if(r.tryLoc<=this.prev&&J.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var q=r;break}}q&&("break"===o||"continue"===o)&&q.tryLoc<=n&&n<=q.finallyLoc&&(q=null);var p=q?q.completion:{};return p.type=o,p.arg=n,q?this.next=q.finallyLoc:this.complete(p),K},complete:function(o,n){if("throw"===o.type){throw o.arg}"break"===o.type||"continue"===o.type?this.next=o.arg:"return"===o.type?(this.rval=o.arg,this.next="end"):"normal"===o.type&&n&&(this.next=n)},finish:function(o){for(var n=this.tryEntries.length-1;n>=0;--n){var p=this.tryEntries[n];if(p.finallyLoc===o){return this.complete(p.completion,p.afterLoc),T(p),K}}},"catch":function(o){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===o){var q=r.completion;if("throw"===q.type){var p=q.arg;T(r)}return p}}throw new Error("illegal catch attempt")},delegateYield:function(o,n,p){return this.delegate={iterator:P(o),resultName:n,nextLoc:p},K}}}("object"==typeof l?l:"object"==typeof window?window:"object"==typeof self?self:void 0)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:165,"babel-runtime/core-js/object/create":314,"babel-runtime/core-js/object/set-prototype-of":322,"babel-runtime/core-js/promise":323,"babel-runtime/core-js/symbol":324}],336:[function(f,e,h){function g(j,i){var l=[];i=i||0;for(var k=i||0;k<j.length;k++){l[k-i]=j[k]}return l}e.exports=g},{}],337:[function(e,d,f){!function(af,ae){var ad="0.7.9",ac="",ab="?",aa="function",Z="undefined",Y="object",X="string",W="major",V="model",U="name",T="type",S="vendor",Q="version",O="architecture",M="console",K="mobile",I="tablet",H="smarttv",G="wearable",F="embedded",c={extend:function(h,g){for(var i in g){-1!=="browser cpu device engine os".indexOf(i)&&g[i].length%2===0&&(h[i]=g[i].concat(h[i]))}return h},has:function(h,g){return"string"==typeof h?-1!==g.toLowerCase().indexOf(h.toLowerCase()):!1},lowerize:function(g){return g.toLowerCase()},major:function(g){return typeof g===X?g.split(".")[0]:ae}},b={rgx:function(){for(var w,v,u,t,s,r,q,p=0,j=arguments;p<j.length&&!r;){var i=j[p],h=j[p+1];if(typeof w===Z){w={};for(t in h){s=h[t],typeof s===Y?w[s[0]]=ae:w[s]=ae}}for(v=u=0;v<i.length&&!r;){if(r=i[v++].exec(this.getUA())){for(t=0;t<h.length;t++){q=r[++u],s=h[t],typeof s===Y&&s.length>0?2==s.length?typeof s[1]==aa?w[s[0]]=s[1].call(this,q):w[s[0]]=s[1]:3==s.length?typeof s[1]!==aa||s[1].exec&&s[1].test?w[s[0]]=q?q.replace(s[1],s[2]):ae:w[s[0]]=q?s[1].call(this,q,s[2]):ae:4==s.length&&(w[s[0]]=q?s[3].call(this,q.replace(s[1],s[2])):ae):w[s]=q?q:ae}}}p+=2}return w},str:function(h,g){for(var j in g){if(typeof g[j]===Y&&g[j].length>0){for(var i=0;i<g[j].length;i++){if(c.has(g[j][i],h)){return j===ab?ae:j}}}else{if(c.has(g[j],h)){return j===ab?ae:j}}}return h}},R={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},P={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[U,Q],[/\s(opr)\/([\w\.]+)/i],[[U,"Opera"],Q],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium)\/([\w\.-]+)/i],[U,Q],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[U,"IE"],Q],[/(edge)\/((\d+)?[\w\.]+)/i],[U,Q],[/(yabrowser)\/([\w\.]+)/i],[[U,"Yandex"],Q],[/(comodo_dragon)\/([\w\.]+)/i],[[U,/_/g," "],Q],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[U,Q],[/(dolfin)\/([\w\.]+)/i],[[U,"Dolphin"],Q],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[U,"Chrome"],Q],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[Q,[U,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[Q,[U,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[Q,[U,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[Q,[U,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[Q,U],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[U,[Q,b.str,R.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[U,Q],[/(navigator|netscape)\/([\w\.-]+)/i],[[U,"Netscape"],Q],[/fxios\/([\w\.-]+)/i],[Q,[U,"Firefox"]],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[U,Q]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[O,"amd64"]],[/(ia32(?=;))/i],[[O,c.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[O,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[O,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[O,/ower/,"",c.lowerize]],[/(sun4\w)[;\)]/i],[[O,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[O,c.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[V,S,[T,I]],[/applecoremedia\/[\w\.]+ \((ipad)/],[V,[S,"Apple"],[T,I]],[/(apple\s{0,1}tv)/i],[[V,"Apple TV"],[S,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[S,V,[T,I]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[V,[S,"Amazon"],[T,I]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[V,b.str,R.device.amazon.model],[S,"Amazon"],[T,K]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[V,S,[T,K]],[/\((ip[honed|\s\w*]+);/i],[V,[S,"Apple"],[T,K]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[S,V,[T,K]],[/\(bb10;\s(\w+)/i],[V,[S,"BlackBerry"],[T,K]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],[V,[S,"Asus"],[T,I]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[S,"Sony"],[V,"Xperia Tablet"],[T,I]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[S,"Sony"],[V,"Xperia Phone"],[T,K]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[S,V,[T,M]],[/android.+;\s(shield)\sbuild/i],[V,[S,"Nvidia"],[T,M]],[/(playstation\s[3portablevi]+)/i],[V,[S,"Sony"],[T,M]],[/(sprint\s(\w+))/i],[[S,b.str,R.device.sprint.vendor],[V,b.str,R.device.sprint.model],[T,K]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[S,V,[T,I]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[S,[V,/_/g," "],[T,K]],[/(nexus\s9)/i],[V,[S,"HTC"],[T,I]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[V,[S,"Microsoft"],[T,M]],[/(kin\.[onetw]{3})/i],[[V,/\./g," "],[S,"Microsoft"],[T,K]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i],[V,[S,"Motorola"],[T,K]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[V,[S,"Motorola"],[T,I]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[S,"Samsung"],V,[T,I]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[S,"Samsung"],V,[T,K]],[/(samsung);smarttv/i],[S,V,[T,H]],[/\(dtv[\);].+(aquos)/i],[V,[S,"Sharp"],[T,H]],[/sie-(\w+)*/i],[V,[S,"Siemens"],[T,K]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[S,"Nokia"],V,[T,K]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[V,[S,"Acer"],[T,I]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[S,"LG"],V,[T,I]],[/(lg) netcast\.tv/i],[S,V,[T,H]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[V,[S,"LG"],[T,K]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[V,[S,"Lenovo"],[T,I]],[/linux;.+((jolla));/i],[S,V,[T,K]],[/((pebble))app\/[\d\.]+\s/i],[S,V,[T,G]],[/android.+;\s(glass)\s\d/i],[V,[S,"Google"],[T,G]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[[V,/_/g," "],[S,"Xiaomi"],[T,K]],[/(mobile|tablet);.+rv\:.+gecko\//i],[[T,c.lowerize],S,V]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[Q,[U,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[U,Q],[/rv\:([\w\.]+).*(gecko)/i],[Q,U]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[U,Q],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[U,[Q,b.str,R.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[U,"Windows"],[Q,b.str,R.os.windows.version]],[/\((bb)(10);/i],[[U,"BlackBerry"],Q],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[U,Q],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[U,"Symbian"],Q],[/\((series40);/i],[U],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[U,"Firefox OS"],Q],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[U,Q],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[U,"Chromium OS"],Q],[/(sunos)\s?([\w\.]+\d)*/i],[[U,"Solaris"],Q],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[U,Q],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[U,"iOS"],[Q,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[U,"Mac OS"],[Q,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[U,Q]]},N=function(g,j){if(!(this instanceof N)){return new N(g,j).getResult()}var i=g||(af&&af.navigator&&af.navigator.userAgent?af.navigator.userAgent:ac),h=j?c.extend(P,j):P;return this.getBrowser=function(){var k=b.rgx.apply(this,h.browser);return k.major=c.major(k.version),k},this.getCPU=function(){return b.rgx.apply(this,h.cpu)},this.getDevice=function(){return b.rgx.apply(this,h.device)},this.getEngine=function(){return b.rgx.apply(this,h.engine)},this.getOS=function(){return b.rgx.apply(this,h.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(k){return i=k,this},this.setUA(i),this};N.VERSION=ad,N.BROWSER={NAME:U,MAJOR:W,VERSION:Q},N.CPU={ARCHITECTURE:O},N.DEVICE={MODEL:V,VENDOR:S,TYPE:T,CONSOLE:M,MOBILE:K,SMARTTV:H,TABLET:I,WEARABLE:G,EMBEDDED:F},N.ENGINE={NAME:U,VERSION:Q},N.OS={NAME:U,VERSION:Q},typeof f!==Z?(typeof d!==Z&&d.exports&&(f=d.exports=N),f.UAParser=N):typeof define===aa&&define.amd?define(function(){return N}):af.UAParser=N;var L=af.jQuery||af.Zepto;if(typeof L!==Z){var J=new N;L.ua=J.getResult(),L.ua.get=function(){return J.getUA()},L.ua.set=function(h){J.setUA(h);var g=J.getResult();for(var i in g){L.ua[i]=g[i]}}}}("object"==typeof window?window:this)},{}],338:[function(e,d,f){(function(){var aA=this,az=aA._,ay={},ax=Array.prototype,aw=Object.prototype,av=Function.prototype,au=ax.push,at=ax.slice,ar=ax.concat,aq=aw.toString,ap=aw.hasOwnProperty,ao=ax.forEach,an=ax.map,am=ax.reduce,al=ax.reduceRight,ak=ax.filter,aj=ax.every,ai=ax.some,ah=ax.indexOf,ag=ax.lastIndexOf,af=Array.isArray,ae=Object.keys,ad=av.bind,ac=function(g){return g instanceof ac?g:this instanceof ac?void (this._wrapped=g):new ac(g)};"undefined"!=typeof f?("undefined"!=typeof d&&d.exports&&(f=d.exports=ac),f._=ac):aA._=ac,ac.VERSION="1.6.0";var ab=ac.each=ac.forEach=function(i,h,m){if(null==i){return i}if(ao&&i.forEach===ao){i.forEach(h,m)}else{if(i.length===+i.length){for(var l=0,k=i.length;k>l;l++){if(h.call(m,i[l],l,i)===ay){return}}}else{for(var j=ac.keys(i),l=0,k=j.length;k>l;l++){if(h.call(m,i[j[l]],j[l],i)===ay){return}}}}return i};ac.map=ac.collect=function(h,g,j){var i=[];return null==h?i:an&&h.map===an?h.map(g,j):(ab(h,function(k,m,l){i.push(g.call(j,k,m,l))}),i)};var aa="Reduce of empty array with no initial value";ac.reduce=ac.foldl=ac.inject=function(h,g,k,j){var i=arguments.length>2;if(null==h&&(h=[]),am&&h.reduce===am){return j&&(g=ac.bind(g,j)),i?h.reduce(g,k):h.reduce(g)}if(ab(h,function(l,n,m){i?k=g.call(j,k,l,n,m):(k=l,i=!0)}),!i){throw new TypeError(aa)}return k},ac.reduceRight=ac.foldr=function(i,h,n,m){var l=arguments.length>2;if(null==i&&(i=[]),al&&i.reduceRight===al){return m&&(h=ac.bind(h,m)),l?i.reduceRight(h,n):i.reduceRight(h)}var k=i.length;if(k!==+k){var j=ac.keys(i);k=j.length}if(ab(i,function(p,o,g){o=j?j[--k]:--k,l?n=h.call(m,n,i[o],o,g):(n=i[o],l=!0)}),!l){throw new TypeError(aa)}return n},ac.find=ac.detect=function(h,g,j){var i;return Z(h,function(k,m,l){return g.call(j,k,m,l)?(i=k,!0):void 0}),i},ac.filter=ac.select=function(h,g,j){var i=[];return null==h?i:ak&&h.filter===ak?h.filter(g,j):(ab(h,function(k,m,l){g.call(j,k,m,l)&&i.push(k)}),i)},ac.reject=function(h,g,i){return ac.filter(h,function(j,l,k){return !g.call(i,j,l,k)},i)},ac.every=ac.all=function(h,g,j){g||(g=ac.identity);var i=!0;return null==h?i:aj&&h.every===aj?h.every(g,j):(ab(h,function(k,m,l){return(i=i&&g.call(j,k,m,l))?void 0:ay}),!!i)};var Z=ac.some=ac.any=function(h,g,j){g||(g=ac.identity);var i=!1;return null==h?i:ai&&h.some===ai?h.some(g,j):(ab(h,function(k,m,l){return i||(i=g.call(j,k,m,l))?ay:void 0}),!!i)};ac.contains=ac.include=function(h,g){return null==h?!1:ah&&h.indexOf===ah?-1!=h.indexOf(g):Z(h,function(i){return i===g})},ac.invoke=function(h,g){var j=at.call(arguments,2),i=ac.isFunction(g);return ac.map(h,function(k){return(i?g:k[g]).apply(k,j)})},ac.pluck=function(h,g){return ac.map(h,ac.property(g))},ac.where=function(h,g){return ac.filter(h,ac.matches(g))},ac.findWhere=function(h,g){return ac.find(h,ac.matches(g))},ac.max=function(h,g,k){if(!g&&ac.isArray(h)&&h[0]===+h[0]&&h.length<65535){return Math.max.apply(Math,h)}var j=-(1/0),i=-(1/0);return ab(h,function(l,o,n){var m=g?g.call(k,l,o,n):l;m>i&&(j=l,i=m)}),j},ac.min=function(h,g,k){if(!g&&ac.isArray(h)&&h[0]===+h[0]&&h.length<65535){return Math.min.apply(Math,h)}var j=1/0,i=1/0;return ab(h,function(l,o,n){var m=g?g.call(k,l,o,n):l;i>m&&(j=l,i=m)}),j},ac.shuffle=function(h){var g,j=0,i=[];return ab(h,function(k){g=ac.random(j++),i[j-1]=i[g],i[g]=k}),i},ac.sample=function(h,g,i){return null==g||i?(h.length!==+h.length&&(h=ac.values(h)),h[ac.random(h.length-1)]):ac.shuffle(h).slice(0,Math.max(0,g))};var Y=function(g){return null==g?ac.identity:ac.isFunction(g)?g:ac.property(g)};ac.sortBy=function(h,g,i){return g=Y(g),ac.pluck(ac.map(h,function(j,l,k){return{value:j,index:l,criteria:g.call(i,j,l,k)}}).sort(function(k,j){var m=k.criteria,l=j.criteria;if(m!==l){if(m>l||void 0===m){return 1}if(l>m||void 0===l){return -1}}return k.index-j.index}),"value")};var X=function(g){return function(h,k,j){var i={};return k=Y(k),ab(h,function(n,m){var l=k.call(j,n,m,h);g(i,l,n)}),i}};ac.groupBy=X(function(h,g,i){ac.has(h,g)?h[g].push(i):h[g]=[i]}),ac.indexBy=X(function(h,g,i){h[g]=i}),ac.countBy=X(function(h,g){ac.has(h,g)?h[g]++:h[g]=1}),ac.sortedIndex=function(j,i,p,o){p=Y(p);for(var n=p.call(o,i),m=0,l=j.length;l>m;){var k=m+l>>>1;p.call(o,j[k])<n?m=k+1:l=k}return m},ac.toArray=function(g){return g?ac.isArray(g)?at.call(g):g.length===+g.length?ac.map(g,ac.identity):ac.values(g):[]},ac.size=function(g){return null==g?0:g.length===+g.length?g.length:ac.keys(g).length},ac.first=ac.head=ac.take=function(h,g,i){return null==h?void 0:null==g||i?h[0]:0>g?[]:at.call(h,0,g)},ac.initial=function(h,g,i){return at.call(h,0,h.length-(null==g||i?1:g))},ac.last=function(h,g,i){return null==h?void 0:null==g||i?h[h.length-1]:at.call(h,Math.max(h.length-g,0))},ac.rest=ac.tail=ac.drop=function(h,g,i){return at.call(h,null==g||i?1:g)},ac.compact=function(g){return ac.filter(g,ac.identity)};var W=function(h,g,i){return g&&ac.every(h,ac.isArray)?ar.apply(i,h):(ab(h,function(j){ac.isArray(j)||ac.isArguments(j)?g?au.apply(i,j):W(j,g,i):i.push(j)}),i)};ac.flatten=function(h,g){return W(h,g,[])},ac.without=function(g){return ac.difference(g,at.call(arguments,1))},ac.partition=function(h,g){var j=[],i=[];return ab(h,function(k){(g(k)?j:i).push(k)}),[j,i]},ac.uniq=ac.unique=function(i,h,n,m){ac.isFunction(h)&&(m=n,n=h,h=!1);var l=n?ac.map(i,n,m):i,k=[],j=[];return ab(l,function(o,g){(h?g&&j[j.length-1]===o:ac.contains(j,o))||(j.push(o),k.push(i[g]))}),k},ac.union=function(){return ac.uniq(ac.flatten(arguments,!0))},ac.intersection=function(h){var g=at.call(arguments,1);return ac.filter(ac.uniq(h),function(i){return ac.every(g,function(j){return ac.contains(j,i)})})},ac.difference=function(h){var g=ar.apply(ax,at.call(arguments,1));return ac.filter(h,function(i){return !ac.contains(g,i)})},ac.zip=function(){for(var h=ac.max(ac.pluck(arguments,"length").concat(0)),g=new Array(h),i=0;h>i;i++){g[i]=ac.pluck(arguments,""+i)}return g},ac.object=function(h,g){if(null==h){return{}}for(var k={},j=0,i=h.length;i>j;j++){g?k[h[j]]=g[j]:k[h[j][0]]=h[j][1]}return k},ac.indexOf=function(h,g,k){if(null==h){return -1}var j=0,i=h.length;if(k){if("number"!=typeof k){return j=ac.sortedIndex(h,g),h[j]===g?j:-1}j=0>k?Math.max(0,i+k):k}if(ah&&h.indexOf===ah){return h.indexOf(g,k)}for(;i>j;j++){if(h[j]===g){return j}}return -1},ac.lastIndexOf=function(h,g,k){if(null==h){return -1}var j=null!=k;if(ag&&h.lastIndexOf===ag){return j?h.lastIndexOf(g,k):h.lastIndexOf(g)}for(var i=j?k:h.length;i--;){if(h[i]===g){return i}}return -1},ac.range=function(h,g,l){arguments.length<=1&&(g=h||0,h=0),l=arguments[2]||1;for(var k=Math.max(Math.ceil((g-h)/l),0),j=0,i=new Array(k);k>j;){i[j++]=h,h+=l}return i};var V=function(){};ac.bind=function(h,g){var j,i;if(ad&&h.bind===ad){return ad.apply(h,at.call(arguments,1))}if(!ac.isFunction(h)){throw new TypeError}return j=at.call(arguments,2),i=function(){if(!(this instanceof i)){return h.apply(g,j.concat(at.call(arguments)))}V.prototype=h.prototype;var l=new V;V.prototype=null;var k=h.apply(l,j.concat(at.call(arguments)));return Object(k)===k?k:l}},ac.partial=function(h){var g=at.call(arguments,1);return function(){for(var l=0,k=g.slice(),j=0,i=k.length;i>j;j++){k[j]===ac&&(k[j]=arguments[l++])}for(;l<arguments.length;){k.push(arguments[l++])}return h.apply(this,k)}},ac.bindAll=function(h){var g=at.call(arguments,1);if(0===g.length){throw new Error("bindAll must be passed function names")}return ab(g,function(i){h[i]=ac.bind(h[i],h)}),h},ac.memoize=function(h,g){var i={};return g||(g=ac.identity),function(){var j=g.apply(this,arguments);return ac.has(i,j)?i[j]:i[j]=h.apply(this,arguments)}},ac.delay=function(h,g){var i=at.call(arguments,2);return setTimeout(function(){return h.apply(null,i)},g)},ac.defer=function(g){return ac.delay.apply(ac,[g,1].concat(at.call(arguments,1)))},ac.throttle=function(r,q,p){var o,n,m,l=null,k=0;p||(p={});var j=function(){k=p.leading===!1?0:ac.now(),l=null,m=r.apply(o,n),o=n=null};return function(){var h=ac.now();k||p.leading!==!1||(k=h);var g=q-(h-k);return o=this,n=arguments,0>=g?(clearTimeout(l),l=null,k=h,m=r.apply(o,n),o=n=null):l||p.trailing===!1||(l=setTimeout(j,g)),m}},ac.debounce=function(r,q,p){var o,n,m,l,k,j=function(){var g=ac.now()-l;q>g?o=setTimeout(j,q-g):(o=null,p||(k=r.apply(m,n),m=n=null))};return function(){m=this,n=arguments,l=ac.now();var g=p&&!o;return o||(o=setTimeout(j,q)),g&&(k=r.apply(m,n),m=n=null),k}},ac.once=function(h){var g,i=!1;return function(){return i?g:(i=!0,g=h.apply(this,arguments),h=null,g)}},ac.wrap=function(h,g){return ac.partial(g,h)},ac.compose=function(){var g=arguments;return function(){for(var h=arguments,i=g.length-1;i>=0;i--){h=[g[i].apply(this,h)]}return h[0]}},ac.after=function(h,g){return function(){return --h<1?g.apply(this,arguments):void 0}},ac.keys=function(h){if(!ac.isObject(h)){return[]}if(ae){return ae(h)}var g=[];for(var i in h){ac.has(h,i)&&g.push(i)}return g},ac.values=function(h){for(var g=ac.keys(h),k=g.length,j=new Array(k),i=0;k>i;i++){j[i]=h[g[i]]}return j},ac.pairs=function(h){for(var g=ac.keys(h),k=g.length,j=new Array(k),i=0;k>i;i++){j[i]=[g[i],h[g[i]]]}return j},ac.invert=function(h){for(var g={},k=ac.keys(h),j=0,i=k.length;i>j;j++){g[h[k[j]]]=k[j]}return g},ac.functions=ac.methods=function(h){var g=[];for(var i in h){ac.isFunction(h[i])&&g.push(i)}return g.sort()},ac.extend=function(g){return ab(at.call(arguments,1),function(h){if(h){for(var i in h){g[i]=h[i]}}}),g},ac.pick=function(h){var g={},i=ar.apply(ax,at.call(arguments,1));return ab(i,function(j){j in h&&(g[j]=h[j])}),g},ac.omit=function(h){var g={},j=ar.apply(ax,at.call(arguments,1));for(var i in h){ac.contains(j,i)||(g[i]=h[i])}return g},ac.defaults=function(g){return ab(at.call(arguments,1),function(h){if(h){for(var i in h){void 0===g[i]&&(g[i]=h[i])}}}),g},ac.clone=function(g){return ac.isObject(g)?ac.isArray(g)?g.slice():ac.extend({},g):g},ac.tap=function(h,g){return g(h),h};var U=function(v,u,t,s){if(v===u){return 0!==v||1/v==1/u}if(null==v||null==u){return v===u}v instanceof ac&&(v=v._wrapped),u instanceof ac&&(u=u._wrapped);var r=aq.call(v);if(r!=aq.call(u)){return !1}switch(r){case"[object String]":return v==String(u);case"[object Number]":return v!=+v?u!=+u:0==v?1/v==1/u:v==+u;case"[object Date]":case"[object Boolean]":return +v==+u;case"[object RegExp]":return v.source==u.source&&v.global==u.global&&v.multiline==u.multiline&&v.ignoreCase==u.ignoreCase}if("object"!=typeof v||"object"!=typeof u){return !1}for(var q=t.length;q--;){if(t[q]==v){return s[q]==u}}var p=v.constructor,o=u.constructor;if(p!==o&&!(ac.isFunction(p)&&p instanceof p&&ac.isFunction(o)&&o instanceof o)&&"constructor" in v&&"constructor" in u){return !1}t.push(v),s.push(u);var n=0,m=!0;if("[object Array]"==r){if(n=v.length,m=n==u.length){for(;n--&&(m=U(v[n],u[n],t,s));){}}}else{for(var l in v){if(ac.has(v,l)&&(n++,!(m=ac.has(u,l)&&U(v[l],u[l],t,s)))){break}}if(m){for(l in u){if(ac.has(u,l)&&!n--){break}}m=!n}}return t.pop(),s.pop(),m};ac.isEqual=function(h,g){return U(h,g,[],[])},ac.isEmpty=function(h){if(null==h){return !0}if(ac.isArray(h)||ac.isString(h)){return 0===h.length}for(var g in h){if(ac.has(h,g)){return !1}}return !0},ac.isElement=function(g){return !(!g||1!==g.nodeType)},ac.isArray=af||function(g){return"[object Array]"==aq.call(g)},ac.isObject=function(g){return g===Object(g)},ab(["Arguments","Function","String","Number","Date","RegExp"],function(g){ac["is"+g]=function(h){return aq.call(h)=="[object "+g+"]"}}),ac.isArguments(arguments)||(ac.isArguments=function(g){return !(!g||!ac.has(g,"callee"))}),"function"!=typeof/./&&(ac.isFunction=function(g){return"function"==typeof g}),ac.isFinite=function(g){return isFinite(g)&&!isNaN(parseFloat(g))},ac.isNaN=function(g){return ac.isNumber(g)&&g!=+g},ac.isBoolean=function(g){return g===!0||g===!1||"[object Boolean]"==aq.call(g)},ac.isNull=function(g){return null===g},ac.isUndefined=function(g){return void 0===g},ac.has=function(h,g){return ap.call(h,g)},ac.noConflict=function(){return aA._=az,this},ac.identity=function(g){return g},ac.constant=function(g){return function(){return g}},ac.property=function(g){return function(h){return h[g]}},ac.matches=function(g){return function(h){if(h===g){return !0}for(var i in g){if(g[i]!==h[i]){return !1}}return !0}},ac.times=function(h,g,k){for(var j=Array(Math.max(0,h)),i=0;h>i;i++){j[i]=g.call(k,i)}return j},ac.random=function(h,g){return null==g&&(g=h,h=0),h+Math.floor(Math.random()*(g-h+1))},ac.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=ac.invert(T.escape);var S={escape:new RegExp("["+ac.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+ac.keys(T.unescape).join("|")+")","g")};ac.each(["escape","unescape"],function(g){ac[g]=function(h){return null==h?"":(""+h).replace(S[g],function(i){return T[g][i]})}}),ac.result=function(h,g){if(null==h){return void 0}var i=h[g];return ac.isFunction(i)?i.call(h):i},ac.mixin=function(g){ab(ac.functions(g),function(h){var i=ac[h]=g[h];ac.prototype[h]=function(){var j=[this._wrapped];return au.apply(j,arguments),b.call(this,i.apply(ac,j))}})};var R=0;ac.uniqueId=function(h){var g=++R+"";return h?h+g:g},ac.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Q=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},c=/\\|'|\r|\n|\t|\u2028|\u2029/g;ac.template=function(r,q,p){var o;p=ac.defaults({},p,ac.templateSettings);var n=new RegExp([(p.escape||Q).source,(p.interpolate||Q).source,(p.evaluate||Q).source].join("|")+"|$","g"),m=0,l="__p+='";r.replace(n,function(g,u,t,s,i){return l+=r.slice(m,i).replace(c,function(h){return"\\"+P[h]}),u&&(l+="'+\n((__t=("+u+"))==null?'':_.escape(__t))+\n'"),t&&(l+="'+\n((__t=("+t+"))==null?'':__t)+\n'"),s&&(l+="';\n"+s+"\n__p+='"),m=i+g.length,g}),l+="';\n",p.variable||(l="with(obj||{}){\n"+l+"}\n"),l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{o=new Function(p.variable||"obj","_",l)}catch(k){throw k.source=l,k}if(q){return o(q,ac)}var j=function(g){return o.call(this,g,ac)};return j.source="function("+(p.variable||"obj")+"){\n"+l+"}",j},ac.chain=function(g){return ac(g).chain()};var b=function(g){return this._chain?ac(g).chain():g};ac.mixin(ac),ab(["pop","push","reverse","shift","sort","splice","unshift"],function(h){var g=ax[h];ac.prototype[h]=function(){var i=this._wrapped;return g.apply(i,arguments),"shift"!=h&&"splice"!=h||0!==i.length||delete i[0],b.call(this,i)}}),ab(["concat","join","slice"],function(h){var g=ax[h];ac.prototype[h]=function(){return b.call(this,g.apply(this._wrapped,arguments))}}),ac.extend(ac.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return ac})}).call(this)},{}],339:[function(e,d,f){Object.defineProperty(f,"__esModule",{value:!0}),f["default"]={WAITING:"polyfillWaiting",PLAYING:"polyfillPlaying",ENDED:"polyfillEnded"},d.exports=f["default"]},{}],340:[function(z,y,x){var w=z("babel-runtime/helpers/get")["default"],v=z("babel-runtime/helpers/inherits")["default"],u=z("babel-runtime/helpers/create-class")["default"],t=z("babel-runtime/helpers/class-call-check")["default"],s=z("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(x,"__esModule",{value:!0});var r=z("events"),q=s(r),p=z("./eventStruct"),o=s(p),n=function(d){function c(b){t(this,c),w(Object.getPrototypeOf(c.prototype),"constructor",this).call(this),this.video=b,this.IDLE=0,this.BUFFERING=1,this.PLAYING=2,this.TOLERANCE=0.1,this.state=this.IDLE,this.onPl=this.onPlay.bind(this),this.onPling=this.onPlaying.bind(this),this.video.paused?this.start():this.onPlay()}return v(c,d),u(c,null,[{key:"Events",get:function(){return o["default"]}}]),u(c,[{key:"start",value:function(){this.video.addEventListener("play",this.onPl)}},{key:"onPlay",value:function(){this.state=this.BUFFERING,this.emit(o["default"].WAITING),this.tickInterval=setInterval(this.tick.bind(this),200),this.video.removeEventListener("play",this.onPl)}},{key:"onPlaying",value:function(){this.emit(o["default"].PLAYING),this.video.removeEventListener("playing",this.onPling)}},{key:"onEnded",value:function(){clearInterval(this.tickInterval),this.state=this.IDLE,this.emit(o["default"].ENDED),this.video&&this.video.addEventListener("play",this.onPl)}},{key:"getBufferLength",value:function(){for(var b=0;b<this.video.buffered.length;b++){if(this.video.buffered.start(b)<=this.video.currentTime&&this.video.currentTime<=this.video.buffered.end(b)){return this.video.buffered.end(b)-this.video.currentTime}}return 0}},{key:"tick",value:function(){if(void 0!==this.isLive&&!this.isLive){if(this.video.duration&&(this.video.duration-this.video.currentTime<0.5||this.video.duration-this.video.currentTime<1&&this.lastCurrentTime-this.video.currentTime<0.01&&!this.video.paused&&this.video.playbackRate>0||this.video.currentTime>0&&isNaN(this.video.duration))){return void this.onEnded()}this.lastCurrentTime=this.video.currentTime}var b=this.getBufferLength();switch(this.state){case this.BUFFERING:b>this.TOLERANCE&&(this.state=this.PLAYING,this.video.paused?this.video.addEventListener("playing",this.onPling):this.emit(o["default"].PLAYING));break;case this.PLAYING:b<this.TOLERANCE?(this.state=this.BUFFERING,this.video.paused||this.emit(o["default"].WAITING)):this.video.paused&&this.video.addEventListener("playing",this.onPling);break;case this.IDLE:default:return}}},{key:"setLive",value:function(b){this.isLive=b}},{key:"dispose",value:function(){clearInterval(this.tickInterval),this.video&&(this.video.removeEventListener("play",this.onPl),this.video.removeEventListener("playing",this.onPling),delete this.video),this.removeAllListeners()}}]),c}(q["default"]);x["default"]=n,y.exports=x["default"]},{"./eventStruct":339,"babel-runtime/helpers/class-call-check":11,"babel-runtime/helpers/create-class":12,"babel-runtime/helpers/get":13,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/interop-require-default":15,events:164}],341:[function(i,h,n){var m=arguments[3],l=arguments[4],k=arguments[5],j=JSON.stringify;h.exports=function(x){for(var w,v=Object.keys(k),u=0,t=v.length;t>u;u++){var s=v[u],r=k[s].exports;if(r===x||r["default"]===x){w=s;break}}if(!w){w=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var q={},u=0,t=v.length;t>u;u++){var s=v[u];q[s]=s}l[w]=[Function(["require","module","exports"],"("+x+")(self)"),q]}var g=Math.floor(Math.pow(16,8)*Math.random()).toString(16),f={};f[w]=w,l[g]=[Function(["require"],"var f = require("+j(w)+");(f.default ? f.default : f)(self);"),f];var e="("+m+")({"+Object.keys(l).map(function(b){return j(b)+":["+l[b][0]+","+j(l[b][1])+"]"}).join(",")+"},{},["+j(g)+"])",d=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(d.createObjectURL(new Blob([e],{type:"text/javascript"})))}},{}]},{},[1]);